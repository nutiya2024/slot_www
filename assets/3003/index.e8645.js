window.__require=function e(t,o,n){function i(s,c){if(!o[s]){if(!t[s]){var r=s.split("/");if(r=r[r.length-1],!t[r]){var l="function"==typeof __require&&__require;if(!c&&l)return l(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+s+"'")}s=r}var d=o[s]={exports:{}};t[s][0].call(d.exports,function(e){return i(t[s][1][e]||e)},d,d.exports,e,t,o,n)}return o[s].exports}for(var a="function"==typeof __require&&__require,s=0;s<n.length;s++)i(n[s]);return i}({HQL2Bill:[function(e,t,o){"use strict";cc._RF.push(t,"1a9d8cccuBEALAfejQA2o0f","HQL2Bill");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(a<3?i(s):a>3?i(t,o,s):i(t,o))||s);return a>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./HQL2Const"),c=e("./HQL2Manager"),r=cc._decorator,l=r.ccclass,d=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onLoad=function(){this.layer_min=this.node.getChildByName("layer_min"),this.an_get=this.node.getChildByName("layer_get").getComponent(cc.Animation),this.dr_fish=this.layer_min.getChildByName("dr_fish"),this.an_fish=this.layer_min.getChildByName("an_fish").getComponent(cc.Animation),this.sp_fish=this.layer_min.getChildByName("an_fish").getComponent(cc.Sprite),this.lb_gold0=this.layer_min.getChildByName("lb_gold").getComponent("HQL2Label"),this.an_bg=this.layer_min.getChildByName("an_bg").getComponent(cc.Animation),this.lb_get=this.an_get.node.getChildByName("lb").getComponent("HQL2Label");var e=c.default.once.getEffectByType("jump1_");e.wrapMode=cc.WrapMode.Normal,this.an_bg.addClip(e),this.an_bg.on("finished",this.onFinishBG,this);var t=c.default.once.getEffectByType("dieEff22_");t.wrapMode=cc.WrapMode.Default,this.an_get.addClip(t);var o=c.default.once.getEffectByType("dieEff20_");o.wrapMode=cc.WrapMode.Default,this.an_get.addClip(o);var n=c.default.once.getEffectByType("dieEff19_");n.wrapMode=cc.WrapMode.Default,this.an_get.addClip(n)},t.prototype.onFinishBG=function(){this.an_fish.node.opacity=255,this.dr_fish.opacity=255,this.lb_gold0.node.opacity=255},t.prototype.show=function(e){var t=this;this.param=e,this.node.active=!0,this.seatId=e.seatId,this.layer_min.active=-1!=[43,39,50,30,20,21,22,24,17,18,33,34,35,23].indexOf(e.fid),this.an_get.node.active=-1!=[].indexOf(e.fid),c.default.once.playSFX("tiao"),this.an_fish.node.active=!0,this.an_fish.node.scale=.7,this.an_fish.node.opacity=0,this.dr_fish.opacity=0,this.lb_get.string=this.lb_gold0.string="$0";for(var o=e.award/100,n=[],i=function(e){n.push(cc.callFunc(function(){var n=o*e;t.lb_get.string=t.lb_gold0.string=""+c.default.once.GameLayer.changeGold(n)})),n.push(cc.delayTime(.015))},a=0;a<100;a++)i(a);if(n.push(cc.callFunc(function(){t.lb_get.string=t.lb_gold0.string=""+c.default.once.GameLayer.changeGold(e.award)})),this.node.runAction(cc.sequence(n)),this.layer_min.active)if(this.lb_gold0.node.opacity=0,this.layer_min.scale=.9,this.an_bg.play("jump1_"),this.dr_fish.y=-50,this.dr_fish.active=-1!=[43,30,35,34].indexOf(e.fid),this.an_fish.node.active=-1!=[50,20,21,22,24,39,17,18,33,23].indexOf(e.fid),-1!=[50,20,21,22,24,17,18,33,23].indexOf(e.fid)){var r=c.default.once.getSwimAnimateByID(e.fid);r.wrapMode=cc.WrapMode.Loop,this.an_fish.addClip(r),this.an_fish.play(r.name)}else{if(this.dr_fish.active){var l=[],d=[],p="swim",h="";for(30==parseInt(e.fid)&&(p="swim1",h="fish18",l=[0,0,0,0],d=[1,2,3,0],this.dr_fish.y=-15),43==parseInt(e.fid)&&(h="fish21",l=[2,2,2],d=[7,8,6]),34==parseInt(e.fid)&&(h="fish22",l=[3],d=[9],this.dr_fish.y=-15),35==parseInt(e.fid)&&(h="fish20",l=[1,1],d=[5,4]),a=0;a<this.dr_fish.children.length;a++){var f=this.dr_fish.children[a].getComponent(dragonBones.ArmatureDisplay);f.node.active=l.length>a;var u=c.default.once.GameLayer.LoadingLayer.fishsDBA[l[a]];f.dragonAsset=u;var y=c.default.once.GameLayer.LoadingLayer.fishsDBAT[d[a]];f.dragonAtlasAsset=y,f.armatureName=h,l.length>a&&f.playAnimation(p,0)}}39==parseInt(e.fid)&&(this.sp_fish.spriteFrame=s.HQL2Const.once.UIAtals.getSpriteFrame("collection02"))}this.an_get.node.active&&this.an_get.play({33:"np19_",34:"np22_",35:"np20_"}[""+e.fid]),this.scheduleOnce(function(){c.default.once.GameLayer.EffectLayer.onFinishEffect(t.param),t.dr_fish.active?t.node.destroy():(t.clean(),c.default.once.GameLayer.despawnBill(t))},3)},t.prototype.onFinishAnimate=function(){},t.prototype.clean=function(){this.an_fish.node.removeComponent(cc.Animation),this.an_fish=this.sp_fish.node.addComponent(cc.Animation),this.node.stopAllActions(),this.unscheduleAllCallbacks()},a([l],t)}(cc.Component));o.default=d,cc._RF.pop()},{"./HQL2Const":"HQL2Const","./HQL2Manager":"HQL2Manager"}],HQL2Bullet:[function(e,t,o){"use strict";cc._RF.push(t,"00890MnMSFLPZMYtTc0muf5","HQL2Bullet");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(a<3?i(s):a>3?i(t,o,s):i(t,o))||s);return a>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../../Script/utils/Utils"),c=e("./HQL2Const"),r=e("./HQL2Fish"),l=e("./HQL2Manager"),d=cc._decorator,p=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.seatId=0,t.bulletId=0,t.angle=0,t.level=0,t.collisionCount=0,t.initTime=0,t._lastUpdateTime=0,t.lockFishId=c.HQL2Const.once.NotFound,t.radius=0,t.award=0,t}return i(t,e),t.prototype.onLoad=function(){this.node.zIndex=-1,this.sp=this.node.getComponent(cc.Sprite),this.radius=c.HQL2Const.once.BulletRadius},t.prototype.initAn=function(){this.an_bullet=this.node.addComponent(cc.Animation);var e=l.default.once.getEffectByType("tail_");e.wrapMode=cc.WrapMode.Loop,this.an_bullet.addClip(e),this.an_sub=this.node.children[0].addComponent(cc.Animation);var t=l.default.once.getEffectByType("head0_");t.wrapMode=cc.WrapMode.Loop,this.an_sub.node.angle=0,this.an_sub.addClip(t);var o=l.default.once.getEffectByType("head1_");o.wrapMode=cc.WrapMode.Loop,this.an_sub.addClip(o)},t.prototype.init=function(e){var t=Date.now();this.initTime=t,this.seatId=e.seatId,this.bulletId=e.bulletId,this.bxy=null,this.isDrill=e.isDrill,this.boomWay=e.boomWay,this.nid=e.nid,this.award=e.award,this.boomPercent=e.boomPercent,this.node.stopAllActions(),this.angle=-e.angle,this.node.angle=e.angle,this.node.position=e.point,this.level=e.level,e.level<1&&(e.level=1),e.level>4&&(e.level=4),this.collisionCount=0,this._enableUpdate=!0,this.node.scale=e.isDrill?2:1.5,this.node.active=!0,this.setLockFishID(e.lock),this.node.children[0].active=e.isDrill,e.isDrill?(this.initAn(),this.an_bullet.play("tail_"),this.an_sub.play("head0_")):this.sp.spriteFrame=c.HQL2Const.once.UIAtals.getSpriteFrame("bullet0_0"),this._lastUpdateTime=this.initTime},t.prototype.setLockFishID=function(e){this.lockFish=l.default.once.GameLayer.getLockFishByFishId(e),this.lockFish instanceof r.default?this.lockFishId=e:this.lockFishId=c.HQL2Const.once.NotFound},t.prototype.setOutPosition=function(e){this.angle=e.angle,this.node.x+=e.x,this.node.y+=e.y},t.prototype.calculateDrillBoomPoint=function(){if(++this.collisionCount==this.boomWay&&this.isDrill){this.an_sub.play("head1_"),this.an_sub.node.runAction(cc.rotateBy(30,9999)),this.an_bullet.stop(),this.sp.spriteFrame=null;var e=cc.v2(this.node.x,this.node.y),t=cc.view.getVisibleSize(),o=Math.sin(this.angle/180*Math.PI),n=Math.cos(this.angle/180*Math.PI),i=o>0?t.width/2-e.x:-t.width/2-e.x,a=n>0?t.height/2-e.y:-t.height/2-e.y,s=c.HQL2Const.once.BulletSpeed.x*o,r=c.HQL2Const.once.BulletSpeed.y*n,l=Math.abs(i/s*this.boomPercent/100),d=Math.abs(a/r*this.boomPercent/100);e.x+=s*Math.min(l,d),e.y+=r*Math.min(l,d),this.bxy=e}},t.prototype.updatexxx=function(){if(this._enableUpdate){if(this.lockFish instanceof r.default){var e=this.lockFish.getWorldPoint(),t=this.node.convertToWorldSpaceAR(cc.v2(0,0));this.angle=l.default.once.convertPointToAngle(t,e)-90}var o=Date.now(),n=(o-this._lastUpdateTime)/1e3;this._lastUpdateTime=o;var i=cc.v2(c.HQL2Const.once.BulletSpeed.x,c.HQL2Const.once.BulletSpeed.y);this.collisionCount==this.boomWay&&this.isDrill&&(i.x*=.2,i.y*=.2);var a=l.default.once.calculateSpacePoint({angle:this.angle,space:n,speed:i});this.node.x+=a.x,this.node.y+=a.y;var s=l.default.once.convertPositionAngle({x:this.node.x,y:this.node.y,angle:this.angle});s.out?(this.clearLockID(),this.setOutPosition(s),this.calculateDrillBoomPoint()):this.checkDrillBoom(a.x,a.y),this.node.angle=-this.angle}},t.prototype.checkDrillBoom=function(e,t){if(this.bxy&&this.isDrill){var o=this.node.x>this.bxy.x&&e>0||this.node.x<this.bxy.x&&e<0,n=this.node.y>this.bxy.y&&t>0||this.node.y<this.bxy.y&&t<0;if(o||n){this.node.position=this.bxy,l.default.once.GameLayer.addEffect({skillId:c.HQL2EffectType.DRILL_BOOM_BLAST,bombfish:!0,position:this.node.position,award:this.award,seatId:this.seatId});var i=this.node.convertToWorldSpaceAR(cc.v2(0,0)),a=c.HQL2Const.once.IsDrillR*c.HQL2Const.once.winScale.x,s=l.default.once.inCircleFishs(i,a);l.default.once.requestShotTarget(s.fishId,this.bulletId,3),this.lowerNet(!1)}}},t.prototype.beAttackFish=function(e){e&&e.alive&&e.beAttack()},t.prototype.clearLockID=function(){this.setLockFishID(-1)},t.prototype.lowerNet=function(e,t){void 0===e&&(e=!0),this._enableUpdate=!1,e&&(t=t||this.node.convertToWorldSpaceAR(cc.v2(0,0)),l.default.once.GameLayer.addNet(t,this.level,this.node.angle,this.seatId)),l.default.once.GameLayer.despawnBullet(this)},t.prototype.clear=function(){this.an_sub&&(this.an_sub.node.stopAllActions(),this.an_sub.stop(),this.an_sub.node.removeComponent(cc.Animation),this.an_sub=null),this.an_bullet&&(this.an_bullet.stop(),this.an_bullet.node.removeComponent(cc.Animation),this.an_bullet=null)},t.prototype.sendHitFishReqType=function(e){if(e instanceof r.default&&this.seatId===c.HQL2Const.once.seatId){if(this.isDrill&&parseInt(e.config.Skill)>0)return;var t=this.isDrill?3:1;if(2==e.config.propFish&&(t=7,this.isDrill))return;var o=this.lockFish instanceof r.default?this.lockFish.fishId:null;l.default.once.requestShotTarget(e.fishId,this.bulletId,t,o)}},t.prototype.onCollision=function(e){var t=this.lockFishId===e.fishId;if((this._enableUpdate||t)&&(this.lockFishId===c.HQL2Const.once.NotFound||t)){if(!this.isDrill){var o=t?e.getWorldPoint():null;this.lowerNet(!0,o)}if(this.isDrill&&s.default.randomNum(0,200)<30&&this.collisionCount!=this.boomWay){var n=s.default.randomNum(0,200)>100?cc.v2(this.node.x+50,this.node.y):cc.v2(this.node.x-50,this.node.y);l.default.once.GameLayer.addEffect({skillId:c.HQL2EffectType.DRILL_BOOM_BLAST,position:n,award:this.award,seatId:this.seatId})}this.sendHitFishReqType(e),this.beAttackFish(e)}},a([p],t)}(cc.Component));o.default=h,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./HQL2Const":"HQL2Const","./HQL2Fish":"HQL2Fish","./HQL2Manager":"HQL2Manager"}],HQL2Coin:[function(e,t,o){"use strict";cc._RF.push(t,"b2ae8duizRBUYnXw7efQKHI","HQL2Coin");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(a<3?i(s):a>3?i(t,o,s):i(t,o))||s);return a>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./HQL2Const"),c=e("./HQL2Manager"),r=cc._decorator,l=r.ccclass,d=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spIndex=0,t}return i(t,e),t.prototype.onLoad=function(){this.sb_bg=this.node.getComponent(cc.Sprite),this.an_bg=this.node.getComponent(cc.Animation)},t.prototype.onFinishAn=function(){},t.prototype.clean=function(){this.node.stopAllActions(),this.node.active=!1,this.time=-1},t.prototype.init=function(e){var t=this;this.clean(),this.node.active=!0,this.coinAtlas||(this.coinAtlas=c.default.once.getAtlasByType("coin")),this.time=0,this.param=e;var o=cc.v2(e.position.x,e.position.y);this.node.setPosition(o);var n=e.i;this.node.setScale(1.2),this.node.opacity=0;var i=cc.sequence(cc.fadeIn(.03),cc.moveBy(.12,cc.v2(0,1)).easing(cc.easeOut(3)),cc.moveBy(.1,cc.v2(0,-1)).easing(cc.easeIn(3))),a=cc.spawn(i,cc.scaleTo(.3,1.2)),s=this.node.parent.convertToNodeSpaceAR(e.to),r=cc.v2((o.x+s.x)/2,o.y+50),l=cc.bezierTo(2,[o,r,s]),d=cc.spawn(l.easing(cc.easeOut(2)),cc.scaleTo(2,.84)),p=cc.callFunc(function(){var t="gold_small";e.fid>9&&(t="gold"),e.fid>19&&(t="gold_big"),e.skillId>100&&(t="gold_effect"),c.default.once.playSFX(t)}),h=cc.callFunc(function(){c.default.once.playSFX("back")}),f=c.default.once.GameLayer.getUserByTable(e.seatId);f&&(s=this.node.parent.convertToNodeSpaceAR(f.getUserWinWorldPoint()));var u=cc.callFunc(function(){0===n&&c.default.once.showCoinLbAction({position:s,award:e.award,self:e.self}),c.default.once.GameLayer.despawnCoin(t)}),y=[];n*=.07,y.push(cc.delayTime(n));var _=!e.skillId,L=e.self&&0===e.i;_&&L&&y.push(p),y.push(a),y.push(cc.delayTime(.7)),_&&L&&y.push(h),y.push(d),y.push(u),this.node.runAction(cc.sequence(y))},t.prototype.update=function(e){-1!==this.time&&(this.time+=e,this.time>=s.HQL2Const.once.CoinRotationTime)&&(this.time=0,++this.spIndex>=18&&(this.spIndex=0),this.param&&this.param.self,this.sb_bg.spriteFrame=this.coinAtlas.getSpriteFrame("coin0_"+this.spIndex))},a([l],t)}(cc.Component));o.default=d,cc._RF.pop()},{"./HQL2Const":"HQL2Const","./HQL2Manager":"HQL2Manager"}],HQL2Const:[function(e,t,o){"use strict";var n;cc._RF.push(t,"e7d0f07SwtLMYTs2V/MvMx3","HQL2Const"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameLoadType=o.HQL2Const=o.HQL2EffectType=o.HQL2FireSpeed=o.HQL2FishStatus=void 0,function(e){e[e.Die=0]="Die",e[e.Live=1]="Live"}(o.HQL2FishStatus||(o.HQL2FishStatus={})),function(e){e[e.Speed0=.2]="Speed0",e[e.Speed1=.1]="Speed1"}(n=o.HQL2FireSpeed||(o.HQL2FireSpeed={})),function(e){e[e.XUAN_WO=1050]="XUAN_WO",e[e.XUAN_WO_SUB=1051]="XUAN_WO_SUB",e[e.LONG=1039]="LONG",e[e.COIN_BOOM=1e5]="COIN_BOOM",e[e.FIRE_TOTLE=10301]="FIRE_TOTLE",e[e.FIRE_TOTLE_BALL=1030]="FIRE_TOTLE_BALL",e[e.HU_DIE=1033]="HU_DIE",e[e.KONG_LONG=1034]="KONG_LONG",e[e.JING=1035]="JING",e[e.SUPER_BOOM=1022]="SUPER_BOOM",e[e.SUPER_BOOM_SUB=10220]="SUPER_BOOM_SUB",e[e.LASER_BOOM=1021]="LASER_BOOM",e[e.DRILL_BOOM=1020]="DRILL_BOOM",e[e.DRILL_BOOM_BLAST=10201]="DRILL_BOOM_BLAST",e[e.IROULETE=1024]="IROULETE",e[e.PI_KA_QIU=1023]="PI_KA_QIU",e[e.PI_KA_QIU_LIGHT=10231]="PI_KA_QIU_LIGHT",e[e.None=0]="None",e[e.Fast=100]="Fast",e[e.Bill=120]="Bill",e[e.SamllBill=1201]="SamllBill"}(o.HQL2EffectType||(o.HQL2EffectType={}));var i=function(){function e(){this.NotFound=999999999,this.CoinRotationTime=.06,this.FishRedDuring=.15,this.NetMaxTime=.2,this.BulletSpeed={x:.6,y:.6},this.BoomR=200,this.IsDrillR=200,this.LastFishSD=[],this.AutoLimit=n.Speed0,this.FightLimit=n.Speed0,this.WeaponHight=110,this.BorderCount=4,this.BulletRadius=25,this.FireCD=180,this.compensate=0,this.MapCompensate=new Map,this.IsDrill=!1,this.BombId="",this.Award=101,this.Round=101,this.BulletCount=0,this.NetUp=0,this.NetDown=0,this.winScale=cc.v2(1,1),this.IsAuto=!1,this.IsLock=!1,this.HeartBeatCD=0,this.LeserBulletId="",this.MapAtlas=new Map,this.MapSwims=new Map,this.MapDieanis=new Map,this.MapEffects=new Map,this.diamond=0,this.RoomBet=1,this.BLevel=0,this.BLevels=[1,2,3,4,5],this.CannonBets=[],this.seatId=-1,this.userId=-1,this.TableId=-1,this.Entries=0,this.Winning=0,this.users={},this.UIAtals=null}return Object.defineProperty(e,"once",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.destroyInstance=function(){e._instance&&(e._instance=null,delete e._instance)},e}();o.HQL2Const=i,function(e){e[e.Sprite=0]="Sprite",e[e.Atlas=1]="Atlas",e[e.Skeleton=2]="Skeleton",e[e.ParticleAsset=3]="ParticleAsset",e[e.Prefab=4]="Prefab",e[e.Json=5]="Json"}(o.GameLoadType||(o.GameLoadType={})),cc._RF.pop()},{}],HQL2EffectLayer:[function(e,t,o){"use strict";cc._RF.push(t,"36fd49B1EJPzYlWfjYYC8kj","HQL2EffectLayer");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(a<3?i(s):a>3?i(t,o,s):i(t,o))||s);return a>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./HQL2Const"),c=e("./HQL2Manager"),r=e("../../../Script/utils/Utils"),l=cc._decorator,d=l.ccclass,p=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.an_waves=null,t.an_play=null,t.an_crush=null,t.lb_fire=null,t.layer_recharge=null,t.layer_4long=null,t.layer_elecanon=null,t.layer_lines=[],t.an_elecanon=[],t.an_eleLight=[],t.sp_haicao=null,t.lb_28s=[],t.an_24s=[],t.an_24points=[],t.an_20s=[],t.an_20points=[],t.an_gets=[],t.an_xws=[],t.bill_cd=0,t.map_sameinfo=[],t.effectinfo=null,t}return i(t,e),t.prototype.onLoad=function(){this.initEvents()},t.prototype.onFinishEffectPlay=function(){this.an_play.node.active=!1;var e={seatId:this.an_play.currentClip.seatId,award:this.an_play.currentClip.award,skillId:s.HQL2EffectType.Bill,fid:this.an_play.currentClip.fid};c.default.once.GameLayer.EffectLayer.addEffect(e)},t.prototype.refreshSmallBill=function(){if(!this.an_play.node.active&&this.map_sameinfo.length>0){var e=this.map_sameinfo[0];this.map_sameinfo.shift();var t={33:"dieEff19_",34:"dieEff22_",35:"dieEff20_"};t=t[e.fid],this.an_play.node.stopAllActions(),this.an_play.node.active=!0;var o=cc.view.getVisibleSize();this.an_play.node.scaleX=o.width/510,this.an_play.node.scaleY=o.height/287,this.an_play.play(t),this.an_play.currentClip.bombId=e.bombId,this.an_play.currentClip.fid=e.fid,this.an_play.currentClip.index=e.index,this.an_play.currentClip.award=e.award,this.an_play.currentClip.seatId=e.seatId,33==e.fid&&(c.default.once.playSFX("S21SS"),this.an_play.node.runAction(cc.sequence(cc.delayTime(3),cc.callFunc(function(){c.default.once.playSFX("zhuag")}),cc.delayTime(.5),cc.callFunc(function(){c.default.once.playSFX("zhuag")}),cc.delayTime(.5),cc.callFunc(function(){c.default.once.playSFX("zhuag")}),cc.delayTime(.5),cc.callFunc(function(){c.default.once.playSFX("zhuag")}),cc.delayTime(.3),cc.callFunc(function(){c.default.once.playSFX("zhuag")}),cc.delayTime(.2),cc.callFunc(function(){c.default.once.playSFX("mogui")}),cc.delayTime(4),cc.fadeIn(.1),cc.callFunc(function(){c.default.once.playSFX("s31"),c.default.once.Cmdh1l2BigBomb({seatId:s.HQL2Const.once.seatId,bombId:e.bombId})})))),35==e.fid&&(c.default.once.playSFX("j0"),this.an_play.node.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){c.default.once.Cmdh1l2BigBomb({seatId:s.HQL2Const.once.seatId,bombId:e.bombId}),c.default.once.playSFX("shui")}),cc.delayTime(3),cc.callFunc(function(){c.default.once.playSFX("j0"),c.default.once.Cmdh1l2BigBomb({seatId:s.HQL2Const.once.seatId,bombId:e.bombId})}),cc.delayTime(3.5),cc.callFunc(function(){c.default.once.playSFX("fushui")}),cc.delayTime(2),cc.callFunc(function(){c.default.once.playSFX("j1")}),cc.delayTime(2),cc.callFunc(function(){c.default.once.Cmdh1l2BigBomb({seatId:s.HQL2Const.once.seatId,bombId:e.bombId})})))),34==e.fid&&(c.default.once.playSFX("kong0"),this.an_play.node.runAction(cc.sequence(cc.delayTime(1.5),cc.callFunc(function(){c.default.once.playSFX("weiba"),c.default.once.Cmdh1l2BigBomb({seatId:s.HQL2Const.once.seatId,bombId:e.bombId})}),cc.delayTime(3.5),cc.callFunc(function(){c.default.once.playSFX("pen_1")}),cc.delayTime(.5),cc.callFunc(function(){c.default.once.playSFX("pen_1")}),cc.delayTime(.5),cc.callFunc(function(){c.default.once.playSFX("pen_1")}),cc.delayTime(.5),cc.callFunc(function(){c.default.once.playSFX("pen_1")}),cc.delayTime(.5),cc.callFunc(function(){c.default.once.playSFX("pen_1"),c.default.once.Cmdh1l2BigBomb({seatId:s.HQL2Const.once.seatId,bombId:e.bombId})}),cc.delayTime(3),cc.callFunc(function(){c.default.once.playSFX("pen_0"),c.default.once.Cmdh1l2BigBomb({seatId:s.HQL2Const.once.seatId,bombId:e.bombId})}))))}},t.prototype.showKilinEffect=function(e,t){var o=this,n=c.default.once.tableConvertIndex(t.seatId);e.node.stopAllActions(),e.node.angle=0,e.param=t,this.effectinfo={dFish:e,seatId:t.seatId},c.default.once.GameLayer.WeaponLayer.an_lines[n].node.opacity=0;var i=cc.view.getVisibleSize(),a=cc.v2(-i.width/4,-i.height/4),r=cc.v2(i.width/4,-i.height/4),l=cc.v2(0,0);c.default.once.playSFX("zhua");for(var d=0;d<e.dr_fishs.length;d++)e.dr_fishs[d].playAnimation("catch",1);var p=[];p.push(cc.delayTime(1)),p.push(cc.callFunc(function(){for(var t=0;t<e.dr_fishs.length;t++)e.dr_fishs[t].playAnimation("struggle",1)})),p.push(cc.delayTime(1)),p.push(cc.callFunc(function(){c.default.once.GameLayer.WeaponLayer.layer_line[n].opacity=0;for(var t=0;t<e.dr_fishs.length;t++)e.dr_fishs[t].playAnimation("jump",1);e.node.scaleY=e.node.x>a.x?-1:1})),p.push(cc.delayTime(.2)),p.push(cc.moveTo(.7,a)),p.push(cc.callFunc(function(){c.default.once.GameLayer.WeaponLayer.layer_line[n].opacity=255,c.default.once.playSFX("hong_1")})),p.push(cc.delayTime(1)),p.push(cc.callFunc(function(){for(var t=0;t<e.dr_fishs.length;t++)e.dr_fishs[t].playAnimation("struggle",1)})),p.push(cc.delayTime(.2)),p.push(cc.callFunc(function(){for(var t=0;t<e.dr_fishs.length;t++)e.dr_fishs[t].playAnimation("attack",1)})),p.push(cc.delayTime(1)),p.push(cc.callFunc(function(){o.an_crush.node.position=e.node.position,o.an_crush.node.active=!0,o.an_crush.play("crush1_2"),c.default.once.CmdHQL2SuperBomb(t,e)})),p.push(cc.delayTime(.5)),p.push(cc.callFunc(function(){e.node.scaleY=1,c.default.once.GameLayer.WeaponLayer.layer_line[n].opacity=0;for(var t=0;t<e.dr_fishs.length;t++)e.dr_fishs[t].playAnimation("jump",1)})),p.push(cc.delayTime(.2)),p.push(cc.moveTo(.7,l)),p.push(cc.callFunc(function(){c.default.once.GameLayer.WeaponLayer.layer_line[n].opacity=255,c.default.once.playSFX("hong_1")})),p.push(cc.delayTime(1)),p.push(cc.callFunc(function(){for(var t=0;t<e.dr_fishs.length;t++)e.dr_fishs[t].playAnimation("struggle",1)})),p.push(cc.delayTime(.2)),p.push(cc.callFunc(function(){for(var t=0;t<e.dr_fishs.length;t++)e.dr_fishs[t].playAnimation("attack",1)})),p.push(cc.delayTime(1)),p.push(cc.callFunc(function(){o.an_crush.node.position=e.node.position,o.an_crush.node.active=!0,o.an_crush.play("crush1_2"),c.default.once.CmdHQL2SuperBomb(t,e)})),p.push(cc.delayTime(.5)),p.push(cc.callFunc(function(){c.default.once.GameLayer.WeaponLayer.layer_line[n].opacity=0;for(var t=0;t<e.dr_fishs.length;t++)e.dr_fishs[t].playAnimation("crazyJump",1)})),p.push(cc.delayTime(.2)),p.push(cc.moveTo(.7,r)),p.push(cc.callFunc(function(){c.default.once.GameLayer.WeaponLayer.layer_line[n].opacity=255,c.default.once.playSFX("hong_1")})),p.push(cc.delayTime(1)),p.push(cc.callFunc(function(){for(var t=0;t<e.dr_fishs.length;t++)e.dr_fishs[t].playAnimation("struggle",1)})),p.push(cc.delayTime(.2)),p.push(cc.callFunc(function(){for(var t=0;t<e.dr_fishs.length;t++)e.dr_fishs[t].playAnimation("attack",1)})),p.push(cc.delayTime(1)),p.push(cc.callFunc(function(){o.an_crush.node.position=e.node.position,o.an_crush.node.active=!0,o.an_crush.play("crush1_2"),c.default.once.CmdHQL2SuperBomb(t,e)})),p.push(cc.delayTime(1)),p.push(cc.callFunc(function(){for(var n=0;n<e.dr_fishs.length;n++)e.dr_fishs[n].playAnimation("shakeOff",1);t.seatId==s.HQL2Const.once.seatId&&c.default.once.GameLayer.WeaponLayer.setTimelimit(0),o.effectinfo=null,c.default.once.playSFX("taotuo")})),p.push(cc.delayTime(.5)),p.push(cc.callFunc(function(){c.default.once.GameLayer.WeaponLayer.layer_line[n].active=!1,c.default.once.GameLayer.WeaponLayer.an_lines[n].node.opacity=255;for(var o=0;o<e.dr_fishs.length;o++)e.dr_fishs[o].playAnimation("swim",0);var i={seatId:t.seatId,award:t.award,skillId:s.HQL2EffectType.Bill,fid:43};c.default.once.GameLayer.EffectLayer.addEffect(i)})),p.push(cc.moveBy(10,cc.v2(3e3,0))),p.push(cc.callFunc(function(){c.default.once.GameLayer.despawnFish(e)})),e.node.runAction(cc.sequence(p))},t.prototype.onFinishEffectCrush=function(){this.an_crush.node.active=!1},t.prototype.initEvents=function(){this.map_info=new Map;for(var e=0;e<4;e++)this.map_info.set(e,[]);for(this.map_sameinfo=[],this.lb_max=this.node.getChildByName("lb_max"),this.lb_ms=this.node.getChildByName("lb_ms").getComponent(cc.Label),this.an_waves.node.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(5,1.8,1.2),cc.delayTime(1),cc.scaleTo(5,1.5,1)))),this.an_crush.on("finished",this.onFinishEffectCrush,this),e=0;e<4;e++){var t=this.layer_elecanon.children[e],o=t.getChildByName("an_pao").getComponent(cc.Animation),n=c.default.once.getEffectByType("elecanon_");n.wrapMode=cc.WrapMode.Loop,o.addClip(n),o.play(n.name),o.node.active=!1,this.an_elecanon.push(o);var i=t.children[0].getChildByName("sp_fire").getComponent(cc.Animation),a=c.default.once.getEffectByType("Elecanon_shoot_");a.wrapMode=cc.WrapMode.Normal,i.node.active=!1,i.addClip(a),this.an_eleLight.push(i);var s="onFinishEleLight"+e;i.on("finished",this[s],this),o.node.parent.getChildByName("title_22").active=!1,this.lb_28s.push(cc.find("28_score/lb",t).getComponent("HQL2Label")),this.an_24s.push(t.getChildByName("an_24")),this.an_24s[e].active=!1,this.an_24points.push(cc.v2(this.an_24s[e].x,this.an_24s[e].y)),this.an_20s.push(t.getChildByName("an_20")),this.an_20s[e].active=!1,this.an_20points.push(cc.v2(this.an_20s[e].x,this.an_20s[e].y));var r=t.getChildByName("an_get").getComponent(cc.Animation),l=c.default.once.getEffectByType("np19_");l.wrapMode=cc.WrapMode.Loop,r.addClip(l);var d=c.default.once.getEffectByType("np20_");d.wrapMode=cc.WrapMode.Loop,r.addClip(d);var p=c.default.once.getEffectByType("np22_");p.wrapMode=cc.WrapMode.Loop,r.addClip(p),r.node.active=!1,this.an_gets.push(r);var h=this.layer_elecanon.getChildByName("an_xw"+e).getComponent(cc.Animation),f=c.default.once.getSwimAnimateByID("50");f.wrapMode=cc.WrapMode.Loop,h.addClip(f),h.play(f.name);var u=h.node.getChildByName("an_fish").getComponent(cc.Animation);this.an_xws.push(u)}var y=c.default.once.getEffectByType("dieEff22_");y.wrapMode=cc.WrapMode.Default,this.an_play.addClip(y);var _=c.default.once.getEffectByType("dieEff20_");_.wrapMode=cc.WrapMode.Default,this.an_play.addClip(_);var L=c.default.once.getEffectByType("dieEff19_");L.wrapMode=cc.WrapMode.Default,this.an_play.addClip(L);var g=c.default.once.getEffectByType("h");g.wrapMode=cc.WrapMode.Loop,this.an_play.addClip(g),this.an_play.on("finished",this.onFinishEffectPlay,this)},t.prototype.onTouchStartElecanon=function(e,t,o){if(void 0===o&&(o=404),e)o=s.HQL2Const.once.seatId;else if(o==s.HQL2Const.once.seatId)return;var n=c.default.once.tableConvertIndex(o),i=this.an_elecanon[n];if(i&&i.leser){i.leser=!1,c.default.once.playSFX("jiguang"),t=t||e.getLocation(),this.layer_elecanon.off(cc.Node.EventType.TOUCH_START,this.onTouchStartElecanon,this),i.node.getChildByName("title").active=!1,this.an_eleLight[n].node.active=!0,this.an_eleLight[n].play("Elecanon_shoot_"),cc.log("changeLeserRotationByTid"),this.changeLeserRotationByTid(t,s.HQL2Const.once.seatId);var a=i.node.getChildByName("tip_0").convertToWorldSpaceAR(cc.v2(0,0)),r=i.node.getChildByName("tip_1").convertToWorldSpaceAR(cc.v2(0,0));if(o==s.HQL2Const.once.seatId){var l=c.default.once.calculateSpacePoint({angle:-this.layer_elecanon.children[n].angle,space:1,speed:cc.v2(1,1)}),d=[cc.v2(a.x+l.x,a.y+l.y),cc.v2(r.x+l.x,r.y+l.y),cc.v2(a.x,a.y),cc.v2(r.x,r.y)];c.default.once.CMDLeserBoom(t,d)}this.changeLeserRotationByTid(t,o),c.default.once.GameLayer.WeaponLayer.arr_weapons[n].angle=this.layer_elecanon.children[n].angle,c.default.once.GameLayer.WeaponLayer.arr_weaponAn[n].node.angle=this.layer_elecanon.children[n].angle,this.scheduleOnce(function(){var e={seatId:i.seatId,award:i.award,skillId:s.HQL2EffectType.Bill,fid:21};c.default.once.GameLayer.EffectLayer.addEffect(e)},3)}},t.prototype.changeLeserRotationByTid=function(e,t,o){void 0===o&&(o=!0);var n=c.default.once.tableConvertIndex(t);if(this.layer_elecanon.children[n]){n>1&&o&&(e.y=cc.view.getVisibleSize().height-e.y);var i=-this.getConvertLeserRotationByTid(e,t);this.layer_elecanon.children[n].angle=i}},t.prototype.getConvertLeserRotationByTid=function(e,t,o){void 0===o&&(o=0);var n=c.default.once.tableConvertIndex(t),i=this.layer_elecanon.children[n];if(cc.isValid(i)){var a=i.convertToWorldSpaceAR(cc.v2(0,o));return c.default.once.convertPointToAngle(a,e)-90}},t.prototype.showNetMs=function(){this.lb_ms.string="\u5ef6\u8fdf\uff1a"+(s.HQL2Const.once.NetUp+s.HQL2Const.once.NetDown)},t.prototype.prefixInteger=function(e,t){return(e/Math.pow(10,t)).toFixed(t).substr(2)},t.prototype.showLable=function(e){this.lb_fire.node.parent.active=e<-60;var t=Math.ceil(90+e)<0?0:Math.ceil(90+e);this.lb_fire.string="Since you have'nt fired in a minute, you will leave the game in "+t+" s"},t.prototype.showRecharge=function(){Common.showMessage("not enough balance")},t.prototype.onClickedCloseRechargeTip=function(){this.layer_recharge.active=!1,this.layer_recharge.opacity=255,this.layer_recharge.stopAllActions()},t.prototype.defaultLight=function(e){var t="0;0;1000".split(";"),o=t[0]||0,n=t[1]||0,i=e.convertToWorldSpaceAR(cc.v2(parseFloat(o+""),parseFloat(n+""))),a=t[2]||1500;this.initLight(i,a)},t.prototype.initLight=function(e,t){this.v2Light=e,this.lightHeight=parseFloat(t)},t.prototype.pushFishEffect=function(e,t,o,n){for(var i=0;i<e.length;i++){var a=r.default.deepCopy(o),s=e[i];s.alive&&(s.pushEffect(t,a),n&&a.fishId!==s.fishId&&(a.target=s.node.position,a.playSFX=0===i,a.end=i===e.length-1,c.default.once.GameLayer.addEffect(a)))}},t.prototype.addEffect=function(e){var t=this;if(cc.isValid(this.node)){var o=r.default.deepCopy(e);if(o.skillId===s.HQL2EffectType.ICE&&(o.duringTime=o.leftTime||10,o.position=o.position||cc.v2(0,0),this.pushFishEffect(c.default.once.GameLayer.getFishs(),o.skillId,o)),o.skillId===s.HQL2EffectType.FIRE_TOTLE&&c.default.once.GameLayer.addEffect(o),o.skillId===s.HQL2EffectType.COIN_BOOM&&c.default.once.GameLayer.addEffect(o),o.skillId===s.HQL2EffectType.FIRE_TOTLE_BALL&&(c.default.once.GameLayer.addEffect(o),this.an_play.node.active=!0,this.an_play.play("h")),o.skillId===s.HQL2EffectType.XUAN_WO){var n=c.default.once.tableConvertIndex(o.seatId),i=this.an_xws[n];i.node.parent.active=!0,i.bombId=o.bombId;var a=c.default.once.getSwimAnimateByID(o.fid);a.wrapMode=cc.WrapMode.Loop,i.addClip(a),i.play(a.name),i.node.angle=0,i.node.stopAllActions(),i.node.runAction(cc.sequence(cc.rotateBy(5,1200),cc.callFunc(function(){i.node.parent.active=!1;var e={seatId:o.seatId,award:o.award,skillId:s.HQL2EffectType.Bill,fid:50};c.default.once.GameLayer.EffectLayer.addEffect(e)})))}if(o.skillId===s.HQL2EffectType.XUAN_WO_SUB){n=c.default.once.tableConvertIndex(o.seatId);var l=this.an_xws[n];o.wsp=l.node.parent.convertToWorldSpaceAR(cc.v2(0,0)),c.default.once.GameLayer.addEffect(o)}if(o.skillId===s.HQL2EffectType.SUPER_BOOM){n=c.default.once.tableConvertIndex(o.seatId),this.layer_elecanon.children[n].angle=0,c.default.once.GameLayer.addEffect(o);var d=r.default.deepCopy(o);d.toLeser=this.an_elecanon[o.index].node.parent.getChildByName("title_22"),d.toLeser.active=!1,d.title="09",d.skillId=s.HQL2EffectType.LASER_BOOM,c.default.once.GameLayer.addEffect(d)}if(o.skillId===s.HQL2EffectType.SUPER_BOOM_SUB)return c.default.once.GameLayer.addEffect(o);if(o.skillId===s.HQL2EffectType.LONG&&c.default.once.GameLayer.addEffect(o),o.skillId===s.HQL2EffectType.DRILL_BOOM_BLAST&&c.default.once.GameLayer.addEffect(o),o.skillId===s.HQL2EffectType.DRILL_BOOM){cc.log("-------------\x3e"+JSON.stringify(o)),n=c.default.once.tableConvertIndex(o.seatId),c.default.once.GameLayer.WeaponLayer.arr_weapons[n].angle=n>1?180:0,c.default.once.GameLayer.WeaponLayer.arr_weaponAn[n].node.angle=n>1?180:0,this.layer_elecanon.children[n].angle=0;var p=this.an_20s[n].getChildByName("title_20");p.active=!0;var h=this.an_20s[n].getChildByName("an_cannon");h.active=!1;var f=this.an_20s[n].parent.convertToWorldSpaceAR(this.an_20points[n]);c.default.once.GameLayer.WeaponLayer.changeWeaponRotationByTid(f,o.seatId,!1),p.stopAllActions(),p.opacity=0,p.scale=0,p.position=p.parent.convertToNodeSpaceAR(o.point),this.an_20s[n].active=!0;var u=n>1?-130:130;p.runAction(cc.sequence(cc.spawn(cc.fadeIn(.3),cc.scaleTo(.3,1),cc.jumpBy(1,cc.v2(0,0),150,2)),cc.delayTime(.5),cc.moveTo(.8,cc.v2(0,u)),cc.callFunc(function(){h.active=!0}),cc.delayTime(1),cc.fadeOut(.3)))}if(o.skillId===s.HQL2EffectType.IROULETE){var y=r.default.deepCopy(o);y.skillId=s.HQL2EffectType.SUPER_BOOM_SUB,c.default.once.GameLayer.addEffect(y);var _=c.default.once.tableConvertIndex(o.seatId);this.layer_elecanon.children[_].angle=0,this.an_24s[_].stopAllActions(),this.an_24s[_].opacity=0,this.an_24s[_].scale=0,this.an_24s[_].position=this.an_24s[_].parent.convertToNodeSpaceAR(o.point),this.an_24s[_].active=!0,this.an_24s[_].runAction(cc.sequence(cc.spawn(cc.fadeIn(.3),cc.scaleTo(.3,1),cc.jumpBy(1,cc.v2(0,0),150,2)),cc.delayTime(.5),cc.moveTo(.8,this.an_24points[_])));var L=o.award/s.HQL2Const.once.RoomBet;L=L/c.default.once.GameLayer.WeaponLayer.getLevelCoinByUID(o.userId)/10;var g=r.default.randomNum(0,100)>50?0:1,m=this.an_24s[_].getChildByName("bg0");m.stopAllActions(),m.angle=0,cc.find("bg0/lb_1",this.an_24s[_]).getComponent("HQL2Label").string="x20",cc.find("bg0/lb_0",this.an_24s[_]).getComponent("HQL2Label").string="x20",cc.find("bg0/lb_"+g,this.an_24s[_]).getComponent("HQL2Label").string="x"+Math.floor(L);var v=this.an_24s[_].getChildByName("gold").getComponent(cc.Animation);v.node.scale=1,v.play("gold_rout"),this.an_24s[_].getChildByName("max").opacity=0,this.an_24s[_].getChildByName("max").active=!0,(w=[cc.delayTime(2.5)]).push(cc.fadeIn(.2));for(var C=0;C<2;C++)w.push(cc.scaleTo(.3,1.2)),w.push(cc.scaleTo(.3,1));w.push(cc.fadeOut(.3)),this.an_24s[_].getChildByName("max").runAction(cc.sequence(w));var I=[];I.push(cc.delayTime(3.5));var b=3600-[-45,45][g];I.push(cc.rotateTo(3,b).easing(cc.easeOut(3))),I.push(cc.callFunc(function(){v.node.scale=.7,v.play("gold")})),I.push(cc.delayTime(3)),I.push(cc.callFunc(function(){t.an_24s[_].active=!1;var e={seatId:o.seatId,award:o.award,skillId:s.HQL2EffectType.Bill,fid:24};c.default.once.GameLayer.EffectLayer.addEffect(e)})),m.runAction(cc.sequence(I));var F=this.an_24s[_].getChildByName("bg1");F.stopAllActions(),F.angle=0,F.runAction(cc.sequence(cc.delayTime(3.5),cc.rotateTo(2.5,720).easing(cc.easeOut(3))));var H=this.an_24s[_].getChildByName("bg2");H.stopAllActions(),H.angle=0,H.runAction(cc.sequence(cc.delayTime(3.5),cc.rotateTo(2,720).easing(cc.easeOut(3))))}if(o.skillId===s.HQL2EffectType.PI_KA_QIU&&(c.default.once.playSFX("double"),c.default.once.GameLayer.addEffect(o)),o.skillId===s.HQL2EffectType.PI_KA_QIU_LIGHT&&c.default.once.GameLayer.addEffect(o),o.skillId===s.HQL2EffectType.LASER_BOOM&&(this.layer_elecanon.active=!0,n=c.default.once.tableConvertIndex(o.seatId),this.an_elecanon[n].node.active=!0,this.an_elecanon[n].leser=!0,this.an_elecanon[n].seatId=o.seatId,this.an_elecanon[n].award=o.award,this.layer_elecanon.children[n].active=!0,this.layer_elecanon.children[n].angle=0,c.default.once.GameLayer.WeaponLayer.arr_weaponAn[n].node.opacity=0,c.default.once.GameLayer.WeaponLayer.an_lines[n].node.opacity=0,this.layer_elecanon.off(cc.Node.EventType.TOUCH_START,this.onTouchStartElecanon,this),o.toLeser=this.an_elecanon[n].node.getChildByName("title"),o.toLeser.active=!1,o.title="title27",c.default.once.GameLayer.addEffect(o),o.seatId==s.HQL2Const.once.seatId&&(this.layer_elecanon.on(cc.Node.EventType.TOUCH_START,this.onTouchStartElecanon,this),s.HQL2Const.once.LeserBulletId=o.bulletId)),o.skillId===s.HQL2EffectType.Fast){o.duringTime=o.time||2,this.pushFishEffect(c.default.once.GameLayer.getFishs(),s.HQL2EffectType.Fast,o);var T=cc.view.getVisibleSize().width/2-20;this.sp_haicao.node.stopAllActions(),this.sp_haicao.node.active=!0,this.sp_haicao.node.opacity=0;var Q=-T-70,A=500/-Q/2+3;Q-=1e3;var B=cc.callFunc(function(){t.sp_haicao.node.setPosition(T,0),t.sp_haicao.node.opacity=255,c.default.once.GameLayer.changeSceneBg(o.now,o.anim,o.later)}),S=cc.callFunc(function(){t.sp_haicao.node.active=!1,c.default.once.sendChangeScene()}),w=[cc.delayTime(o.duringTime),B,cc.moveTo(A,cc.v2(Q,0)),cc.delayTime(2),S];this.sp_haicao.node.runAction(cc.sequence(w))}if(o.skillId===s.HQL2EffectType.Bill){o.index=c.default.once.tableConvertIndex(o.seatId),o.nid=r.default.generateMixed(20);var E=this.map_info.get(o.seatId)||[];o.position=c.default.once.GameLayer.WeaponLayer.getWeaponOutPositionByTid(o.seatId,0),o.position.y=o.index>1?o.position.y-160:o.position.y+160,o.limit=o.limit||o.type,E.push(o),this.map_info.set(o.seatId,E),this.checkPlayBill(o)}o.skillId===s.HQL2EffectType.SamllBill&&(this.map_sameinfo.push(o),this.refreshSmallBill())}},t.prototype.hideEffect20=function(e){var t=c.default.once.tableConvertIndex(e);this.an_20s[t].active=!1},t.prototype.checkPlayBill=function(e){var t=this.map_info.get(e.seatId),o=function(e,t,o,n){for(var i=!0,a=0,s=0,c=0;c<e.length;c++)e[c].limit===t&&o!==e[c].nid&&(i=!1),e[c].limit===t&&a++,e[c].limit!==t||e[c].playing||s++;return i&&n||s===a&&0!==s};if(t)for(var n=0;n<t.length;n++){var i=t[n];o(t,i.limit,i.nid,!i.playing)&&(t[n].playing=!0,this.map_info.set(e.seatId,t),c.default.once.playSFX("bill_big"),c.default.once.GameLayer.addBill(t[n]))}},t.prototype.onFinishEffect=function(e){if(-1!==[s.HQL2EffectType.Bill].indexOf(e.skillId)){for(var t=this.map_info.get(e.seatId),o=0;o<t.length;o++)if(t[o].nid===e.nid){t.splice(o,1);break}this.map_info.set(e.seatId,t),this.checkPlayBill(e)}e.skillId===s.HQL2EffectType.SUPER_BOOM&&(this.an_elecanon[e.index].node.parent.getChildByName("title_22").active=!1),e.skillId===s.HQL2EffectType.FIRE_TOTLE_BALL&&(this.an_play.node.active=!1),e.skillId===s.HQL2EffectType.LONG&&(this.layer_4long.active=!1)},t.prototype.show4long=function(e,t){void 0===e&&(e=1),void 0===t&&(t=0),this.layer_4long.active=!0;for(var o=0;o<this.layer_4long.children.length;o++){var n=this.layer_4long.children[o].getComponent(dragonBones.ArmatureDisplay);n.timeScale=e,n.playAnimation("swim",1),n.node.angle=[0,90,180,270][o]+t}},t.prototype.updateShadowEffect=function(e,t){var o=e.x-this.v2Light.x,n=e.y-this.v2Light.y,i=cc.v2(0,0),a=e.sub(this.v2Light).mag(),s=(t+this.lightHeight)*a/this.lightHeight;return i.x=e.x+o*(s/a-1),i.y=e.y+n*(s/a-1),i},t.prototype.finishieEle=function(e){this.an_elecanon[e].node.active=!1,this.an_eleLight[e].node.active=!1,c.default.once.GameLayer.WeaponLayer.arr_weaponAn[e].node.opacity=255,c.default.once.GameLayer.WeaponLayer.an_lines[e].node.opacity=255},t.prototype.onFinishEleLight0=function(){this.finishieEle(0)},t.prototype.onFinishEleLight1=function(){this.finishieEle(1)},t.prototype.onFinishEleLight2=function(){this.finishieEle(2)},t.prototype.onFinishEleLight3=function(){this.finishieEle(3)},t.prototype.update=function(e){this.bill_cd-=e,this.bill_cd<0&&(this.bill_cd=5,this.refreshSmallBill()),this.effectinfo&&c.default.once.GameLayer.WeaponLayer.showKilinLineByTid(this.effectinfo.seatId,this.effectinfo.dFish)},t.prototype.onDestroy=function(){},a([p(cc.Animation)],t.prototype,"an_waves",void 0),a([p(cc.Animation)],t.prototype,"an_play",void 0),a([p(cc.Animation)],t.prototype,"an_crush",void 0),a([p(cc.Label)],t.prototype,"lb_fire",void 0),a([p(cc.Node)],t.prototype,"layer_recharge",void 0),a([p(cc.Node)],t.prototype,"layer_4long",void 0),a([p(cc.Node)],t.prototype,"layer_elecanon",void 0),a([p(sp.Skeleton)],t.prototype,"sp_haicao",void 0),a([p([cc.Node])],t.prototype,"an_24s",void 0),a([p([cc.Node])],t.prototype,"an_20s",void 0),a([d],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./HQL2Const":"HQL2Const","./HQL2Manager":"HQL2Manager"}],HQL2Effect:[function(e,t,o){"use strict";cc._RF.push(t,"d5545TuvJ1MHJlg2xWErfVZ","HQL2Effect");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(a<3?i(s):a>3?i(t,o,s):i(t,o))||s);return a>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../../Script/utils/Utils"),c=e("./HQL2Const"),r=e("./HQL2Fish"),l=e("./HQL2Manager"),d=cc._decorator,p=d.ccclass,h=(d.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"an_effect",{get:function(){var e=this.node.getChildByName("an_effect").getComponent(cc.Animation);return e.on("finished",this.onFinishAnimate,this),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"an_1",{get:function(){return this.node.getChildByName("sp_1").getComponent(cc.Animation)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"an_0",{get:function(){return this.node.getChildByName("sp_0").getComponent(cc.Animation)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"an_2",{get:function(){return this.node.getChildByName("sp_2").getComponent(cc.Animation)},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){this.sp_effect=this.node.getChildByName("an_effect").getComponent(cc.Sprite),this.sp_2=this.node.getChildByName("sp_2").getComponent(cc.Sprite),this.sp_1=this.node.getChildByName("sp_1").getComponent(cc.Sprite),this.sp_0=this.node.getChildByName("sp_0").getComponent(cc.Sprite),this.sp_3=this.node.getChildByName("sp_3").getComponent(cc.Sprite),this.sp_0.node.on("click",this.onClickedEffect,this),this.dr=this.node.getChildByName("dr"),this.pat=this.node.getChildByName("pat"),this.lb_coin=this.node.getChildByName("lb_coin").getComponent("HQL2Label")},t.prototype.showDDBoom=function(){var e=this;this.sp_0.spriteFrame=l.default.once.getAtlasByType("effect22").getSpriteFrame("bomb22_light");for(var t=[],o=0;o<2;o++)t.push(cc.callFunc(function(){e.sp_0.node.opacity=0,e.sp_0.node.scale=0})),t.push(cc.spawn(cc.fadeIn(.3),cc.scaleTo(.3,1.5))),t.push(cc.fadeOut(.05)),t.push(cc.delayTime(.4));t.push(cc.callFunc(function(){e.onFinishAnimate()})),this.sp_0.node.runAction(cc.sequence(t))},t.prototype.init=function(e){var t=this;this.node.position=e.position||cc.v2(0,0),this.node.angle=0,this.node.active=!0,e.parent=!1,this.lb_coin.node.active=!1,this.node.zIndex=0,this.param=e,this.node.scale=1,this.node.stopAllActions(),this.node.opacity=255,this._enableUpdate=!1,this.dr.setPosition(0,0),this.dr.active=e.skillId==c.HQL2EffectType.FIRE_TOTLE||e.skillId==c.HQL2EffectType.FIRE_TOTLE_BALL,this.pat.active=e.skillId==c.HQL2EffectType.COIN_BOOM;for(var o=0;o<5;o++){var n=this.node.children[o].getComponent(cc.Sprite),i=this.node.children[o].getComponent(cc.Animation);i.stop(),i.pause(),n.node.active=!0,n.spriteFrame=null,n.node.scale=1,n.node.stopAllActions(),n.node.opacity=255,n.node.color=cc.Color.WHITE,n.node.angle=0,n.node.anchorX=.5,n.node.setPosition(0,0)}if(e.skillId==c.HQL2EffectType.COIN_BOOM){for(o=0;o<this.pat.children.length;o++)this.pat.children[o].getComponent(cc.ParticleSystem).resetSystem();this.scheduleOnce(function(){t.onFinishEffect()},4)}if(e.skillId===c.HQL2EffectType.LASER_BOOM){this.sp_0.spriteFrame=c.HQL2Const.once.UIAtals.getSpriteFrame(e.title);var a=e.toLeser.convertToWorldSpaceAR(cc.v2(0,0));a=this.node.parent.convertToNodeSpaceAR(a),this.node.scale=0,this.node.opacity=0,this.node.runAction(cc.sequence(cc.spawn(cc.fadeIn(.2),cc.scaleTo(.2,1.2)),cc.scaleTo(.1,1),cc.moveTo(.5,cc.v2(a.x,a.y)),cc.callFunc(function(){t.onFinishEffect()})))}if(e.skillId==c.HQL2EffectType.LONG){(F=l.default.once.getEffectByType("ball_")).wrapMode=cc.WrapMode.Loop,this.lb_coin.node.active=!0,this.lb_coin.string=0,this.an_effect.addClip(F),this.an_effect.play(F.name);var d=[];for(o=0;o<140;o++)d.push(cc.scaleTo(.1,1.3)),d.push(cc.scaleTo(.1,1.15));l.default.once.playSFX("xing"),this.an_effect.node.runAction(cc.sequence(d));var p=l.default.once.tableConvertIndex(e.seatId),h=l.default.once.GameLayer.EffectLayer.layer_elecanon.children[p].getChildByName("an_get").convertToWorldSpaceAR(cc.v2(0,0));h=this.node.parent.convertToNodeSpaceAR(h);var f=[];f.push(cc.moveTo(1,cc.v2(0,0)));var u=[2,2,1.8,1.6,1.5,1.5,1.5,1.5,1.5,1.5,1.5],y=[3,3.5,4,5,5.2,5.4,5.6,5.8,6,6.2,6.4],_=function(o){f.push(cc.callFunc(function(){l.default.once.stopSFX("S2SS"),l.default.once.playSFX("S2SS"),l.default.once.playSFX("S21SS"),l.default.once.GameLayer.EffectLayer.show4long(y[o],30*o)})),f.push(cc.delayTime(.5)),f.push(cc.callFunc(function(){var n=e.award*(o+1)/u.length;t.lb_coin.string=l.default.once.GameLayer.changeGold(n)})),f.push(cc.delayTime(u[o]-.5))};for(o=0;o<u.length;o++)_(o);f.push(cc.delayTime(1)),f.push(cc.moveTo(.5,h)),f.push(cc.fadeOut(.5)),f.push(cc.callFunc(function(){var o={seatId:e.seatId,award:e.award,skillId:c.HQL2EffectType.Bill,fid:39};l.default.once.GameLayer.EffectLayer.addEffect(o),l.default.once.stopSFX("S2SS"),t.onFinishEffect()})),this.node.runAction(cc.sequence(f))}if(e.skillId==c.HQL2EffectType.FIRE_TOTLE_BALL&&(console.log("\u9f99\u9f9f\u51fa\u573a\uff01"),this.drPlay("swim",0),l.default.once.playSFX("xuanfeng"),this.node.runAction(cc.sequence(cc.spawn(cc.moveTo(1,cc.v2(0,0)),cc.rotateBy(1,3600)),cc.callFunc(function(){t.node.angle=0,t.drPlay("explode",1),l.default.once.playSFX("pen_0"),l.default.once.stopSFX("xuanfeng")}),cc.delayTime(1),cc.callFunc(function(){t.node.angle=-90,t.drPlay("spread",1),l.default.once.playSFX("pen_1"),l.default.once.CmdHQL2SuperBomb(t.param,t,3)}),cc.delayTime(1),cc.callFunc(function(){t.drPlay("swim",0),l.default.once.playSFX("xuanfeng")}),cc.rotateBy(1.5,3600),cc.callFunc(function(){t.node.angle=0,t.drPlay("explode",1),l.default.once.playSFX("pen_0"),l.default.once.stopSFX("xuanfeng")}),cc.delayTime(1),cc.callFunc(function(){t.node.angle=-90,t.drPlay("spread",1),l.default.once.playSFX("pen_1"),l.default.once.CmdHQL2SuperBomb(t.param,t,3)}),cc.delayTime(1),cc.callFunc(function(){t.drPlay("swim",0),l.default.once.playSFX("xuanfeng")}),cc.rotateBy(1.5,3600),cc.callFunc(function(){t.node.angle=0,t.drPlay("explode",1),l.default.once.stopSFX("xuanfeng"),l.default.once.playSFX("pen_0")}),cc.delayTime(1),cc.callFunc(function(){t.node.angle=-90,l.default.once.playSFX("xuanfeng"),t.drPlay("spread",1),l.default.once.playSFX("pen_1"),l.default.once.CmdHQL2SuperBomb(t.param,t,3)}),cc.delayTime(1),cc.callFunc(function(){t.onFinishEffect(),l.default.once.stopSFX("xuanfeng");var o={seatId:e.seatId,award:e.award,skillId:c.HQL2EffectType.Bill,fid:30};l.default.once.GameLayer.EffectLayer.addEffect(o)})))),e.skillId==c.HQL2EffectType.FIRE_TOTLE){l.default.once.playSFX("xuanfeng"),this._lastUpdateTime=this._initTime=Date.now(),this._enableUpdate=!0,this.angle=e.angle;var L=[0,0,0,0],g=[1,2,3,0];for(console.log("\u9f99\u9f9f\u51fa\u573a\uff01"),o=0;o<this.dr.children.length;o++){var m=this.dr.children[o].getComponent(dragonBones.ArmatureDisplay);m.node.active=L.length>o;var v=l.default.once.GameLayer.LoadingLayer.fishsDBA[L[o]];m.dragonAsset=v;var C=l.default.once.GameLayer.LoadingLayer.fishsDBAT[g[o]];m.dragonAtlasAsset=C,m.armatureName="fish18",m.playAnimation("swim",0)}var I=7200+e.rotation,b=cc.v2(e.position.x,e.position.y);c.HQL2Const.once.seatId>1&&(b.y=-b.y),this.node.runAction(cc.sequence(cc.rotateBy(2.5,I/2),cc.callFunc(function(){l.default.once.playSFX("xuanfeng")}),cc.rotateBy(2.5,I/2),cc.callFunc(function(){t._enableUpdate=!1}),cc.spawn(cc.rotateBy(1,I/2.5),cc.moveTo(1,b)),cc.callFunc(function(){t.node.angle=-90,t.drPlay("explode",1),l.default.once.playSFX("pen_0")}),cc.delayTime(1),cc.callFunc(function(){t.node.angle=-e.rotation,t.drPlay("spread",1),l.default.once.playSFX("tao")}),cc.delayTime(2),cc.callFunc(function(){t.param.param=s.default.deepCopy(t.param.param),t.param.param.index=0,l.default.once.GameLayer.refreshFish(t.param.param),t.onFinishEffect()})))}if(cc.WrapMode.Normal,e.skillId===c.HQL2EffectType.SUPER_BOOM){var F;(F=l.default.once.getEffectByType("bomb24_0_")).wrapMode=cc.WrapMode.Loop,this.an_1.addClip(F);var H=l.default.once.getEffectByType("bomb24_1_");H.wrapMode=cc.WrapMode.Loop,this.an_1.addClip(H),this.param.count=-1,this.an_1.node.scale=2,this.an_1.play(F.name),this.showDDBoom()}if(e.skillId===c.HQL2EffectType.SUPER_BOOM_SUB){l.default.once.playSFX("boom");var T=l.default.once.getEffectByType("explose_");this.an_effect.node.scale=3,T.wrapMode=cc.WrapMode.Normal,this.an_effect.addClip(T),this.an_effect.play(T.name)}if(e.skillId===c.HQL2EffectType.XUAN_WO_SUB){T=l.default.once.getSwimAnimateByID(e.fid);var Q=s.default.randomNum(0,100)-50,A=s.default.randomNum(0,100)-50,B=this.node.parent.convertToNodeSpaceAR(e.wsp);this.node.x+=Q,this.node.y+=A,this.an_2.node.x+=Q,this.an_2.node.x+=A,this.node.runAction(cc.sequence(cc.spawn(cc.moveTo(3,cc.v2(B.x+Q,B.y+A)),cc.rotateBy(5,720)),cc.callFunc(function(){t.onFinishEffect()}))),T.wrapMode=cc.WrapMode.Normal,this.an_2.addClip(T),this.an_2.play(T.name)}if(e.skillId===c.HQL2EffectType.DRILL_BOOM_BLAST){l.default.once.playSFX("boom");var S=e.bombfish?l.default.once.getEffectByType("explose_"):l.default.once.getEffectByType("blast_");this.an_effect.node.scale=2,this.an_effect.node.angle=e.angle,S.wrapMode=cc.WrapMode.Normal,this.an_effect.addClip(S),this.an_effect.play(S.name)}if(e.skillId==c.HQL2EffectType.PI_KA_QIU_LIGHT){var w=l.default.once.getSwimAnimateByID("23");w.wrapMode=cc.WrapMode.Loop,this.an_effect.node.scale=1,this.an_effect.addClip(w),this.an_effect.play(w.name),this.an_effect.node.runAction(cc.sequence(cc.delayTime(4),cc.callFunc(function(){t.onFinishEffect();var o={seatId:e.seatId,award:e.award,skillId:c.HQL2EffectType.Bill,fid:23};l.default.once.GameLayer.EffectLayer.addEffect(o)})))}if(e.skillId==c.HQL2EffectType.PI_KA_QIU){var E=cc.v2(e.to.x,e.to.y).sub(cc.v2(e.position.x,e.position.y)).mag(),k=l.default.once.getEffectByType("chain_");k.wrapMode=cc.WrapMode.Loop,this.an_effect.node.anchorX=0,this.an_effect.addClip(k);var O=E/566;this.an_effect.node.scaleX=O;var x=l.default.once.convertPointToAngle(e.to,e.position);this.node.angle=-x,this.node.opacity=0;var P=l.default.once.getFishByFishId(e.fishId);this.node.runAction(cc.sequence(cc.delayTime(e.delay),cc.fadeIn(.01),cc.callFunc(function(){t.an_effect.play(k.name),P instanceof r.default&&(P.enbaleMove=!1,P.resetEffect("23"))}),cc.delayTime(.5),cc.callFunc(function(){P instanceof r.default&&(P.playDieAni(),e.position=e.coinPosition,l.default.once.addResultCoin(e)),t.an_effect.stop(),t.onFinishEffect()})))}},t.prototype.drPlay=function(e,t){for(var o=0;o<this.dr.children.length;o++)this.dr.children[o].getComponent(dragonBones.ArmatureDisplay).playAnimation(e,t)},t.prototype.onFinishAnimate=function(){var e=this;if(this.param.skillId===c.HQL2EffectType.SUPER_BOOM&&++this.param.count<=4){var t=cc.view.getVisibleSize(),o=cc.v2(-t.width/4,t.height/4),n=cc.v2(-t.width/4,-t.height/4),i=cc.v2(t.width/4,-t.height/4),a=cc.v2(t.width/4,t.height/4),r=s.default.deepCopy(this.param);if(r.skillId=c.HQL2EffectType.SUPER_BOOM_SUB,r.position=this.node.position,l.default.once.GameLayer.EffectLayer.addEffect(r),l.default.once.CmdHQL2SuperBomb(this.param,this),this.an_1.node.scale=1,this.an_1.play("bomb24_1_"),this.param.count<4){var d=[o,i,n,a][this.param.count],p=[];return p.push(cc.delayTime(.5)),p.push(cc.jumpTo(1,d,150,1)),p.push(cc.callFunc(function(){e.an_1.play("bomb24_0_"),e.an_1.node.scale=2,e.showDDBoom()})),void this.node.runAction(cc.sequence(p))}var h={seatId:this.param.seatId,award:this.param.award,skillId:c.HQL2EffectType.Bill,fid:22};l.default.once.GameLayer.EffectLayer.addEffect(h)}this.onFinishEffect()},t.prototype.onFinishEffect=function(){if(l.default.once.GameLayer.EffectLayer.onFinishEffect(this.param),l.default.once.GameLayer.despawnEffect(this),this.param.skillId===c.HQL2EffectType.DRILL_BOOM_BLAST&&this.param.bombfish){var e={seatId:this.param.seatId,award:this.param.award,skillId:c.HQL2EffectType.Bill,fid:20};l.default.once.GameLayer.EffectLayer.addEffect(e)}},t.prototype.onClickedEffect=function(){this.param&&this.param.clicked},t.prototype.clean=function(){this.unscheduleAllCallbacks(),this.node.stopAllActions(),this.param&&(this.param.clicked=!0);for(var e=0;e<5;e++){var t=this.node.children[e].getComponent(cc.Sprite);t.spriteFrame=null,t.node.stopAllActions(),t.node.removeComponent(cc.Animation),t.node.addComponent(cc.Animation)}},t.prototype.setOutPosition=function(e){this.angle=e.angle,this.node.x+=e.x,this.node.y+=e.y},t.prototype.update=function(){if(this._enableUpdate){var e=Date.now(),t=(e-this._lastUpdateTime)/1e3;this._lastUpdateTime=e;var o=cc.v2(1.3*c.HQL2Const.once.BulletSpeed.x,1.3*c.HQL2Const.once.BulletSpeed.y),n=l.default.once.calculateSpacePoint({angle:this.angle,space:t,speed:o});this.node.x+=n.x,this.node.y+=n.y;var i=l.default.once.convertPositionAngle({x:this.node.x,y:this.node.y,angle:this.angle});i.out&&this.setOutPosition(i),this.node.angle=-this.angle}},a([p],t)}(cc.Component));o.default=h,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./HQL2Const":"HQL2Const","./HQL2Fish":"HQL2Fish","./HQL2Manager":"HQL2Manager"}],HQL2FishNet:[function(e,t,o){"use strict";cc._RF.push(t,"88ffcsDPV5Dnp2ehb1OCkvP","HQL2FishNet");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(a<3?i(s):a>3?i(t,o,s):i(t,o))||s);return a>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./HQL2Const"),c=e("./HQL2Manager"),r=cc._decorator,l=r.ccclass,d=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.netRedius=70,t}return i(t,e),t.prototype.onLoad=function(){this.sp_net=this.node.getComponent(cc.Sprite),this.an_net=this.node.getComponent(cc.Animation)},t.prototype.onFinishNet=function(){c.default.once.GameLayer?c.default.once.GameLayer.despawnNet(this):this.node.destroy()},t.prototype.init=function(e,t,o,n){this.node.position=this.node.parent.convertToNodeSpaceAR(e),this.node.active=!0,this.node.angle=o,this.sp_net.spriteFrame=null,(t+=1)>4&&(t=4),t<1&&(t=1),this.sp_net.spriteFrame=s.HQL2Const.once.UIAtals.getSpriteFrame("wang"+n),this.node.opacity=255,this.node.scale=.8;var i=[],a=cc.scaleTo(s.HQL2Const.once.NetMaxTime,.9);i.push(a);var c=cc.scaleTo(2*s.HQL2Const.once.NetMaxTime/3,.8);i.push(c),i.push(cc.fadeOut(.1));var r=cc.callFunc(this.onFinishNet.bind(this));i.push(r),this.node.runAction(cc.sequence(i))},t.prototype.onDestroy=function(){this.an_net.clear()},a([l],t)}(cc.Component));o.default=d,cc._RF.pop()},{"./HQL2Const":"HQL2Const","./HQL2Manager":"HQL2Manager"}],HQL2Fish:[function(e,t,o){"use strict";cc._RF.push(t,"900b8IbCUxIKLWJdH3zVWGW","HQL2Fish");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(a<3?i(s):a>3?i(t,o,s):i(t,o))||s);return a>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../../Script/utils/Utils"),c=e("./HQL2Const"),r=e("./HQL2Manager"),l=cc._decorator,d=l.ccclass,p=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fid=-1,t.fishId=-1,t.index=-1,t._state=c.HQL2FishStatus.Die,t._outBorder=!1,t.skillId=-1,t.enbaleMove=!0,t.lastPosition=null,t.initTime=0,t._lastUpdateTime=0,t.swimTime=10,t.leaveTime=0,t.mapEffects=new Map,t.radius=0,t.dieCD=0,t._cd=0,t}return i(t,e),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){this._state=e,this.checkLock()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outBorder",{get:function(){return this._outBorder},set:function(e){this._outBorder=e,this.checkLock()},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){this.initView()},t.prototype.initView=function(){this.sp_fish=this.node.getChildByName("sp_fish").getComponent(cc.Sprite),this.sp_effect=this.node.getChildByName("sp_effect").getComponent(cc.Sprite),this.sp_shadow=this.node.getChildByName("sp_shadow").getComponent(cc.Sprite),this.an_fish=this.sp_fish.node.getComponent(cc.Animation),this.an_fish.on("finished",this.onFinishAnimate,this),this.node.on(cc.Node.EventType.TOUCH_START,this.onClickFish,this),this.sp_fish.node.on(cc.Node.EventType.TOUCH_START,this.onClickFish,this),this.sp_effect.node.on(cc.Node.EventType.TOUCH_START,this.onClickFish,this),this.dr_fishs=[];for(var e=this.node.getChildByName("dr_fish"),t=0;t<e.children.length;t++)this.dr_fishs.push(e.children[t].getComponent(dragonBones.ArmatureDisplay))},t.prototype.onClickFish=function(e){cc.log("\u70b9\u51fb\uff1a"+this.config.Name),r.default.once.GameLayer.WeaponLayer.onTouchStart(e,this)},t.prototype.init=function(e){var t=this;this.params=e,this.node.active=!0,this.flipY=c.HQL2Const.once.seatId>1,this.fid=e.fid,this.fishId=e.fishId,this.index=e.index,this.skillId=e.skillId,this.swimTime=e.pathInterval,this.initTime=Date.now()-e.compensate-1e3*e.swimmingInterval,this.config=e.config,this.FishPath=e.FishPath;var o=e.groups.points[this.index];if(this.gpoint=cc.v2(e.groups.origin.x+o.x,e.groups.origin.y+o.y),this.colliders=e.conlliderPoints,this.resetInfo(),this.dr_fishs[0].node.parent.active="1"==e.config.AnimType,"0"==e.config.AnimType)this.refreshSwimAni(),this.an_fish.play(this.params.swimAni.name);else{var n=[],i=[],a="swim",l="";30==parseInt(e.fid)&&(a="swim1",l="fish18",n=[0,0,0,0],i=[1,3,2,0]),34==parseInt(e.fid)&&(l="fish22",n=[3],i=[9]),35==parseInt(e.fid)&&(l="fish20",n=[1,1],i=[5,4]),39==parseInt(e.fid)&&(l="fish23",n=[4,4],i=[11,10]),43==parseInt(e.fid)&&(l="fish21",n=[2,2,2],i=[7,8,6]),console.log("boss coming : "+l);for(var d=0;d<this.dr_fishs.length;d++){this.dr_fishs[d].node.active=n.length>d;var p=r.default.once.GameLayer.LoadingLayer.fishsDBA[n[d]];this.dr_fishs[d].dragonAsset=p;var h=r.default.once.GameLayer.LoadingLayer.fishsDBAT[i[d]];this.dr_fishs[d].dragonAtlasAsset=h,this.dr_fishs[d].armatureName=l,n.length>d&&this.dr_fishs[d].playAnimation(a,0)}this.node.width=this.dr_fishs[0].node.width,this.node.height=this.dr_fishs[0].node.height}var f=this.node.getChildByName("sp_fish1").getComponent(cc.Animation);if(f.node.active=23==e.config.fishType,23==e.config.fishType){this.an_fish.node.runAction(cc.repeatForever(cc.rotateBy(2,360))),f.node.active=!0;var u=s.default.randomNum(1,12),y=r.default.once.getSwimAnimateByID(u);y.wrapMode=cc.WrapMode.Loop,f.addClip(y),f.play(y.name)}else 39==e.config.fishType?this.sp_fish.node.runAction(cc.repeatForever(cc.sequence(cc.callFunc(function(){t.sp_fish.node.setPosition(-1150,0)}),cc.moveTo(7.3,cc.v2(1150,0))))):(this.sp_fish.node.setPosition(0,0),this.an_fish.node.stopAllActions());2==e.config.propFish&&(this.resetEffect("50"),this.node.width=this.an_effect.node.width,this.node.height=this.an_effect.node.height),this.node.runAction(cc.fadeIn(.1))},t.prototype.resetEffect=function(e){var t=r.default.once.getSwimAnimateByID(e);t.wrapMode=cc.WrapMode.Loop,this.an_effect=this.sp_effect.node.addComponent(cc.Animation),this.an_effect.node.active=!0,this.an_effect.addClip(t),this.an_effect.play(t.name)},t.prototype.refreshSwimAni=function(){for(var e=[this.params.swimAni,this.params.dieAni],t=0;t<e.length;t++){var o=e[t];o.wrapMode=1==t?cc.WrapMode.Normal:cc.WrapMode.Loop,this.an_fish.addClip(o),this.an_fish.play(o.name)}},t.prototype.getColliderPoints=function(){for(var e=this.node.convertToWorldSpaceAR(cc.v2(0,0)),t=[],o=0;o<this.colliders.length;o++)if(t.push(cc.v2(e.x+this.colliders[o].x,e.y+this.colliders[o].y)),39==this.fid){var n=this.sp_fish.node.convertToWorldSpaceAR(cc.v2(0,0));t[o]=cc.v2(n.x+this.colliders[o].x,n.y+this.colliders[o].y)}return{ws:t,zIndex:this.node.zIndex}},t.prototype.resetInfo=function(){this.node.scale=1,this.sp_fish.spriteFrame=null,this.sp_effect.spriteFrame=null,this.sp_effect.node.active=!1,this.node.opacity=0,this.sp_fish.node.color=cc.Color.WHITE,this.an_fish.node.stopAllActions(),this._lastUpdateTime=Date.now(),this.setState(c.HQL2FishStatus.Live),this.dieCD=9999999999,this.outBorder=r.default.once.checkLimitBorder(this.node),this.cleanLockWeapons(),this.enbaleMove=!0,this.mapEffects=null,this.mapEffects=new Map,this.node.zIndex=parseFloat(this.config.Layer||0),this.leaveTime=this.swimTime,this.an_fish.node.angle=0;var e=parseFloat(this.config.Scale),t=this.FishPath.scale*parseFloat(this.config.Scale);this.node.angle=this.FishPath.scale<0?180:0,this.sp_fish.node.setScale(e,t),this.sp_shadow.node.setScale(e,t),this.dr_fishs[0].node.parent.setScale(e,t);for(var o=1;o<2;o++)this.node.getChildByName("sp_fish"+o).active=!1;var n=r.default.once.convertWindowScale();for(o=0;o<this.colliders.length;o++){var i=this.colliders[o],a=i.x*e*n.x,s=i.y*t*n.y;this.radius=Math.max(this.radius,cc.v2(a,s).mag())}this.lastPosition=cc.v2(this.FishPath.points[0].x,this.FishPath.points[0].y),this.node.setPosition(this.lastPosition.x,this.lastPosition.y)},t.prototype.animateFrameChange=function(){this.setShadowSpriteFrame()},t.prototype.getShadowWorldPoint=function(){return this.sp_shadow.node.convertToWorldSpaceAR(cc.v2(0,0))},t.prototype.getWorldPoint=function(){var e={43:cc.v2(0,80),35:cc.v2(50,50),34:cc.v2(150,0)}[this.fid]||cc.v2(0,0);return this.sp_fish.node.convertToWorldSpaceAR(e)},t.prototype.setShadowSpriteFrame=function(){if(this.sp_shadow.spriteFrame!=this.sp_fish.spriteFrame){var e=2!=this.config.propFish&&this.sp_effect.node.active?.5:1;this.sp_shadow.node.scaleX=e*this.sp_shadow.node.scaleX,this.sp_shadow.node.scaleY=e*this.sp_shadow.node.scaleY,this.sp_shadow.spriteFrame=this.sp_effect.node.active?this.sp_effect.spriteFrame:this.sp_fish.spriteFrame}},t.prototype.updateShadowEffect=function(){var e=this.node.convertToWorldSpaceAR(cc.v2(0,0)),t=r.default.once.GameLayer.EffectLayer.updateShadowEffect(e,parseFloat(this.config.Layer)),o=this.sp_shadow.node.parent.convertToNodeSpaceAR(t);this.sp_shadow.node.setPosition(o.x,o.y),this.setShadowSpriteFrame()},t.prototype.getSwimF=function(e){return e-this.initTime},t.prototype.pushEffect=function(e,t){if(e===c.HQL2EffectType.ICE&&this.mapEffects.set(e,{init:Date.now(),duringTime:t.duringTime}),e===c.HQL2EffectType.Fast){var o=this.leaveTime/t.duringTime;this.mapEffects.set(e,o)}},t.prototype.runCurrent=function(e,t){e.currentClip&&e[t](e.currentClip.name)},t.prototype.popEffect=function(e){this.mapEffects.get(e)&&(this.mapEffects.delete(e),e===c.HQL2EffectType.ICE&&(this.alive?this.an_fish.play(this.params.swimAni.name):this.playDieAni()))},t.prototype.setState=function(e){this.state=e},t.prototype.onFinishAnimate=function(){var e=this.an_fish.currentClip;e&&-1!==e.name.indexOf("die")&&this.despawnFish()},t.prototype.pushLockSeat=function(e){return-1===this.lockWeapons.indexOf(e)&&(this.lockWeapons.push(e),!0)},t.prototype.popLockTid=function(e){var t=this.lockWeapons.indexOf(e);-1!==t&&this.lockWeapons.splice(t,1)},t.prototype.cleanLockWeapons=function(){this.lockWeapons=[]},t.prototype.calculateFPoint=function(e){if(e<=1){var t=Math.ceil(this.FishPath.points.length*e);t>this.FishPath.points.length-1&&(t=this.FishPath.points.length-1);var o=this.FishPath.points[t],n=o.y+this.gpoint.y;this.flipY&&(n=-n);var i=this.gpoint.x+o.x;return cc.v2(i*c.HQL2Const.once.winScale.x,n*c.HQL2Const.once.winScale.y)}return cc.v2(1e5,1e5)},t.prototype.updateDegree=function(){var e=cc.v2(this.node.x,this.node.y),t=r.default.once.convertPointToAngle(e,this.lastPosition);this.node.angle=-t,this.lastPosition=e},t.prototype.beAttack=function(){var e=this;this.sp_fish.node.color=cc.Color.BLACK.fromHEX("#FD8484"),this.node.stopActionByTag(c.HQL2Const.once.FishAttackAniTag);var t=cc.sequence([cc.delayTime(c.HQL2Const.once.FishRedDuring),cc.callFunc(function(){e.sp_fish.node.color=cc.Color.WHITE})]);t.setTag(c.HQL2Const.once.FishAttackAniTag),this.node.runAction(t)},t.prototype.playDieAni=function(){"0"==this.config.AnimType?this.an_fish.play(this.params.dieAni.name):this.despawnFish()},t.prototype.goDie=function(){this.enbaleMove=!1,this.dieCD=5,this.setState(c.HQL2FishStatus.Die)},Object.defineProperty(t.prototype,"alive",{get:function(){return this.state===c.HQL2FishStatus.Live},enumerable:!1,configurable:!0}),t.prototype.checkDespawn=function(){this.leaveTime<0&&this.despawnFish()},t.prototype.clearLock=function(){r.default.once.GameLayer.clearLockFishAllBullet(this.fishId),r.default.once.GameLayer.WeaponLayer.cleanFishAllWeaponLock(this),this.cleanLockWeapons()},t.prototype.despawnFish=function(){this.sp_effect.node.stopAllActions(),this.clearLock(),this.unscheduleAllCallbacks(),this.mapEffects=new Map;var e=this.an_fish.getClips();if(e)for(var t=e.length-1;t>=0;t--)this.an_fish.removeClip(e[t],!0);if(this.an_effect){this.an_effect.stop();var o=this.an_effect.getClips();for(t=o.length-1;t>=0;t--)this.an_effect.removeClip(o[t],!0);this.sp_effect.node.removeComponent(cc.Animation),this.an_effect=null}this.node.active=!1,r.default.once.GameLayer?r.default.once.GameLayer.despawnFish(this):this.node.destroy()},t.prototype.checkLock=function(){this.outBorder&&this.alive||this.clearLock()},t.prototype.updateEffect=function(e){var t=this,o=e;if(this.mapEffects.size<=0)return o;var n=Date.now();return this.mapEffects.forEach(function(e,i){var a=t.mapEffects.get(i);i===c.HQL2EffectType.Fast&&(o*=a),i==c.HQL2EffectType.ICE&&((n-a.init)/1e3>=a.duringTime&&t.popEffect(i),o=0)}),o},t.prototype.updatexxx=function(e){if(this._cd-=e,-1!==this.fid){var t=this.updateEffect(e);if(this.enbaleMove){var o=this.updateTime(t);this.updatePonint(o)}(this.dieCD-=e)<0&&this.despawnFish(),this.lastPosition.sub(cc.v2(this.node.x,this.node.y)).mag()>2&&("1"===this.config.Rotation&&this.updateDegree(),this.updateShadowEffect()),this.outBorder=r.default.once.checkLimitBorder(this.node),this._cd<0&&(this._cd=1.8,30==this.fid&&this.outBorder&&r.default.once.playSFX("zoulu")),this.updateLockWeapon()}},t.prototype.updateTime=function(e,t){void 0===t&&(t=!0);var o=this._lastUpdateTime+1e3*e;t&&(this._lastUpdateTime=o);var n=this.getSwimF(o)/1e3;return this.leaveTime=this.swimTime-n,n/this.swimTime},t.prototype.updatePonint=function(e){if(e<=1){var t=this.calculateFPoint(e);this.node.x=t.x,this.node.y=t.y}else this.checkDespawn()},t.prototype.updateLockWeapon=function(){this.lockWeapons.length>0&&r.default.once.showLockLineByTid(this,this.lockWeapons)},t.prototype.onDestroy=function(){},a([d],t)}(cc.Component));o.default=p,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./HQL2Const":"HQL2Const","./HQL2Manager":"HQL2Manager"}],HQL2Label:[function(e,t){"use strict";cc._RF.push(t,"508efjuY3FBNKx2HQu8KTF7","HQL2Label");var o=cc.Enum({LEFT:0,CENTER:1,RIGHT:2});cc.Class({editor:!1,extends:cc.Component,properties:{_layout:{get:function(){var e=this.node.getComponent(cc.Layout);return e||((e=this.node.addComponent(cc.Layout)).type=1),e}},string:{default:"",notify:function(){this._updateWordArt()}},alignType:{type:o,default:o.CENTER,notify:function(){this._checkAnchorX()}},defaultNames:{default:"2"},spriteAtlas:{type:cc.SpriteAtlas,default:null}},onLoad:function(){this._checkAnchorX()},_checkAnchorX:function(){this.alignType===o.CENTER?this.node.anchorX=.5:this.node.anchorX=this.alignType===o.RIGHT?1:0},_updateWordArt:function(){if(!this.spriteAtlas)return cc.log("\u65e0\u6548\u7684 spriteAtlas \u56fe\u96c6\u8d44\u6e90\uff01");this._names=this.defaultNames.split(","),this.setWordArt()},setWordArt:function(){try{for(var e=(""+this.string).split(""),t=this.node.children,n=0,i=0;i<e.length||i<t.length;i++){var a=t[i];if(a||((s=(a=new cc.Node).addComponent(cc.Sprite)).trim=!0,s.sizeMode=cc.Sprite.SizeMode.TRIMMED,s.type=cc.Sprite.Type.SIMPLE),a.parent||(a.parent=this.node),a.active=i<e.length,a.active){var s=a.getComponent(cc.Sprite),c=e[this.alignType!==o.CENTER?e.length-1-i:i];if(c=this._names[0]+c,this._names[1]&&(c+=this._names[1]),void 0===c)return void cc.log("\u56fe\u96c6\u8d44\u6e90spriteAtlas \u627e\u4e0d\u5230\u56fe\u7247\u540d\u79f0\uff1a"+c+"\uff01");s.spriteFrame=this.spriteAtlas.getSpriteFrame(""+c),n+=a.width}}n+=(e.length+1)*this._layout.spacingX,this._layout.paddingLeft=this._layout.spacingX,this._layout.paddingRight=this._layout.spacingX,this.node.width=n,this.alignType===o.RIGHT&&(this._layout.horizontalDirection=1),this.alignType===o.LEFT&&(this._layout.horizontalDirection=1),this.alignType===o.CENTER&&(this._layout.horizontalDirection=0)}catch(r){console.log(r)}}}),cc._RF.pop()},{}],HQL2Loading:[function(e,t,o){"use strict";cc._RF.push(t,"ff444bk451Lc6CUdc384IzC","HQL2Loading");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(a<3?i(s):a>3?i(t,o,s):i(t,o))||s);return a>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../../Script/utils/Utils"),c=e("./HQL2Const"),r=cc._decorator,l=r.ccclass,d=r.property,p=function(t){function o(){var e=null!==t&&t.apply(this,arguments)||this;return e.boom=null,e.zoulu=null,e.hong_1=null,e.fushui=null,e.fangda=null,e.taotuo=null,e.pen_0=null,e.pen_1=null,e.tao=null,e.cai=null,e.tiao=null,e.weiba=null,e.xing=null,e.s31=null,e.xuanfeng=null,e.zhua=null,e.zhuag=null,e.shui=null,e.S2SS=null,e.S21SS=null,e.double=null,e.bill_big=null,e.effect_101=null,e.effect_205=null,e.click=null,e.back=null,e.bill_min=null,e.die=null,e.die_big=null,e.die_small=null,e.effect_108=null,e.gold=null,e.gold_effect=null,e.gold_small=null,e.lock=null,e.weapon_change=null,e.v1=null,e.v2=null,e.v3=null,e.v4=null,e.v5=null,e.v6=null,e.v7=null,e.v8=null,e.v9=null,e.bg0=null,e.bg1=null,e.bg2=null,e.jiguang=null,e.j0=null,e.j1=null,e.j2=null,e.kong0=null,e.mogui=null,e.dian=null,e.configs=[],e.fishs=[],e.fishsDBA=[],e.fishsDBAT=[],e.effectArr=[],e.billSPS=[],e}return i(o,t),o.prototype.onLoad=function(){c.HQL2Const.once.PlayerInfo=e("PlayerInfo").getInstant,c.HQL2Const.once.RoomBet=c.HQL2Const.once.PlayerInfo.RoomBet,c.HQL2Const.once.PlayerInfo.fishBetList&&(c.HQL2Const.once.BLevels=c.HQL2Const.once.PlayerInfo.fishBetList),this.loadFinish()},o.prototype.loadFinish=function(){c.HQL2Const.once.FishConfigs=this.configs[1].json;var e=this.configs[2].json.data,t=this.configs[0].json;c.HQL2Const.once.FishGroups=t.data,c.HQL2Const.once.FishPoints=this.configs[3].json;var o=[],n=[];c.HQL2Const.once.FishPath=[];for(var i=0;i<300&&!(e.length<=i);i++){for(var a=e[i],r=[],l=0;l<=1500;l++){var d=l/1500,p=this.makeBreakBezier2(d,a.points,a.controls);r.push(p)}a.time=a.time>30?30:a.time,c.HQL2Const.once.FishPath.push({id:a.id,points:r,time:a.time,scale:1})}var h=[{key:"elecanon_",space:10},{key:"bomb24_0_",space:10},{key:"bomb24_1_",space:8},{key:"fish50_0_",space:10},{key:"np19_",space:10},{key:"dieEff19_",space:10},{key:"np20_",space:10},{key:"dieEff20_",space:10},{key:"np22_",space:10},{key:"dieEff22_",space:10},{key:"explose_",space:10},{key:"goldingot0_",space:10},{key:"arrow0_",space:10},{key:"arrow1_",space:10},{key:"arrow2_",space:10},{key:"decorate_",space:10},{key:"goldingot0_",space:10},{key:"goldingot1_",space:10},{key:"light0_",space:10},{key:"light1_",space:10},{key:"light2_",space:10},{key:"Elecanon_shoot_",space:20},{key:"bombfish1_",space:10},{key:"28cannon_",space:10},{key:"head0_",space:10},{key:"tail_",space:10},{key:"blast_",space:8},{key:"head1_",space:10},{key:"chain_",space:10},{key:"eff_",space:10},{key:"jump1_",space:10},{key:"flashOfLight_",space:10},{key:"blast1_",space:10},{key:"bullet1_",space:10},{key:"launch0_",space:10},{key:"h",space:10},{key:"ball_",space:30},{key:"crush1_",space:30},{key:"lockBall_",space:10},{key:"launch1_",space:10},{key:"launch2_",space:10},{key:"lockLightning_",space:10},{key:"wait0_",space:10},{key:"wait1_",space:10},{key:"wait2_",space:10}],f=[];for(i=0;i<this.fishs.length;i++)if((y=this.fishs[i])instanceof cc.SpriteAtlas){o.push(y.getSpriteFrames());var u=y.name.split(".")[0];c.HQL2Const.once.MapAtlas.set(u,y)}for(i=0;i<this.effectArr.length;i++){var y;(y=this.effectArr[i])instanceof cc.SpriteAtlas&&("HQL2_UI"==(u=y.name.split(".")[0])&&(c.HQL2Const.once.UIAtals=y),n.push(y.getSpriteFrames()),c.HQL2Const.once.MapAtlas.set(u,y))}for(i=0;i<f.length;i++){var _=f[i];c.HQL2Const.once.MapEffects.set(_,this[_])}var L=c.HQL2Const.once.FishConfigs;for(i=0;i<L.length;i++){var g=L[i],m=(_=g.FishID,"1"===g.AnimType?c.GameLoadType.Skeleton:c.GameLoadType.Atlas);if(m===c.GameLoadType.Atlas){g.SwimActFPS=parseInt(g.SwimActFPS);var v=this.getAni(o,"fish"+_+"_0_",m,cc.WrapMode.Loop,g.SwimActFPS);c.HQL2Const.once.MapSwims.set(_,v);var C=this.findArrayFile(o,"fish"+_+"_1_",m);C=this.desArray(C,["fish"+_+"_1_"]);var I="-1"==g.DeadActFPS?g.SwimActFPS:parseInt(g.DeadActFPS);0==C.length&&(C=this.findArrayFile(o,"fish"+_+"_0_",m));var b=s.default.createWithSpriteFrames(C,I,"animateFrameChange",null);b.name="die"+_+"_",b.wrapMode=cc.WrapMode.Normal,c.HQL2Const.once.MapDieanis.set(_,b)}}for(i=0;i<h.length;i++){var F=h[i],H=(_="string"==typeof F?F:F.key,F.space||10),T=this.getAni(n,_,c.GameLoadType.Atlas,cc.WrapMode.Default,H);c.HQL2Const.once.MapEffects.set(_,T)}},o.prototype.convertVectorToPoint=function(e,t,o){return cc.v2(e.x+-(e.x-t.x)*o,e.y+-(e.y-t.y)*o)},o.prototype.makeBreakBezier2=function(e,t,o){if(t&&t.length){if(e<=0)return t[0];if(e>=1)return t[t.length-1];for(var n=0,i=this.cheekVectorOrTimeIndex(t,e,!0),a=[t[i.index-1],o[i.index-1],t[i.index]];n<1e3;){n++;for(var s=a.length-1,c=0;c<s;c++)if(a[c]=this.convertVectorToPoint(a[c],a[c+1],i.f),c===s-1&&(a.splice(s,a.length),1===a.length))return a[0]}}},o.prototype.cheekVectorOrTimeIndex=function(e,t,o){for(var n=0,i=[],a=1;a<e.length;a++){var s=100;if(!o){var c=e[a-1],r=e[a];s=Math.pow(r.x-c.x,2)+Math.pow(r.y-c.y,2),s=Math.sqrt(s)}i.push(s),n+=s}var l=0,d=0;for(a=0;a<i.length;a++){d=a+1;var p=n*t,h=l+(s=i[a]);if(l<p&&p<=h)return{index:d,f:1-(h-p)/s};l=h}return null},o.prototype.desArray=function(e,t){void 0===t&&(t=[]);var o=t.concat(["die"]);return e.sort(function(e,t){var n=e.name,i=t.name;n=(n=n.replace(" (","")).replace(")",""),i=(i=i.replace(" (","")).replace(")","");for(var a="",s=0;s<o.length;s++)if(-1!==n.indexOf(o[s])){a=o[s];break}var c=n.split(a);n=c[c.length-1];var r=i.split(a);i=r[r.length-1];var l=Math.ceil(n),d=Math.ceil(i);return l>d?1:l<d?-1:0}),e},o.prototype.findArrayFile=function(e,t,o){for(var n=[],i=null,a=0;a<e.length;a++){var r=e[a],l=r.name?r.name.replace(" (",""):"";if(l=l.replace(")",""),o===c.GameLoadType.Atlas)if(r instanceof Array)for(var d=0;d<r.length;d++){var p=r[d],h=p.name.replace(" (",""),f=(h=h.replace(")","")).split(t);this.same(t,h)&&""==f[0]&&s.default.isNumber(f[1])&&n.push(p)}else this.same(t,l)&&(f=l.split(t),s.default.isNumber(f[1])&&""==f[0]&&n.push(r));else l&&-1!==l.indexOf(t)&&(i=r)}return o===c.GameLoadType.Atlas?n:i},o.prototype.same=function(e,t){e=e.split(""),t=t.split("");for(var o=0;o<e.length;o++)if(e[o]!=t[o])return!1;return!0},o.prototype.getAni=function(e,t,o,n,i,a,c,r){if(void 0===n&&(n=cc.WrapMode.Loop),void 0===a&&(a=null),void 0===c&&(c=1),void 0===r&&(r=[]),i=i||10,0==r.length&&(r=this.findArrayFile(e,t,o),r=this.desArray(r,[t]),1!==c)){for(var l=[],d=0;d<c;d++)for(var p=0;p<r.length;p++)l.push(r[p]);r=l}var h=s.default.createWithSpriteFrames(r,i,"animateFrameChange",a);return h.name=t,h.wrapMode=n,h},a([d(cc.AudioClip)],o.prototype,"boom",void 0),a([d(cc.AudioClip)],o.prototype,"zoulu",void 0),a([d(cc.AudioClip)],o.prototype,"hong_1",void 0),a([d(cc.AudioClip)],o.prototype,"fushui",void 0),a([d(cc.AudioClip)],o.prototype,"fangda",void 0),a([d(cc.AudioClip)],o.prototype,"taotuo",void 0),a([d(cc.AudioClip)],o.prototype,"pen_0",void 0),a([d(cc.AudioClip)],o.prototype,"pen_1",void 0),a([d(cc.AudioClip)],o.prototype,"tao",void 0),a([d(cc.AudioClip)],o.prototype,"cai",void 0),a([d(cc.AudioClip)],o.prototype,"tiao",void 0),a([d(cc.AudioClip)],o.prototype,"weiba",void 0),a([d(cc.AudioClip)],o.prototype,"xing",void 0),a([d(cc.AudioClip)],o.prototype,"s31",void 0),a([d(cc.AudioClip)],o.prototype,"xuanfeng",void 0),a([d(cc.AudioClip)],o.prototype,"zhua",void 0),a([d(cc.AudioClip)],o.prototype,"zhuag",void 0),a([d(cc.AudioClip)],o.prototype,"shui",void 0),a([d(cc.AudioClip)],o.prototype,"S2SS",void 0),a([d(cc.AudioClip)],o.prototype,"S21SS",void 0),a([d(cc.AudioClip)],o.prototype,"double",void 0),a([d(cc.AudioClip)],o.prototype,"bill_big",void 0),a([d(cc.AudioClip)],o.prototype,"effect_101",void 0),a([d(cc.AudioClip)],o.prototype,"effect_205",void 0),a([d(cc.AudioClip)],o.prototype,"click",void 0),a([d(cc.AudioClip)],o.prototype,"back",void 0),a([d(cc.AudioClip)],o.prototype,"bill_min",void 0),a([d(cc.AudioClip)],o.prototype,"die",void 0),a([d(cc.AudioClip)],o.prototype,"die_big",void 0),a([d(cc.AudioClip)],o.prototype,"die_small",void 0),a([d(cc.AudioClip)],o.prototype,"effect_108",void 0),a([d(cc.AudioClip)],o.prototype,"gold",void 0),a([d(cc.AudioClip)],o.prototype,"gold_effect",void 0),a([d(cc.AudioClip)],o.prototype,"gold_small",void 0),a([d(cc.AudioClip)],o.prototype,"lock",void 0),a([d(cc.AudioClip)],o.prototype,"weapon_change",void 0),a([d(cc.AudioClip)],o.prototype,"v1",void 0),a([d(cc.AudioClip)],o.prototype,"v2",void 0),a([d(cc.AudioClip)],o.prototype,"v3",void 0),a([d(cc.AudioClip)],o.prototype,"v4",void 0),a([d(cc.AudioClip)],o.prototype,"v5",void 0),a([d(cc.AudioClip)],o.prototype,"v6",void 0),a([d(cc.AudioClip)],o.prototype,"v7",void 0),a([d(cc.AudioClip)],o.prototype,"v8",void 0),a([d(cc.AudioClip)],o.prototype,"v9",void 0),a([d(cc.AudioClip)],o.prototype,"bg0",void 0),a([d(cc.AudioClip)],o.prototype,"bg1",void 0),a([d(cc.AudioClip)],o.prototype,"bg2",void 0),a([d(cc.AudioClip)],o.prototype,"jiguang",void 0),a([d(cc.AudioClip)],o.prototype,"j0",void 0),a([d(cc.AudioClip)],o.prototype,"j1",void 0),a([d(cc.AudioClip)],o.prototype,"j2",void 0),a([d(cc.AudioClip)],o.prototype,"kong0",void 0),a([d(cc.AudioClip)],o.prototype,"mogui",void 0),a([d(cc.AudioClip)],o.prototype,"dian",void 0),a([d([cc.JsonAsset])],o.prototype,"configs",void 0),a([d([cc.SpriteAtlas])],o.prototype,"fishs",void 0),a([d([dragonBones.DragonBonesAsset])],o.prototype,"fishsDBA",void 0),a([d([dragonBones.DragonBonesAtlasAsset])],o.prototype,"fishsDBAT",void 0),a([d([cc.SpriteAtlas])],o.prototype,"effectArr",void 0),a([d([cc.SpriteFrame])],o.prototype,"billSPS",void 0),a([l],o)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./HQL2Const":"HQL2Const",PlayerInfo:void 0}],HQL2Manager:[function(e,t,o){"use strict";cc._RF.push(t,"3d605tu7zpKx5ZBUQPcpXww","HQL2Manager");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(a<3?i(s):a>3?i(t,o,s):i(t,o))||s);return a>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./HQL2Const"),c=e("./HQL2Scene"),r=e("./HQL2Fish"),l=e("./HQL2Bullet"),d=e("../../../Script/utils/Utils"),p=e("./HQL2NetWork"),h=cc._decorator,f=h.ccclass,u=h.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.GameLayer=null,t.MusicDic={},t}var o;return i(t,e),o=t,Object.defineProperty(t,"once",{get:function(){return o.instance||(o.instance=new o),o.instance},enumerable:!1,configurable:!0}),t.destroyInstance=function(){o.instance&&(o.instance=null)},t.prototype.requestFishFire=function(e,t){var o=s.HQL2Const.once.BLevels[s.HQL2Const.once.BLevel],n=o*s.HQL2Const.once.RoomBet,i=this.codePoint(e),a={userid:s.HQL2Const.once.userId,bet:o,position:i,bulletId:d.default.generateMixed(20),isDrill:s.HQL2Const.once.IsDrill};s.HQL2Const.once.IsDrill?(a.bulletId=s.HQL2Const.once.BombId,a.boomWay=10,a.boomPercent=50,a.award=s.HQL2Const.once.Award):t&&(a.fishId=t),n<=s.HQL2Const.once.Entries?(p.default.once.send("fishShoot",a),this.ShotSelfBullet(a),s.HQL2Const.once.IsDrill=!1):(s.HQL2Const.once.IsLock&&this.GameLayer.MenuLayer.onClickedLock(),s.HQL2Const.once.IsAuto&&this.GameLayer.MenuLayer.onClickedAuto(),this.GameLayer.EffectLayer.showRecharge(!0))},t.prototype.requestLeaveRoom=function(){p.default.once.requestLeaveRoom()},t.prototype.showNetError=function(e){cc.isValid(o.once.GameLayer.node)&&(o.once.GameLayer.MenuLayer.LayerNetError.active=e,s.HQL2Const.once.IsAuto&&this.GameLayer.MenuLayer.onClickedAuto(!1))},t.prototype.requestRechargeAll=function(){var e=this.getUser();e&&e.wins&&e.wins>10&&p.default.once.send("chargeAll",JSON.stringify({}))},t.prototype.requestRechargeSum=function(e){var t=this.getUser();t&&t.wins&&t.wins>e&&p.default.once.send("chargeAll",{sum:e})},t.prototype.heartBeat=function(){},t.prototype.requestShotTarget=function(e,t,o,n,i,a){void 0===o&&(o=1),void 0===i&&(i=!1);var c={uid:s.HQL2Const.once.userId,fishId:e,bulletId:t,bulletType:o};n&&(c.lockFishId=n),i&&(c.format=1),a&&(c.from=a),p.default.once.send("fishHit",c)},t.prototype.requestChangeCannonBet=function(e){p.default.once.send("changePower",e)},t.prototype.rechargeAllResult=function(e){var t=this.userConvertSeatId(e.userId);s.HQL2Const.once.users[t].score=e.score,s.HQL2Const.once.users[t].wins=e.wins,e.userId==s.HQL2Const.once.userId&&(this.GameLayer.showRecharge(!0),s.HQL2Const.once.Entries=e.score,s.HQL2Const.once.Winning=e.wins),this.GameLayer.updateBalance(e.userId,e.score),this.GameLayer.updateDiamond(e.userId,e.wins)},t.prototype.CMDLeserBoom=function(e,t){for(var n=[],i=this.GameLayer.getFishs(),a=0;a<i.length;a++){var c=i[a],r=c.getWorldPoint();c.alive&&c.fid<20&&d.default.rayCasting(r,t)&&(c.goDie(),c.playDieAni(),n.push(c.fishId))}e=this.codePoint(e),p.default.once.send("broadcast",{bombId:s.HQL2Const.once.LeserBulletId,position:e,seatId:s.HQL2Const.once.seatId}),cc.log("CMDLeserBoom: "+JSON.stringify(n)),n.length>0&&o.once.requestShotTarget(n,s.HQL2Const.once.LeserBulletId,3,null,!1,e)},t.prototype.CmdHQL2SuperBomb=function(e,t,o){if(void 0===o&&(o=3),cc.log("CmdHQL2BigBomb111: "+JSON.stringify(e)),e.seatId===s.HQL2Const.once.seatId){var n=300*s.HQL2Const.once.winScale.x,i=this.inCircleFishs(t.node.convertToWorldSpaceAR(cc.v2(0,0)),n);i.fishId.length>0&&(cc.log("inCircleFishs:"+JSON.stringify(i.fishId)),this.requestShotTarget(i.fishId,t.param.bulletId,o))}},t.prototype.Cmdh1l2BigBomb=function(e){if(cc.log("Cmdh1l2BigBomb: "+JSON.stringify(e)),e.seatId===s.HQL2Const.once.seatId){var t=this.getBoomFishs();cc.log("CmdFISHMANBigBomb sss:"+JSON.stringify(t)),t.length>0&&this.requestShotTarget(t,e.bombId,3)}},t.prototype.CmdZZBoom=function(e){if(e.param.seatId===s.HQL2Const.once.seatId){var t=400*s.HQL2Const.once.winScale.x,o=this.inCircleFishs(e.node.convertToWorldSpaceAR(cc.v2(0,0)),t);o.fishId.length>0&&(cc.log("inCircleFishs:"+JSON.stringify(o.fishId)),this.requestShotTarget(o.fishId,e.param.bulletId,5)),p.default.once.send("broadcast",{bombId:e.param.bulletId,position:e.node.position,seatId:e.param.seatId})}},t.prototype.broadcast=function(e){e&&e.userdata&&((e=JSON.parse(e.userdata)).position=this.decodePoint(e.position),o.once.tableConvertIndex(e.seatId)>1&&(e.position.y=cc.view.getVisibleSize().height-e.position.y),this.GameLayer.EffectLayer.onTouchStartElecanon(0,e.position,e.seatId))},t.prototype.CmdBYFishSeatChange=function(e,t){t&&(t.userId=t.UserId),s.HQL2Const.once.users[e]=t,this.GameLayer.refreshTable(t)},t.prototype.CmdBYCannonChange=function(e){if(cc.log("CmdBYCannonChange: "+JSON.stringify(e)+",cg:"+typeof e),"string"==typeof e&&(e=JSON.parse(e)),e.userid==s.HQL2Const.once.userId)for(var t=0;t<s.HQL2Const.once.BLevels.length;t++)if(e.bet==s.HQL2Const.once.BLevels[t]){s.HQL2Const.once.BLevel=t;break}this.GameLayer.WeaponLayer.setWeaponGold(e.userid,e.bet),this.GameLayer.WeaponLayer.setLevelByUID(e.userid,e.bet)},t.prototype.CmdBYTable=function(e){var t=e.ResultData;s.HQL2Const.once.seatId=t.seatId,s.HQL2Const.once.userId=s.HQL2Const.once.PlayerInfo.playerId,s.HQL2Const.once.users={};for(var n=0;n<t.userList.length;n++){var i=t.userList[n];s.HQL2Const.once.users[i.seatId]=i,i.userId==s.HQL2Const.once.userId&&(s.HQL2Const.once.Entries=i.score,s.HQL2Const.once.diamond=i.wins)}s.HQL2Const.once.PlayerInfo.gameDisconnect=!1,s.HQL2Const.once.PlayerInfo.gameName="HQL2Fish",s.HQL2Const.once.TableId=e.change_scene_type%3||0,o.once.checkSelfTableIndex(),this.GameLayer.changeSceneBg(s.HQL2Const.once.TableId,!1,s.HQL2Const.once.TableId),this.GameLayer.clearTableFishs(),this.GameLayer.refreshTable(!1),this.GameLayer&&this.GameLayer.EffectLayer&&this.GameLayer.WeaponLayer.LastFireTime<-999998&&(this.GameLayer.WeaponLayer.LastFireTime=-91),this.sendChangeScene()},t.prototype.sendChangeScene=function(){p.default.once.send("changeScene",{})},t.prototype.CmdByStageChange=function(e){var t={now:s.HQL2Const.once.TableId,anim:!0,later:e.change_scene_type,skillId:s.HQL2EffectType.Fast};this.GameLayer.EffectLayer.addEffect(t),s.HQL2Const.once.TableId=e.change_scene_type,cc.log("CmdByStageChange:"+JSON.stringify(e))},t.prototype.ShotSelfBullet=function(e){this.GameLayer&&this.GameLayer.WeaponLayer&&(e.balance=parseInt(e.bet)*s.HQL2Const.once.RoomBet,e.uid=e.userid=s.HQL2Const.once.userId,s.HQL2Const.once.BulletCount++,this.GameLayer.WeaponLayer.LastFireTime=0,e.seatId=this.userConvertSeatId(e.userid),e.touch=this.decodePoint(e.position),this.GameLayer.WeaponLayer.showWeapon(e))},t.prototype.CmdBYShot=function(e){if(this.GameLayer&&this.GameLayer.WeaponLayer){if(e.balance=parseInt(e.bet)*s.HQL2Const.once.RoomBet,e.uid=e.userid,e.seatId=this.userConvertSeatId(e.userid),e.userid==s.HQL2Const.once.userId)s.HQL2Const.once.Entries-=e.balance;else{if(e.fishId){var t=this.getFishByFishId(e.fishId);t instanceof r.default&&this.CmdBYLockFish(t,e.seatId)}else this.CmdBYUnlockFish(e.seatId);e.touch=this.decodePoint(e.position),this.GameLayer.WeaponLayer.showWeapon(e)}e.isDrill&&this.GameLayer.EffectLayer.hideEffect20(e.seatId),s.HQL2Const.once.users[e.seatId]&&(s.HQL2Const.once.users[e.seatId].score-=e.balance,this.GameLayer.updateBalance(e.userid,s.HQL2Const.once.users[e.seatId].score))}},t.prototype.CmdBYShotFish=function(e){var t=this.getAllFishByFishId(e.fishId),n=t[0],i=this.getTableByUID(e.userId);if(e.hitSocre*=s.HQL2Const.once.RoomBet,i&&n instanceof r.default){var a=parseInt(n.config.Skill);e.index=this.tableConvertIndex(i.seatId);var c={fishId:e.fishId,userId:e.userId,seatId:i.seatId,award:e.hitSocre,index:e.index,bomb:e.bomb,fid:n.fid,ScoreEffect:n.config.ScoreEffect,position:n.node.position,SettleType:n.config.SettleType,point:n.node.convertToWorldSpaceAR(cc.v2(0,0)),bombId:e.bombId,bulletId:e.bombId,fishType:n.config.fishType};39==n.fid&&(c.position=n.sp_fish.node.convertToWorldSpaceAR(cc.v2(0,0)),c.position=n.sp_fish.node.parent.convertToNodeSpaceAR(c.position));for(var p=0;p<t.length;p++){var h=t[p];43==h.fid?(h.enbaleMove=!1,h.setState(s.HQL2FishStatus.Die),c.seatId==s.HQL2Const.once.seatId&&this.GameLayer.WeaponLayer.setTimelimit(20),this.GameLayer.EffectLayer.showKilinEffect(h,c)):(h.goDie(),4!=e.butype&&5!=e.butype&&h.playDieAni())}if(a==s.HQL2EffectType.SUPER_BOOM&&(o.once.GameLayer.EffectLayer.addEffect({skillId:s.HQL2EffectType.COIN_BOOM,position:c.position}),c.skillId=s.HQL2EffectType.SUPER_BOOM,this.GameLayer.EffectLayer.addEffect(c)),a==s.HQL2EffectType.LASER_BOOM&&(this.GameLayer.WeaponLayer.setTimelimit(3),o.once.GameLayer.EffectLayer.addEffect({skillId:s.HQL2EffectType.COIN_BOOM,position:c.position}),c.skillId=s.HQL2EffectType.LASER_BOOM,this.GameLayer.EffectLayer.addEffect(c)),a==s.HQL2EffectType.IROULETE&&(this.GameLayer.WeaponLayer.setTimelimit(3),o.once.GameLayer.EffectLayer.addEffect({skillId:s.HQL2EffectType.COIN_BOOM,position:c.position}),c.skillId=s.HQL2EffectType.IROULETE,this.GameLayer.EffectLayer.addEffect(c)),a==s.HQL2EffectType.LONG&&o.once.GameLayer.EffectLayer.addEffect({skillId:s.HQL2EffectType.COIN_BOOM,position:c.position}),-1!=[s.HQL2EffectType.HU_DIE,s.HQL2EffectType.KONG_LONG,s.HQL2EffectType.JING].indexOf(a)&&(o.once.GameLayer.EffectLayer.addEffect({skillId:s.HQL2EffectType.COIN_BOOM,position:c.position}),c.skillId=s.HQL2EffectType.SamllBill,this.GameLayer.EffectLayer.addEffect(c)),a==s.HQL2EffectType.PI_KA_QIU&&this.cmdPKQBoom({seatId:i.seatId,skillId:s.HQL2EffectType.PI_KA_QIU,position:c.position,count:0,bulletId:e.bombId,fid:n.fid,bombId:e.bombId,award:c.award}),a==s.HQL2EffectType.LONG&&o.once.GameLayer.EffectLayer.addEffect({seatId:i.seatId,skillId:s.HQL2EffectType.LONG,position:c.position,award:c.award}),a==s.HQL2EffectType.FIRE_TOTLE_BALL&&(o.once.GameLayer.EffectLayer.addEffect({skillId:s.HQL2EffectType.COIN_BOOM,position:c.position}),o.once.GameLayer.EffectLayer.addEffect({seatId:i.seatId,skillId:s.HQL2EffectType.FIRE_TOTLE_BALL,position:c.position,award:c.award,bulletId:e.bombId})),2==n.config.propFish&&(c.skillId=s.HQL2EffectType.XUAN_WO,this.GameLayer.EffectLayer.addEffect(c),this.CmdHQL2SameBomb(c)),a==s.HQL2EffectType.DRILL_BOOM&&(c.seatId==s.HQL2Const.once.seatId&&(s.HQL2Const.once.IsDrill=!0),s.HQL2Const.once.BombId=e.bombId,s.HQL2Const.once.Award=c.award,c.skillId=s.HQL2EffectType.DRILL_BOOM,o.once.GameLayer.EffectLayer.addEffect(c),this.GameLayer.WeaponLayer.setTimelimit(4)),4==e.butype&&e.from){var f=e.sendFishs.indexOf(e.fishId),u=this.getFishByFishId(c.fishId);u.enbaleMove=!0;var y=d.default.deepCopy(c);y.to=u.node.position,y.coinPosition=u.node.position,y.position=e.from,y.skillId=s.HQL2EffectType.PI_KA_QIU,y.delay=.2*f+1,y.sumTime=.2*e.sendFishs.length+1,this.GameLayer.EffectLayer.addEffect(y)}if(16<n.fid&&n.fid<20||2==n.config.propFish){var _={seatId:c.seatId,award:c.award,skillId:s.HQL2EffectType.Bill,fid:n.fid,bombId:e.bombId};2==n.config.propFish&&(_.fid=50),o.once.GameLayer.EffectLayer.addEffect(_)}4!=e.butype&&(cc.log("param",c),this.addResultCoin(c)),7==e.butype&&(c.skillId=s.HQL2EffectType.XUAN_WO_SUB,o.once.GameLayer.EffectLayer.addEffect(c))}i&&s.HQL2Const.once.users[i.seatId]&&-1!=[0,1,2,6,7].indexOf(e.butype)&&(s.HQL2Const.once.PlayerInfo.useOneScore?(s.HQL2Const.once.users[i.seatId].score+=e.hitSocre,s.HQL2Const.once.Entries=s.HQL2Const.once.users[i.seatId].score,this.GameLayer.updateDiamond(i.userId,s.HQL2Const.once.users[i.seatId].score),this.GameLayer.updateBalance(i.userId,s.HQL2Const.once.users[i.seatId].score)):(s.HQL2Const.once.users[i.seatId].wins+=e.hitSocre,this.GameLayer.updateDiamond(i.userId,s.HQL2Const.once.users[i.seatId].wins)));var L=this.getBulletByBulletId(e.bombId);L instanceof l.default&&!L.isDrill&&this.GameLayer.despawnBullet(L)},t.prototype.addResultCoin=function(e){this.addSFX(e),this.showCoin(e)},t.prototype.getBoomFishs=function(){for(var e=[],t=this.GameLayer.getFishs(),o=0;o<t.length;o++){var n=t[o];if(n.alive&&n.fid<18&&0==parseInt(n.config.Skill)&&(e.push(n.fishId),e.length>13))break}return e},t.prototype.CmdHQL2SameBomb=function(e){if(cc.log("CmdHQL2SameBomb: "+JSON.stringify(e)),e.seatId===s.HQL2Const.once.seatId){for(var t=this.GameLayer.getFishs(),o=0;o<t.length;o++){var n=t[o];n.alive&&n.config.fishType==e.fishType&&this.requestShotTarget(n.fishId,e.bombId,7,!1,!0)}cc.log("inCircleFishs:"+JSON.stringify([]))}},t.prototype.cmdPKQBoom=function(e){if(s.HQL2Const.once.seatId==e.seatId){var t=this.getBoomFishs();t.length>0&&this.requestShotTarget(t,e.bulletId,4,null,!1,e.position),e.skillId=s.HQL2EffectType.PI_KA_QIU_LIGHT,this.GameLayer.EffectLayer.addEffect(e)}},t.prototype.createFish=function(e){var t=this.getFishConfig(e.fishType);if(e.fishes=e.fishes||[e.fishType],t){var n=d.default.generateMixed(20),i=e.fishPath%s.HQL2Const.once.FishPath.length;-1==[30,39,43].indexOf(e.fishType)&&i<15&&(i+=15);var a=s.HQL2Const.once.FishPath[i].id;39==e.fishType&&(a=(a=[2201,2202,2203,2204])[i=e.fishPath%a.length]),43==e.fishType&&(a=(a=[2205,2206,2191,2190,2188,2187])[i=e.fishPath%a.length]),30==e.fishType&&(a=(a=[2196,2197,2198,2199,2200])[i=e.fishPath%a.length]);var c=this.getFishPathByID(a),r=this.convertToGid(e.fishes.length),l=o.once.getFishPoints(t.FishID);t.fishType=e.fishType,t.propFish=e.propFish;for(var p=o.once.getFishGroups(r),h=0;h<e.fishes.length;h++){var f={groupUuid:n,groupId:r,groups:p,fid:e.fishes[h],fishId:e.fishId[0],config:t,index:h,skillId:"",FishPath:c,pathInterval:c.time,swimmingInterval:0,compensate:0,conlliderPoints:l};if(30==f.fid){var u=cc.v2(c.points[0].x,c.points[0].y),y=cc.v2(c.points[1].x,c.points[1].y),_=o.once.convertPointToAngle(y,u);o.once.GameLayer.EffectLayer.addEffect({skillId:s.HQL2EffectType.FIRE_TOTLE,position:u,angle:45,param:f,rotation:_})}else this.GameLayer.refreshFish(f)}}else cc.log("\u627e\u4e0d\u5230\u9c7c\u8be6\u60c5group.fishType---\x3e"+e.fishType)},t.prototype.convertToGid=function(e){for(var t=0;t<s.HQL2Const.once.FishGroups.length;t++){var o=s.HQL2Const.once.FishGroups[t];if(o.num==e)return o.id}return null},t.prototype.CmdBYLockFish=function(e,t){void 0===t&&(t=s.HQL2Const.once.seatId),e instanceof r.default&&e.pushLockSeat(t)&&(this.GameLayer.WeaponLayer.setLockFishByTid(t,e),t==s.HQL2Const.once.seatId&&this.playSFX("lock")),e instanceof r.default&&this.GameLayer.showUserLock(t,e.fid)},t.prototype.CmdBYUnlockFish=function(e){void 0===e&&(e=s.HQL2Const.once.seatId),this.GameLayer.WeaponLayer.setLockFishByTid(e,404),this.GameLayer.UnLockFishNtfType(e)},t.prototype.addSFX=function(e){if(e&&e.seatId===s.HQL2Const.once.seatId){var t="die_small";Math.floor(e.fid)>9&&(t="die"),Math.floor(e.fid)>19&&(t="die_big"),this.playSFX(t)}},t.prototype.getFishPathByID=function(e,t){void 0===t&&(t=!0);for(var o=s.HQL2Const.once.FishPath,n=""+e||"1001",i=0;i<o.length;i++){var a=o[i];if(a.id===n){var c=a;return c.scale=1,c.points[0].x-c.points[c.points.length-1].x>0&&t&&(c.scale=-1),c}}return null},t.prototype.getFishLayerIndex=function(e){for(var t=parseInt(e),o=[[0,1,2,3,4,5,6,7],[8,9,10,11],[12,13,14],[15],[16],[17],[18],[33],[20,21,22,24],[23],[30],[34],[35],[39],[43]],n=0;n<o.length;n++)if(-1!=o[n].indexOf(t))return n;return 0},t.prototype.getFishConfig=function(e){for(var t=0;t<s.HQL2Const.once.FishConfigs.length;t++)if(""+s.HQL2Const.once.FishConfigs[t].FishID==""+e)return d.default.deepCopy(s.HQL2Const.once.FishConfigs[t]);return null},t.prototype.getFishPoints=function(e){return s.HQL2Const.once.FishPoints[e]},t.prototype.getFishGroups=function(e){for(var t=0;t<s.HQL2Const.once.FishGroups.length;t++)if(""+s.HQL2Const.once.FishGroups[t].id==""+e)return s.HQL2Const.once.FishGroups[t];return null},t.prototype.getEffectByType=function(e){return s.HQL2Const.once.MapEffects.get(""+e)},t.prototype.getAtlasByType=function(e){return s.HQL2Const.once.MapAtlas.get(""+e)},t.prototype.getDeathAnimateByID=function(e){return s.HQL2Const.once.MapDieanis.get(""+e)},t.prototype.getSwimAnimateByID=function(e){return s.HQL2Const.once.MapSwims.get(""+e)},t.prototype.initData=function(){cc.sys.isMobile?window.addEventListener("resize",this.onResized.bind(this)):cc.view.on("canvas-resize",this.onResized,this),this.onResized()},t.prototype.checkCompensate=function(e){var t=e.clientTime||Date.now(),o=void 0===e.seatId?s.HQL2Const.once.seatId:e.seatId,n=e.cToS?e.serverTime-t:t-e.serverTime,i=s.HQL2Const.once.MapCompensate.get(o);i||(i=e.cToS?n:-n,s.HQL2Const.once.MapCompensate.set(o,i));var a=e.cToS?n-i:n+i;return a<=0&&(i=e.cToS?i+a:i-a,s.HQL2Const.once.MapCompensate.set(o,i),a=0),a},t.prototype.convertPositionAngle=function(e){var t=cc.view.getVisibleSize(),o=t.width/2,n=t.height/2,i=e.x>o||e.x<-o,a=i?Math.abs(e.x)-o:0,s=e.y>n||e.y<-n?Math.abs(e.y)-n:0,c=i?360:180;return e.y>n&&(s=-s),e.x>o&&(a=-a),{out:a||s,x:a,y:s,jd:c,angle:c-e.angle}},t.prototype.calculateSpacePoint=function(e){var t=e.xySpeed,o=cc.view.getVisibleSize();if(void 0===e.xySpeed){var n=o.width*e.speed.x*e.space,i=o.height*e.speed.y*e.space;t=Math.sqrt(n*n+i*i)}var a=t*Math.sin(e.angle/180*Math.PI),s=t*Math.cos(e.angle/180*Math.PI);return cc.v2(a,s)},t.prototype.calculateNextBorderPoint=function(e){var t=cc.v2(e.point.x,e.point.y),o=cc.view.getVisibleSize(),n=Math.sin(e.angle/180*Math.PI),i=Math.cos(e.angle/180*Math.PI),a=n>0?o.width/2-t.x:-o.width/2-t.x,s=i>0?o.height/2-t.y:-o.height/2-t.y,c=e.speed.x*n,r=e.speed.y*i,l=Math.abs(a/c),d=Math.abs(s/r),p=Math.min(l,d);return t.x+=c*p,t.y+=r*p,{point:t,time:p}},t.prototype.inCircle=function(e,t,o){return cc.v2(e.x,e.y).sub(cc.v2(t.x,t.y)).mag()<=o},t.prototype.onResized=function(){s.HQL2Const.once.winScale=this.convertWindowScale()},t.prototype.checkSelfTableIndex=function(){for(var e in s.HQL2Const.once.users){var t=s.HQL2Const.once.users[e];t&&t.userId===s.HQL2Const.once.userId&&(s.HQL2Const.once.seatId=parseInt(t.seatId))}},t.prototype.getUser=function(e){void 0===e&&(e=404);var t=null;for(var o in 404==e&&(e=s.HQL2Const.once.seatId),s.HQL2Const.once.users){var n=s.HQL2Const.once.users[o];n&&n.seatId===e&&(t=n)}return t},t.prototype.flipWeaponY=function(e){return Math.max(s.HQL2Const.once.seatId,e)>1&&Math.min(s.HQL2Const.once.seatId,e)<=1},t.prototype.userConvertIndex=function(e){return this.tableConvertIndex(this.userConvertSeatId(e))},t.prototype.userConvertSeatId=function(e){var t=this.getTableByUID(e);return t?t.seatId:-1},t.prototype.tableConvertIndex=function(e){void 0===e&&(e=-1);var t=e>-1?e:s.HQL2Const.once.seatId;return s.HQL2Const.once.seatId>1&&(t=t>1?t-2:t+2),t},t.prototype.getTableByUID=function(e,t){var o=e||s.HQL2Const.once.userId;for(var n in s.HQL2Const.once.users){var i=s.HQL2Const.once.users[n];if(i&&""+i.userId==""+o)return t instanceof Function&&t(i),i}},t.prototype.showCoin=function(e){var t=d.default.deepCopy(e);if(t.self=e.seatId===s.HQL2Const.once.seatId,t.index=this.tableConvertIndex(e.seatId),cc.log("showCoin",t.index,e.seatId),parseFloat(e.award)>0){for(var o=0;o<1;o++){var n=d.default.deepCopy(t);n.i=o,this.GameLayer.addCoin(n)}this.showCoinLbAction(t)}},t.prototype.showCoinLbAction=function(e){var t=this;if(e.award&&parseFloat(e.award)>0){var o=this.GameLayer.addCoinLb(e);if(o instanceof cc.Node){o.opacity=255;var n=cc.spawn(cc.moveTo(.5,cc.v2(o.x,o.y+50)),cc.fadeIn(.3)),i=cc.spawn(cc.moveTo(1,cc.v2(o.x,o.y+100)).easing(cc.easeIn(3)),cc.fadeOut(1));o.runAction(cc.sequence(n,i,cc.callFunc(function(){t.GameLayer.despawnCoinLb(o)})))}}},t.prototype.checkLimitBorder=function(e){var t=cc.view.getVisibleSize(),o=e.x>=-t.width/2&&e.x<=t.width/2,n=e.y>=-t.height/2&&e.y<=t.height/2;return o&&n},t.prototype.inCircleFishs=function(e,t){void 0===t&&(t=100);for(var o=[],n=this.GameLayer.getFishs(),i=[],a=0;a<n.length;a++){var s=n[a],c=s.node.convertToNodeSpaceAR(cc.v2(e.x,e.y));if(s.alive)for(var r=0;r<s.colliders.length;r++){var l=s.colliders[r];if(s.fid<20&&this.inCircle(l,c,t)){if(s.beAttack(),!s.fishId){cc.log("f.fishId;;;;;");break}i.push(s),o.push(s.fishId);break}}}return{fishId:o,fish:i}},t.prototype.getMaxFish=function(){for(var e=this.GameLayer.getFishs(),t=null,o=e.length-1;o>=0;o--){var n=e[o],i=this.checkLimitBorder(n.node);if(n.alive&&i)if(t instanceof r.default){var a=parseFloat(n.config.Type),s=parseFloat(t.config.Type);4===a&&(a=6),4===s&&(s=6),a>s&&(t=n)}else t=n}return t},t.prototype.setLimitFire=function(e,t){void 0===e&&(e=0),void 0===t&&(t=!1),this.GameLayer.WeaponLayer.setTimelimit(e),t&&s.HQL2Const.once.IsAuto&&this.GameLayer.MenuLayer.onClickedAuto(!1)},t.prototype.onTouchWindow=function(e,t){if(this.GameLayer.WeaponLayer.timeLimit){this.GameLayer.WeaponLayer.setClickLimit(!1);var o=this.GameLayer.WeaponLayer.balanceLimit;this.setLimitFire(s.HQL2Const.once.FightLimit,!o),this.GameLayer.EffectLayer.onTouchStartElecanon(1,e),this.requestFishFire(e,t)}},t.prototype.showLockLineByTid=function(e,t){for(var o=0;o<t.length;o++){var n=t[o];this.GameLayer.WeaponLayer.showLockLineByTid(n,e)}},t.prototype.getFishByFishId=function(e){for(var t=this.GameLayer.getFishs(),o=0;o<t.length;o++){var n=t[o];if(e===n.fishId)return n}return null},t.prototype.getAllFishByFishId=function(e){for(var t=[],o=this.GameLayer.getFishs(),n=0;n<o.length;n++){var i=o[n];e===i.fishId&&t.push(i)}return t},t.prototype.getBulletByBulletId=function(e){for(var t=this.GameLayer.getBullets(),o=0;o<t.length;o++){var n=t[o];if(e===n.bulletId)return n}return null},t.prototype.removeEvents=function(){cc.sys.isMobile?window.removeEventListener("resize",this.onResized.bind(this)):cc.view.off("canvas-resize",this.onResized,this),this.unscheduleAllCallbacks()},t.prototype.getFrameByName=function(e){var t=null;return s.HQL2Const.once.MapAtlas.forEach(function(o){var n=o.getSpriteFrame(e);n&&(t=n)}),t},t.prototype.cheekVectorOrTimeIndex=function(e,t,o){for(var n=0,i=[],a=1;a<e.length;a++){var s=100;if(!o){var c=e[a-1],r=e[a];s=Math.pow(r.x-c.x,2)+Math.pow(r.y-c.y,2),s=Math.sqrt(s)}i.push(s),n+=s}var l=0,d=0;for(a=0;a<i.length;a++){d=a+1;var p=n*t,h=l+(s=i[a]);if(l<p&&p<=h)return{index:d,f:1-(h-p)/s};l=h}return null},t.prototype.makeBreakBezier2=function(e,t,o){if(t&&t.length){if(e<=0)return t[0];if(e>=1)return t[t.length-1];for(var n=0,i=this.cheekVectorOrTimeIndex(t,e,!0),a=[t[i.index-1],o[i.index-1],t[i.index]];n<1e3;){n++;for(var s=a.length-1,c=0;c<s;c++)if(a[c]=this.convertVectorToPoint(a[c],a[c+1],i.f),c===s-1&&(a.splice(s,a.length),1===a.length))return a[0]}}},t.prototype.convertVectorToPoint=function(e,t,o){return cc.v2(e.x+-(e.x-t.x)*o,e.y+-(e.y-t.y)*o)},t.prototype.convertPointToAngle=function(e,t){var o=0,n=e.y-t.y,i=e.x-t.x;return 0===i?o=n>0?-90:90:(i<0&&n>0&&(o=180-180*Math.atan(n/i)/Math.PI),i<0&&n<0&&(o=180-180*Math.atan(n/i)/Math.PI),i>0&&n>0&&(o=270+180*Math.atan(i/n)/Math.PI),i>0&&n<0&&(o=90+180*Math.atan(i/n)/Math.PI)),o},t.prototype.convertWindowsizePath=function(e){for(var t=e,o=this.convertWindowScale(),n=0;n<t.length;n++){for(var i=0;i<t[n].points.length;i++)t[n].points[i].x*=o.x,t[n].points[i].y*=o.y;for(i=0;i<t[n].controls.length;i++)t[n].controls[i].x*=o.x,t[n].controls[i].y*=o.y}return t},t.prototype.convertWindowScale=function(){var e=cc.view.getVisibleSize(),t=e.width/1334,o=e.height/750;return cc.v2(t,o)},t.prototype.addBill=function(e){if(e&&this.GameLayer&&this.GameLayer.EffectLayer&&cc.isValid(this.GameLayer.node)&&Math.floor(e.SettleType)>=0){var t=(""+e.SettleType).split(""),o=e.seatId===s.HQL2Const.once.seatId,n=e.award;-1!==["1","0"].indexOf(t[0])&&-1!==["1","0"].indexOf(t[1])&&(t=o?[1]:[0]);for(var i=Math.floor(e.fid),a=0;a<t.length;a++){var c=Math.floor(t[a]),r=c;this.GameLayer.EffectLayer.addEffect({seatId:e.seatId,skillId:s.HQL2EffectType.Bill,type:c,fid:i,award:n,limit:r,number:e.number})}}},t.prototype.codePoint=function(e){return e||(e=cc.v2(0,0)),{x:1*e.x/s.HQL2Const.once.winScale.x,y:1*e.y/s.HQL2Const.once.winScale.y}},t.prototype.decodePoint=function(e){return e||(e=cc.v2(0,0)),{x:1*e.x*s.HQL2Const.once.winScale.x,y:1*e.y*s.HQL2Const.once.winScale.y}},t.prototype.playBGM=function(e,t){void 0===t&&(t=!0),e=e||this.MusicDic[404],t&&(this.MusicDic[404]=e),this.play(e,!0,!0)},t.prototype.stopBGM=function(){cc.audioEngine.stopAll()},t.prototype.playSFX=function(e){this.play(e,!1,!1)},t.prototype.stopSFX=function(e){this.MusicDic[e]&&cc.audioEngine.stop(this.MusicDic[e])},t.prototype.play=function(e,t,o){void 0===o&&(o=!1);var n=this.GameLayer.LoadingLayer[e];n&&(this.MusicDic[e]=o?cc.audioEngine.playMusic(n,t):cc.audioEngine.playEffect(n,t))},t.prototype.patch_line_point=function(e,t,o,n,i,a){var s=i-o,c=a-n,r=((e-o)*s+(t-n)*c)/(s*s+c*c);r>1&&(r=1),r<0&&(r=0);var l=o+r*s-e,d=n+r*c-t;return Math.sqrt(l*l+d*d)},a([u(c.default)],t.prototype,"GameLayer",void 0),o=a([f],t)}(cc.Component);o.default=y,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./HQL2Bullet":"HQL2Bullet","./HQL2Const":"HQL2Const","./HQL2Fish":"HQL2Fish","./HQL2NetWork":"HQL2NetWork","./HQL2Scene":"HQL2Scene"}],HQL2Menu:[function(e,t,o){"use strict";cc._RF.push(t,"3da15lb/idIbqXWOq9JIVKr","HQL2Menu");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(a<3?i(s):a>3?i(t,o,s):i(t,o))||s);return a>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../../Script/utils/Utils"),c=e("./HQL2Const"),r=e("./HQL2Manager"),l=e("./HQL2NetWork"),d=cc._decorator,p=d.ccclass,h=d.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LayerNetError=null,t.LayerRule=null,t.sp_setup=null,t.sp_auto=null,t.sp_lock=null,t.sp_speed=null,t._mune=!1,t}return i(t,e),t.prototype.onLoad=function(){this._index=0,this.node.width=cc.winSize.width>1334?1334:cc.winSize.width,this.btn_auto=this.node.getChildByName("btn_auto"),this.btn_lock=this.node.getChildByName("btn_lock"),this.btn_jiasu=this.node.getChildByName("btn_jiasu"),this.btn_auto.on("click",this.onClickedAuto,this),this.btn_lock.on("click",this.onClickedLock,this),this.btn_jiasu.on("click",this.onClickedJiasu,this),this.node.getChildByName("btn_bill").on("click",this.onClickedBill,this),this.layer_mune=this.node.getChildByName("layer_mune"),cc.find("layer_mune/btn_back",this.node).on("click",this.onClickedBack,this),cc.find("layer_mune/btn_setup",this.node).on("click",this.onClickedSetup,this),cc.find("layer_mune/btn_rule",this.node).on("click",this.onClickedRule,this),this.btn_show=cc.find("layer_mune/btn_show/sp",this.node).getComponent(cc.Sprite),this.btn_show.node.parent.on("click",this.onClickedShow,this),cc.game.on(cc.game.EVENT_HIDE,this.onHide,this);var e=cc.sys.localStorage.getItem("HQL2_AudioVolume");this.setAudioVolume(null==e||e>0)},t.prototype.onHide=function(){console.log("\u6e38\u620f\u8fdb\u5165\u540e\u53f0"),c.HQL2Const.once.IsAuto&&this.onClickedAuto()},t.prototype.onResized=function(){},t.prototype.onClickedSetup=function(){r.default.once.playSFX("click"),cc.audioEngine.getMusicVolume()>0?this.setAudioVolume(!1):this.setAudioVolume(!0)},t.prototype.setAudioVolume=function(e){e?(this.sp_setup.spriteFrame=c.HQL2Const.once.UIAtals.getSpriteFrame("volume"),cc.audioEngine.setMusicVolume(1),cc.audioEngine.setEffectsVolume(1),cc.sys.localStorage.setItem("HQL2_AudioVolume",1)):(this.sp_setup.spriteFrame=c.HQL2Const.once.UIAtals.getSpriteFrame("mute"),cc.audioEngine.setMusicVolume(0),cc.audioEngine.setEffectsVolume(0),cc.sys.localStorage.setItem("HQL2_AudioVolume",0))},t.prototype.onClickedRule=function(){this.LayerRule.active=!this.LayerRule.active},t.prototype.onClickedShow=function(){r.default.once.playSFX("click"),this._mune=!this._mune,this.btn_show.spriteFrame=r.default.once.getFrameByName(this._mune?"fold":"spread");for(var e=[],t=0;t<3;t++)e[t]=cc.find("layer_mune/"+["btn_back","btn_setup","btn_rule"][t],this.node),e[t].stopAllActions(),e[t].active=this._mune,e[t].opacity=0,e[t].scale=1;if(this._mune)for(t=0;t<e.length;t++)e[t].runAction(cc.sequence(cc.delayTime(.1*t),cc.spawn(cc.sequence(cc.scaleTo(.05,1.2),cc.scaleTo(.05,1)),cc.fadeIn(.1))))},t.prototype.onclickedLeave=function(){l.default.once.levea()},t.prototype.onClickedBack=function(){r.default.once.playSFX("click"),r.default.once.requestLeaveRoom()},t.prototype.onClickedBill=function(){r.default.once.createFish({fishCount:1,fishId:[s.default.randomNum(0,299999)],fishLineup:0,fishPath:2200,fishType:30,fishes:[30],lineup:!1,propCount:0,propFish:0,timestamp:1661239728601})},t.prototype.onClickCloseRule=function(){r.default.once.playSFX("click"),this.LayerRule.active=!1},t.prototype.onClickedAuto=function(e){void 0===e&&(e=!0),e&&r.default.once.playSFX("click"),c.HQL2Const.once.IsAuto=!c.HQL2Const.once.IsAuto,this.btn_auto.opacity=c.HQL2Const.once.IsAuto?255:200},t.prototype.onClickedJiasu=function(e){void 0===e&&(e=!0),e&&r.default.once.playSFX("click"),c.HQL2Const.once.AutoLimit==c.HQL2FireSpeed.Speed0?(c.HQL2Const.once.AutoLimit=c.HQL2FireSpeed.Speed1,c.HQL2Const.once.FightLimit=c.HQL2FireSpeed.Speed1):(c.HQL2Const.once.AutoLimit=c.HQL2FireSpeed.Speed0,c.HQL2Const.once.FightLimit=c.HQL2FireSpeed.Speed0),c.HQL2Const.once.AutoLimit,c.HQL2FireSpeed.Speed1,this.btn_jiasu.opacity=c.HQL2Const.once.AutoLimit==c.HQL2FireSpeed.Speed1?255:200},t.prototype.onClickedLock=function(){r.default.once.playSFX("click"),c.HQL2Const.once.IsLock=!c.HQL2Const.once.IsLock,c.HQL2Const.once.IsLock?this.btn_lock.opacity=255:(r.default.once.CmdBYUnlockFish(),this.btn_lock.opacity=200)},t.prototype.onDestroy=function(){cc.game.off(cc.game.EVENT_HIDE,this.onHide,this)},a([h(cc.Node)],t.prototype,"LayerNetError",void 0),a([h(cc.Node)],t.prototype,"LayerRule",void 0),a([h(cc.Sprite)],t.prototype,"sp_setup",void 0),a([h(cc.Sprite)],t.prototype,"sp_auto",void 0),a([h(cc.Sprite)],t.prototype,"sp_lock",void 0),a([h(cc.Sprite)],t.prototype,"sp_speed",void 0),a([p],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./HQL2Const":"HQL2Const","./HQL2Manager":"HQL2Manager","./HQL2NetWork":"HQL2NetWork"}],HQL2NetWork:[function(e,t,o){"use strict";cc._RF.push(t,"fe7a1kUHtlCybZKGPMM4tC0","HQL2NetWork");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(a<3?i(s):a>3?i(t,o,s):i(t,o))||s);return a>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./HQL2Const"),c=e("./HQL2Manager"),r=cc._decorator,l=r.ccclass,d=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return i(t,e),o=t,t.prototype.onLoad=function(){o.once=this,GameConfig.SubGameMgr.subGameNet=this,this.send("loginGame",{})},t.prototype.start=function(){},t.prototype.send=function(e,t){void 0===t&&(t={}),window.sendNetWorkData&&(console.log("send cmd:"+e+",data:",t),window.sendNetWorkData(e,"string"==typeof t?t:JSON.stringify(t)))},t.prototype.addNetEvent=function(e,t){if("loginGameResult"==e){var o=this.changeResultJSON_Function(t);console.log("\u6e38\u620f\u767b\u9646\u6210\u529f=======================",e,o),o.resultid?(s.HQL2Const.once.RoomBet=o.Obj.bet,s.HQL2Const.once.PlayerInfo.win_pool=o.Obj.winPool,s.HQL2Const.once.PlayerInfo.playerDiamond=o.Obj.wins,s.HQL2Const.once.PlayerInfo.playerId=o.Obj.id,s.HQL2Const.once.Entries=o.Obj.score,this.send("LoginRoom",{roomid:1})):this.tryLeave()}if("LoginRoomResult"==e&&(t=this.changeResultJSON_Function(t),cc.log("LoginRoomResult",t),t.ResultCode)){cc.log("LoginRoomResult------------------\x3e"+JSON.stringify(t)),s.HQL2Const.once.BLevels=t.ResultData.betList,c.default.once.CmdBYTable(t);for(var n=t.ResultData.userList,i=0;i<n.length;i++)c.default.once.CmdBYCannonChange(n[i])}if("HitResult"==e&&(o=this.changeResultJSON_Function(t),console.log("HitResult: ",o),1==o.ResultCode&&(o.hitInfo&&4==o.hitInfo.bulletType&&(o.ResultData.from=o.hitInfo.from,o.ResultData.sendFishs=o.hitInfo.fishId,o.ResultData.butype=o.hitInfo.bulletType),c.default.once.CmdBYShotFish(o.ResultData))),"FishOut"==e&&(o=this.changeResultJSON_Function(t),c.default.once.createFish(o)),"fishShoot"==e&&(o=this.changeResultJSON_Function(t),console.log("fishShoot=======================",o),c.default.once.CmdBYShot(o)),"getDownTimeResult"==e&&(o=this.changeResultJSON_Function(t),console.log("getDownTimeResult======================="+JSON.stringify(o))),"doubleEnd"==e&&(o=this.changeResultJSON_Function(t)),"chargeAllResult"==e&&(o=this.changeResultJSON_Function(t),console.log("chargeAllResult",o),c.default.once.rechargeAllResult(o)),"playEnter"==e&&(o=this.changeResultJSON_Function(t)).ResultCode&&(cc.log("playEnter:"+this.changeResultJSON_Function(t)),c.default.once.CmdBYFishSeatChange(o.ResultData.seatId,o.ResultData)),"broadcast"==e){o=this.changeResultJSON_Function(t);cc.log("broadcast:",o),c.default.once.broadcast(o)}if("PlayerOut"==e&&(o=this.changeResultJSON_Function(t),cc.log("PlayerOut:"+this.changeResultJSON_Function(t)),c.default.once.CmdBYFishSeatChange(o.PlayerSeatId,null)),"changePowerResult"==e&&(o=this.changeResultJSON_Function(t),cc.log("changePowerResult :"+JSON.stringify(o)),c.default.once.CmdBYCannonChange(o)),"useSkillResult"==e&&(o=this.changeResultJSON_Function(t),console.log("useSkillResult",o)),"fishHit_boardResult"==e){var a=this.changeResultJSON_Function(t);a.uid==s.HQL2Const.once.PlayerInfo.playerId&&this.send("fishHit",a)}"fishSceneChange"==e&&(o=this.changeResultJSON_Function(t))&&(cc.log("fishSceneChange:"+this.changeResultJSON_Function(t)),o.change_scene_type%=3,c.default.once.CmdByStageChange(o)),"disconnect"==e&&this.tryLeave()},t.prototype.requestLeaveRoom=function(){Common.backHall("Are you sure you want to leave the game?",function(){})},t.prototype.tryLeave=function(){this.levea()},t.prototype.levea=function(){Common.backHall("Are you sure you want to leave the game?",function(){})},t.prototype.closeSocket=function(){},t.prototype.changeResultJSON_Function=function(e){return JSON.parse(e)},t.prototype.onDestroy=function(){o.once=null},o=a([l],t)}(cc.Component));o.default=d,cc._RF.pop()},{"./HQL2Const":"HQL2Const","./HQL2Manager":"HQL2Manager"}],HQL2Scene:[function(e,t,o){"use strict";cc._RF.push(t,"b783bVDxRVBhZCx8yBIH+YW","HQL2Scene");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(a<3?i(s):a>3?i(t,o,s):i(t,o))||s);return a>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./HQL2Const"),c=e("./HQL2Manager"),r=e("./HQL2Effect"),l=e("./HQL2Menu"),d=e("./HQL2Coin"),p=e("./HQL2Bullet"),h=e("./HQL2Fish"),f=e("./HQL2FishNet"),u=e("./HQL2Weapon"),y=e("./HQL2EffectLayer"),_=e("./HQL2Bill"),L=e("./HQL2User"),g=e("./HQL2Loading"),m=e("../../../Script/utils/Utils"),v=cc._decorator,C=v.ccclass,I=v.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LoadingLayer=null,t.MenuLayer=null,t.WeaponLayer=null,t.EffectLayer=null,t.RechargeLayer=null,t.FishParent=null,t.BulletParent=null,t.GoldParent=null,t.GoldLabelParent=null,t.NetParent=null,t.EffectSKParent=null,t.EffectParent=null,t.arr_fishs=[],t.arr_bullets=[],t.arr_effect=[],t.arr_coin=[],t.arr_seats=[],t}return i(t,e),t.prototype.onLoad=function(){this.LoadingLayer.loadFinish(),c.default.once.GameLayer=this,this.initView(),this.EffectLayer.defaultLight(this.node),c.default.once.initData(),this.loadFinish()},t.prototype.changeGold=function(e){return(parseFloat(e)/s.HQL2Const.once.PlayerInfo.exchangeRate).toFixed(2)},t.prototype.loadFinish=function(){this.initData();for(var e=0;e<this.arr_seats.length;e++)this.arr_seats[e].initUI(),this.arr_seats[e].cleanInfo();this.WeaponLayer.init()},t.prototype.initData=function(){this.arr_fishs=[],this.arr_bullets=[],this.arr_effect=[],this.arr_coin=[];var e=cc.find("layer_load/pr_net",this.node);e.addComponent(f.default);var t=cc.find("layer_load/pr_fish",this.node);t.addComponent(h.default);var o=cc.find("layer_load/pr_bullet",this.node);o.addComponent(p.default);var n=cc.find("layer_load/pr_effect",this.node);n.addComponent(r.default);var i=cc.find("layer_load/pr_coin",this.node);i.addComponent(d.default);var a=cc.find("layer_load/lb_coin",this.node),s=cc.find("layer_load/pr_bill",this.node);s.addComponent(_.default),this.pool_fish=this.createPool(400,t),this.pool_bullet=this.createPool(300,o),this.pool_net=this.createPool(130,e),this.pool_coin=this.createPool(400,i),this.pool_effect=this.createPool(50,n),this.pool_bill=this.createPool(20,s),this.pool_coinlb=this.createPool(200,a)},t.prototype.createPool=function(e,t){var o=new cc.NodePool;o.prefab=t;for(var n=0;n<e;n++)o.put(cc.instantiate(t));return o},t.prototype.getNodeByPool=function(e){var t=e.get();return t||(t=cc.instantiate(e.prefab)),t},t.prototype.clearLockFishAllBullet=function(e){for(var t=this.getBullets(),o=0;o<t.length;o++){var n=t[o];n.lockFishId===e&&n.clearLockID()}},t.prototype.initView=function(){var e=s.HQL2Const.once.PlayerInfo.useOneScore?this.node.getChildByName("layer_users2").children:this.node.getChildByName("layer_users").children;this.arr_seats=[];for(var t=0;t<4;t++){var o=e[t].getComponent(L.default);this.arr_seats.push(o)}for(this.layer_bgs=this.node.getChildByName("layer_bgs"),t=0;t<5;t++){var n=this.RechargeLayer.getChildByName("btn_"+t);m.default.addClickEvent(n,this,m.default.getComponentName(this),"onClickedRecharge",t)}},t.prototype.getFishs=function(){return this.arr_fishs||[]},t.prototype.getBullets=function(){return this.arr_bullets||[]},t.prototype.changeSceneBg=function(e,t,o){void 0===e&&(e=0);var n="bg"+o%3;if(c.default.once.playBGM(n),e!=o){for(var i=this.layer_bgs.children,a=0;a<i.length;a++){var s=i[a],r=s.name==="layer_"+e&&t,l=s.name==="layer_"+o;s.active=r||l,s.active&&(s.setPosition(0,0),s.opacity=255,s.zIndex=l?0:1)}if(t){c.default.once.playSFX("effect_108");var d=this.layer_bgs.getChildByName("layer_"+e);d.stopAllActions();var p=d.getChildByName("bg");p.stopAllActions(),d.runAction(cc.moveTo(3,cc.v2(-2e3,0))),p.runAction(cc.sequence(cc.moveTo(3,cc.v2(2e3,0)),cc.callFunc(function(){p.setPosition(0,0),d.active=""+e==""+o})))}}},t.prototype.updateBalance=function(e,t){var o=c.default.once.getTableByUID(e);if(o){var n=this.getUserByTable(o.seatId);n&&n.updateBalance(t)}},t.prototype.updateDiamond=function(e,t){var o=c.default.once.getTableByUID(e);if(o){var n=this.getUserByTable(o.seatId);n&&n.updateDiamond(t)}},t.prototype.getUserByTable=function(e){for(var t=null,o=0;o<this.arr_seats.length;o++)this.arr_seats[o]._seatId===e&&(t=this.arr_seats[o]);return t},t.prototype.refreshTable=function(e){void 0===e&&(e=null);var t=[0,1,2,3];for(var o in s.HQL2Const.once.users){var n=s.HQL2Const.once.users[o];if(n){var i=parseInt(n.seatId);if(t.splice(t.indexOf(i),1),e&&n.userId!==e.userId)continue;var a=c.default.once.tableConvertIndex(i),r=c.default.once.userConvertIndex(s.HQL2Const.once.userId);cc.log("index======>"+a+"---selfIndex--\x3e"+r+"--u------\x3e"+JSON.stringify(n)),this.WeaponLayer.setConvertWeaponActive(n.userId,!0,null!=e),null!=e&&this.WeaponLayer.setLevelByUID(n.userId,0),this.arr_seats[a].refreshUserInfo(n),this.arr_seats[a].node.active=!0,n.userId==s.HQL2Const.once.userId?this.WeaponLayer.setWeaponGold(n.userId,s.HQL2Const.once.BLevels[s.HQL2Const.once.BLevel]):this.WeaponLayer.setWeaponGold(n.userId,n.bet)}}for(var l=0;l<t.length;l++)a=c.default.once.tableConvertIndex(t[l]),cc.log("cleanInfoByTid------\x3e"+a),this.arr_seats[a].cleanInfo(),this.WeaponLayer.cleanInfoByTid(t[l])},t.prototype.showUserLock=function(e,t){var o=c.default.once.tableConvertIndex(e),n=this.arr_seats[o];n&&n.showLockFish(t)},t.prototype.UnLockFishNtfType=function(e){var t=c.default.once.tableConvertIndex(e),o=this.arr_seats[t];o&&o.unLock()},t.prototype.updateFish=function(){var e=s.HQL2Const.once.FishConfigs[m.default.randomNum(0,s.HQL2Const.once.FishConfigs.length)].FishID,t=s.HQL2Const.once.FishGroups[7],o=t.id,n=s.HQL2Const.once.FishPath[0],i=c.default.once.getFishConfig(e),a=c.default.once.getFishPathByID(n.id),r=c.default.once.getFishPoints(e);r=m.default.deepCopy(r);for(var l=0;l<t.num;l++)this.refreshFish({config:i,FishPath:a,fid:e,groupId:o,index:l,compensate:0,swimmingInterval:0,pathInterval:n.time,conlliderPoints:r})},t.prototype.refreshFish=function(e){var t=e,o="layer_"+c.default.once.getFishLayerIndex(t.fid);if(parseInt(t.fid)>=30&&cc.log("--------dsfdsfdsfdfsdfsdfsdfsdf"),this.pool_fish.size()<5&&cc.log("\u9c7c\u82d7\u62a5\u8b66"),t.config&&o)if(t.groups){if(!(t.groups&&t.groups.origin&&t.groups.points&&t.groups.points[t.index])){var n="!groups";return t.groups.origin||(n="!groups.origin"),t.groups.points||(n="!groups.points"),t.groups.points[t.index]||(n="!groups.points[param.index]"),void cc.log("\u627e\u4e0d\u5230\u9c7c\u7ec4\u914d\u7f6e\u4fe1\u606f ID\uff1a"+t.groupId+"  \u7f3a\u5931\u4fe1\u606f\uff1a"+n+"  param.index:"+t.index)}if(t.FishPath)if(t.swimAni=c.default.once.getSwimAnimateByID(t.fid),t.swimAni||-1!=[30,34,35,39,43].indexOf(parseInt(t.fid)))if(t.dieAni=c.default.once.getDeathAnimateByID(t.fid),t.dieAni||-1!=[30,34,35,39,43].indexOf(parseInt(t.fid))){var i=this.getNodeByPool(this.pool_fish),a=i.getComponent(h.default);this.arr_fishs.push(a),i.parent=this.FishParent.getChildByName(o),a.init(t)}else cc.log("\u627e\u4e0d\u5230\u9c7c\u7684\u6b7b\u4ea1\u52a8\u753bID\uff1a"+t.fid);else cc.log("\u627e\u4e0d\u5230\u9c7c\u7684\u52a8\u753bID\uff1a"+t.fid);else cc.log("\u627e\u4e0d\u5230\u9c7c\u7684\u8def\u5f84ID\uff1a"+t.pid)}else cc.log("\u627e\u4e0d\u5230\u9c7c\u7ec4\u914d\u7f6e\u4fe1\u606f ID\uff1a"+t.groupId);else cc.log("fishError\u627e\u4e0d\u5230\u9c7c\u7684\u4fe1\u606f ID\uff1a"+t.fid+"  "+!o)},t.prototype.getLockFishByFishId=function(e){for(var t=0;t<this.WeaponLayer.arr_locks.length;t++){var o=this.WeaponLayer.arr_locks[t];if(e===o.fishId)return o}return null},t.prototype.addNet=function(e,t,o,n){var i=this.getNodeByPool(this.pool_net),a=i.getComponent(f.default);i.zIndex=5e3,this.NetParent.addChild(i),a.init(e,t,o,n)},t.prototype.addEffect=function(e){if(cc.isValid(this.node)){var t=this.getNodeByPool(this.pool_effect),o=t.getComponent(r.default);return this.EffectParent.addChild(t),e.parent=this.EffectSKParent,o.init(e),this.arr_effect.push(o),o}},t.prototype.addRoute=function(){},t.prototype.getEffectBySkillId=function(e,t){void 0===t&&(t=!0);for(var o=[],n=0;n<this.arr_effect.length;n++){var i=this.arr_effect[n];if(i.param&&i.param.skillId===e){if(!t)return i;o.push(i)}}return t?o:null},t.prototype.addBullet=function(e){var t=e;t.angle=t.angle||this.WeaponLayer.getWeaponRotationByTid(t.seatId);var o=this.WeaponLayer.getWeaponOutPositionByTid(t.seatId),n=this.getNodeByPool(this.pool_bullet),i=n.getComponent(p.default);n.zIndex=2e3,this.arr_bullets.push(i),t.point=t.point||this.BulletParent.convertToNodeSpaceAR(o),this.BulletParent.addChild(n),t.isDrill&&(t.lock=null),i.init(t)},t.prototype.showRecharge=function(){Common.showMessage("not enough balance")},t.prototype.onClickedRecharge=function(e,t){cc.log("onClickedRecharge----\x3e"+t),4==parseInt(t)?c.default.once.requestRechargeAll():c.default.once.requestRechargeSum([1,10,50,100][parseInt(t)])},t.prototype.addBill=function(e){var t=-1!=[43,30,35,34].indexOf(e.fid)?cc.instantiate(this.pool_bill.prefab):this.getNodeByPool(this.pool_bill);t.parent=this.EffectParent,t.position=e.position?this.EffectParent.convertToNodeSpaceAR(e.position):cc.v2(0,0),t.getComponent(_.default).show(e)},t.prototype.addCoin=function(e){var t=this.getNodeByPool(this.pool_coin);t.parent=e.parent||this.GoldParent,t.zIndex=1e4;var o=e,n=this.WeaponLayer.DoubleBg[o.index];if(n){var i=n.convertToWorldSpaceAR(cc.v2(0,0)),a=t.getComponent(d.default);o.to=i,a.init(o),this.arr_coin.push(a)}},t.prototype.addCoinLb=function(e){e||(e={});var t=this.getNodeByPool(this.pool_coinlb);if(t.parent=this.GoldLabelParent,e.position)t.position=e.position;else{var o=c.default.once.tableConvertIndex(e.seatId),n=this.arr_seats[o].getUserWinWorldPoint();t.position=t.parent.convertToNodeSpaceAR(n)}t.active=!0,t.zIndex=10001;var i=t.getComponent("HQL2Label");return i.defaultNames="score1_",i.spriteAtlas=i.spriteAtlas||s.HQL2Const.once.UIAtals,i.string=""+c.default.once.GameLayer.changeGold(e.award),t},t.prototype.despawnBill=function(e){e.node&&this.pool_bill.put(e.node)},t.prototype.despawnBullet=function(e){e.seatId===s.HQL2Const.once.seatId&&s.HQL2Const.once.BulletCount--,e.clear(),e.setLockFishID(-1),e.node&&this.pool_bullet.put(e.node);var t=this.arr_bullets.indexOf(e);this.arr_bullets.splice(t,1),e.isDrill&&(this.despawnRoute(e.nid),e.drillRoute=null)},t.prototype.despawnEffect=function(e){e.clean();var t=this.arr_effect.indexOf(e);this.arr_effect.splice(t,1),this.pool_effect.put(e.node)},t.prototype.despawnRoute=function(){},t.prototype.despawnCoin=function(e){e.node instanceof cc.Node&&(this.pool_coin.put(e.node),e.clean()),e instanceof cc.Node&&this.pool_coin.put(e);var t=this.arr_coin.indexOf(e);this.arr_coin.splice(t,1)},t.prototype.despawnCoinLb=function(e){e.node instanceof cc.Node&&(this.pool_coinlb.put(e.node),e.clean()),e instanceof cc.Node&&this.pool_coinlb.put(e)},t.prototype.clearTableFishs=function(){for(var e=this.FishParent.childrenCount-1;e>=0;e--){var t=this.FishParent.children[e].getComponent(h.default);t&&this.despawnFish(t)}},t.prototype.despawnFish=function(e){var t=this.arr_fishs.indexOf(e);-1!==t&&this.arr_fishs.splice(t,1),e.node&&e instanceof h.default&&"0"==e.params.config.AnimType?(e.node.active=!1,this.pool_fish.put(e.node)):e.node.destroy()},t.prototype.despawnNet=function(e){e.node&&this.pool_net.put(e.node)},t.prototype.update=function(e){if(cc.isValid(this.node)){(s.HQL2Const.once.HeartBeatCD-=e)<0&&(s.HQL2Const.once.HeartBeatCD=5,c.default.once.heartBeat());for(var t=[],o=0;o<this.arr_fishs.length;o++){var n=this.arr_fishs[o];if(n.updatexxx(e),n&&n.alive){var i=n.node.convertToWorldSpaceAR(cc.v2(0,0));t.push({fish:n,fwsp:i})}}for(var a=[],r=0;r<this.arr_bullets.length;r++){var l=this.arr_bullets[r];l.updatexxx(e);var d=l.node.convertToWorldSpaceAR(cc.v2(0,0)),p=cc.v2(d.x,d.y-50),h=cc.v2(d.x-20,d.y),f=cc.v2(d.x+20,d.y);a.push({bullet:l,bwsp:d,bwspDown:p,bwspLeft:h,bwspRight:f})}for(r=0;r<a.length;r++){var u=a[r];for(o=0;o<t.length;o++){var y=t[o],_=u.bwsp.sub(y.fwsp).mag();if((y.fish.radius>200?200:y.fish.radius)>_||y.fish.fid>=30){var L=y.fish.getColliderPoints().ws;(_<50||y.fish==u.bullet.lockFish||m.default.rayCasting(u.bwsp,L)||m.default.rayCasting(u.bwspDown,L)||m.default.rayCasting(u.bwspLeft,L)||m.default.rayCasting(u.bwspRight,L))&&u.bullet.onCollision(y.fish)}}}a=null,t=null}},t.prototype.onDestroy=function(){var e=function(e){for(var t=0;t<e.length;t++){var o=e[t];o.node&&(o.node.removeFromParent(),o.node.destroy())}};e(this.arr_coin),e(this.arr_bullets),e(this.arr_fishs),e(this.arr_effect),s.HQL2Const.destroyInstance(),c.default.destroyInstance()},a([I(g.default)],t.prototype,"LoadingLayer",void 0),a([I(l.default)],t.prototype,"MenuLayer",void 0),a([I(u.default)],t.prototype,"WeaponLayer",void 0),a([I(y.default)],t.prototype,"EffectLayer",void 0),a([I(cc.Node)],t.prototype,"RechargeLayer",void 0),a([I(cc.Node)],t.prototype,"FishParent",void 0),a([I(cc.Node)],t.prototype,"BulletParent",void 0),a([I(cc.Node)],t.prototype,"GoldParent",void 0),a([I(cc.Node)],t.prototype,"GoldLabelParent",void 0),a([I(cc.Node)],t.prototype,"NetParent",void 0),a([I(cc.Node)],t.prototype,"EffectSKParent",void 0),a([I(cc.Node)],t.prototype,"EffectParent",void 0),a([C],t)}(cc.Component);o.default=b,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./HQL2Bill":"HQL2Bill","./HQL2Bullet":"HQL2Bullet","./HQL2Coin":"HQL2Coin","./HQL2Const":"HQL2Const","./HQL2Effect":"HQL2Effect","./HQL2EffectLayer":"HQL2EffectLayer","./HQL2Fish":"HQL2Fish","./HQL2FishNet":"HQL2FishNet","./HQL2Loading":"HQL2Loading","./HQL2Manager":"HQL2Manager","./HQL2Menu":"HQL2Menu","./HQL2User":"HQL2User","./HQL2Weapon":"HQL2Weapon"}],HQL2User:[function(e,t,o){"use strict";cc._RF.push(t,"a0660JnJplI95OdIS07yV2L","HQL2User");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(a<3?i(s):a>3?i(t,o,s):i(t,o))||s);return a>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./HQL2Const"),c=e("./HQL2Manager"),r=cc._decorator,l=r.ccclass,d=r.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._seatId=-1,t.lb_total=null,t.lb_gold=null,t.layer_zz=null,t}return i(t,e),t.prototype.initUI=function(){this.unLock(),this.node.getChildByName("btn_add").on("click",this.onClickedAdd,this)},t.prototype.onClickedAdd=function(){this._seatId==s.HQL2Const.once.seatId&&(c.default.once.GameLayer.showRecharge(!1),c.default.once.playSFX("click"))},t.prototype.refreshUserInfo=function(e){if(cc.log("uinfo----\x3e"+JSON.stringify(e)),e){this._seatId=e.seatId,this.node.getChildByName("btn_add").active=e.seatId==s.HQL2Const.once.seatId&&!s.HQL2Const.once.PlayerInfo.useOneScore,this.updateBalance(e.score),this.updateDiamond(e.wins),this.node.active=!0,this.lb_gold.node.parent.active=!0;var t=c.default.once.tableConvertIndex(this._seatId);this.node.x=.19*cc.view.getVisibleSize().width,this.node.x=t%2?this.node.x+297:-this.node.x-297}},t.prototype.updateBalance=function(e){e=e||0,this.lb_gold.string=c.default.once.GameLayer.changeGold(e)},t.prototype.updateDiamond=function(e){e=e||0,this.lb_total.string=c.default.once.GameLayer.changeGold(e)},t.prototype.showZZ=function(e){this.layer_zz&&(this.layer_zz.active=e)},t.prototype.showLockFish=function(){},t.prototype.unLock=function(){},t.prototype.cleanInfo=function(){this.node.active=!1,this._seatId=-1,this.lb_total.string="",this.lb_gold.string="0",this.lb_gold.node.parent.active=!1,this.unLock()},t.prototype.getUserWorldPoint=function(){return this.node.convertToWorldSpaceAR(cc.v2(0,-30))},t.prototype.getUserWinWorldPoint=function(){return this.lb_gold.node.convertToWorldSpaceAR(cc.v2(0,-30))},a([d(cc.Label)],t.prototype,"lb_total",void 0),a([d(cc.Label)],t.prototype,"lb_gold",void 0),a([d(cc.Node)],t.prototype,"layer_zz",void 0),a([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{"./HQL2Const":"HQL2Const","./HQL2Manager":"HQL2Manager"}],HQL2Weapon:[function(e,t,o){"use strict";cc._RF.push(t,"45fb4Kluq9Mc5Vd7za8+f2K","HQL2Weapon");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(a<3?i(s):a>3?i(t,o,s):i(t,o))||s);return a>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../../Script/utils/Utils"),c=e("./HQL2Const"),r=e("./HQL2Fish"),l=e("./HQL2Manager"),d=cc._decorator,p=d.ccclass,h=d.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.SeatWaits=[],t.FishParent=null,t.arr_weaponAn=[],t.arr_weaponFire=[],t.WeaponUI=[],t.DoubleBg=[],t.arr_golds=[],t.an_lines=[],t.layer_line=[],t.spacingY=30,t.firstFire={set:function(e){e!==this._firstFire&&(this._firstFire=e,!this._firstFire&&this.GameLayer.MenuLayer._mune&&this.GameLayer.MenuLayer.onClickedShow())},get:function(){return this._firstFire}},t.arr_weapons=[],t.arr_lines=[],t.arr_circle=[],t.arrLevels=[],t.arr_locks=[c.HQL2Const.once.NotFound,c.HQL2Const.once.NotFound,c.HQL2Const.once.NotFound,c.HQL2Const.once.NotFound],t.arr_changes=[],t._limitTime=0,t.LastFireTime=0,t.AutoFire=!1,t._fireAnCd=[-9999,-9999,-9999,-9999],t}return i(t,e),t.prototype.onLoad=function(){},t.prototype.init=function(){this.initViewData(),this.FishParent.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.FishParent.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.FishParent.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.FishParent.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.FishParent._touchListener.setSwallowTouches(!1),this.schedule(this.speed0,c.HQL2FireSpeed.Speed0),this.schedule(this.speed1,c.HQL2FireSpeed.Speed1),this.firstFire=!0},t.prototype.speed1=function(){c.HQL2Const.once.FightLimit==c.HQL2FireSpeed.Speed1&&(this.limitFireCd(),this.checkAutoFire())},t.prototype.speed0=function(){c.HQL2Const.once.FightLimit==c.HQL2FireSpeed.Speed0&&(this.limitFireCd(),this.checkAutoFire())},t.prototype.limitFireCd=function(){this.checkAutoLock(),this._canFire=!0},t.prototype.checkAutoFire=function(){if(-1!=c.HQL2Const.once.seatId&&(c.HQL2Const.once.IsAuto||this.AutoFire)){var e=this.getWeaponOutPositionByTid(c.HQL2Const.once.seatId),t=l.default.once.tableConvertIndex(),o=this.arr_locks[t];if(o instanceof r.default)e=o.getWorldPoint();else if(c.HQL2Const.once.IsLock)return;this._touchPoint&&(e=this._touchPoint,this._touchPoint=null),l.default.once.onTouchWindow(e,o.fishId),this.firstFire=!1}},t.prototype.setWeaponGold=function(e,t){var o=l.default.once.userConvertIndex(e),n=this.arr_golds[o];if(n){var i=t*c.HQL2Const.once.RoomBet;n.string=parseFloat(""+l.default.once.GameLayer.changeGold(i)).toFixed(2),n.node.active=!0}},t.prototype.setConvertWeaponActive=function(e,t,o){void 0===o&&(o=!0);var n=l.default.once.userConvertIndex(e);try{var i=this.WeaponUI[n];if(i.active=this.arr_weaponAn[n].node.active=t,this.SeatWaits[n].active=!t,this.WeaponUI[n].getChildByName("btn_add").active=t&&c.HQL2Const.once.userId===e,this.WeaponUI[n].getChildByName("btn_minus").active=t&&c.HQL2Const.once.userId===e,c.HQL2Const.once.userId===e&&o){for(var a=[cc.fadeIn(.1)],s=0;s<8;s++)a.push(cc.moveTo(.5,cc.v2(0,s%2==0?160:190)));a.push(cc.fadeOut(.1));var r=i.getChildByName("sp_there");r.active=!0,r.stopAllActions(),r.runAction(cc.sequence(a))}}catch(d){cc.log("setConvertWeaponActive---\x3e"+JSON.stringify(d))}},t.prototype.initViewData=function(){for(var e=this.WeaponUI,t=0;t<4;t++){var o=e[t];o.getChildByName("sp_lock").getComponent(cc.Sprite).spriteFrame=l.default.once.getFrameByName("icon_locking");for(var n=cc.find("an_pao",o).getComponent(cc.Animation),i=n.node.getChildByName("sp_fire").getComponent(cc.Animation),a=0;a<3;a++){var s=l.default.once.getEffectByType("wait"+a+"_");s.wrapMode=cc.WrapMode.Loop,n.addClip(s);var c=l.default.once.getEffectByType("launch"+a+"_");c.wrapMode=2==a?cc.WrapMode.Loop:cc.WrapMode.Normal,n.addClip(c)}var r=o.getChildByName("an_line").getComponent(cc.Animation),d=l.default.once.getEffectByType("lockLightning_");d.wrapMode=cc.WrapMode.Loop,r.addClip(d),this.an_lines.push(r);var p=o.getChildByName("sp_lock").getComponent(cc.Animation),h=l.default.once.getEffectByType("lockBall_");h.wrapMode=cc.WrapMode.Normal,p.addClip(h);var f="onFinishBoll"+t;p.on("finished",this[f],this),this.arr_circle.push(p),this.arr_weaponFire[t]=i;var u="onFinishFireAn"+t;i.on("finished",this[u],this);var y="onFinishWeaponAn"+t;n.on("finished",this[y],this),this.arr_weaponAn[t]=n,i.node.active=!1,o.getChildByName("double").active=!1,cc.find("btn_add",o).on("click",this.onClickedAdd,this),cc.find("btn_minus",o).on("click",this.onClicked__,this),cc.find("btn_add",o).active=!1,cc.find("btn_minus",o).active=!1,this.arr_golds.push(n.node.getChildByName("lb_level").getComponent("HQL2Label")),this.arr_weapons.push(o.getChildByName("tip"));var _=o.getChildByName("an_line").getComponent(cc.Sprite);this.arr_lines.push(_);var L=o.getChildByName("layer_line");this.layer_line.push(L),this.arrLevels.push(0)}},t.prototype.setTimelimit=function(e){this._limitTime=e},Object.defineProperty(t.prototype,"timeLimit",{get:function(){return this._limitTime<=0&&this._canFire},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"balanceLimit",{get:function(){var e=this.getLevelCoinByUID();return c.HQL2Const.once.Entries>=e},enumerable:!1,configurable:!0}),t.prototype.setClickLimit=function(e){this._canFire=e},t.prototype.paramAniName=function(e){return e<0&&(e=0),e>1&&(e=1),"wait"+e+"_"},t.prototype.getLevelCoinByUID=function(e){void 0===e&&(e=404);var t=404===e?c.HQL2Const.once.userId:e,o=l.default.once.userConvertIndex(t);return parseFloat(this.arr_golds[o].string)},t.prototype.refreshWeaponByIndex=function(e,t){var o=this.arrLevels[e];if(void 0!==o){var n=this.paramAniName(o,t);this.arr_weaponAn[e].play(n)}},t.prototype.showChangeWeaponByIndex=function(e){var t=this.arrLevels[e],o=this.paramAniName(t,1);this.arr_weaponAn[e].play(o)},t.prototype.setLevelByUID=function(e,t){var o=0;t>50&&(o=1);var n=l.default.once.userConvertIndex(e);l.default.once.playSFX("weapon_change"),o>3&&(o=3),o<0&&(o=0),this.arrLevels[n]=o,this.showChangeWeaponByIndex(n)},t.prototype.cleanInfoByTid=function(e){var t=l.default.once.tableConvertIndex(e);this.arrLevels[t]=0,this.showDoubleByIndex(t,0),this.arr_weaponAn[t].node.active=!1,this.arr_golds[t].node.active=!1,this.DoubleBg[t].active=!1,this.WeaponUI[t].active=!1,this.SeatWaits[t].active=!0,this.setLockFishByTid(e,404)},t.prototype.hideLockLineByIndex=function(e){var t=this.arr_lines[e];t&&(t.node.active=!1,this.arr_circle[e].active=!1)},t.prototype.showKilinLineByTid=function(e,t){if(t instanceof r.default){var o=t.getWorldPoint(),n=l.default.once.tableConvertIndex(e);this.changeWeaponRotationByTid(o,e,!1);var i=this.arr_weapons[n],a=this.layer_line[n];a.angle=i.angle;var s=this.getWeaponOutPositionByTid(e,140);a.position=a.parent.convertToNodeSpaceAR(s),a.scale=1;var d=o.sub(s).mag()/1.3/9;d=Math.ceil(d)-1;for(var p=a.children.length,h=0;h<d||h<p;h++){var f=a.children[h];f||((f=cc.instantiate(a.children[0])).active=!1),f.getComponent(cc.Sprite).spriteFrame=h%2?c.HQL2Const.once.UIAtals.getSpriteFrame("fish21_tex_06"):c.HQL2Const.once.UIAtals.getSpriteFrame("fish21_tex_05"),f.scale=1,a!==f.parent&&(f.parent=a),f.active!==h<d&&(f.active=h<d)}a.active=!0}},t.prototype.showLockLineByTid=function(e,t){if(t instanceof r.default){var o=t.getWorldPoint(),n=l.default.once.tableConvertIndex(e);this.changeWeaponRotationByTid(o,e,!1);var i=this.arr_weapons[n];this.arr_circle[n].node.position=i.parent.convertToNodeSpaceAR(o);var a=this.arr_lines[n];a.node.angle=i.angle;var s=this.getWeaponOutPositionByTid(e,142);a.node.position=a.node.parent.convertToNodeSpaceAR(s),a.node.scale=1;var c=o.sub(s).mag()-10;a.node.scaleY=c/641/1.3,a.node.active=!0}},t.prototype.getConvertWeaponRotationByTid=function(e,t,o){void 0===o&&(o=0);var n=l.default.once.tableConvertIndex(t),i=this.arr_weapons[n];if(cc.isValid(i)){var a=o,s=i.convertToWorldSpaceAR(cc.v2(0,a));return l.default.once.convertPointToAngle(s,e)-90}},t.prototype.getWeaponRotationByTid=function(e){var t=l.default.once.tableConvertIndex(e);return this.arr_weapons[t].angle},t.prototype.getWeaponLowerPositionByTid=function(e){var t=l.default.once.tableConvertIndex(e);return this.arr_weapons[t].convertToWorldSpaceAR(cc.v2(0,0))},t.prototype.onTouchStart=function(e,t){l.default.once.playSFX("click");var o=e.getLocation(),n=l.default.once.tableConvertIndex(),i=this.WeaponUI[n],a=i.getChildByName("btn_add").convertToWorldSpaceAR(cc.v2(0,0)),s=i.getChildByName("btn_minus").convertToWorldSpaceAR(cc.v2(0,0));a.sub(o).mag()<50||s.sub(o).mag()<50||-1!=c.HQL2Const.once.seatId&&(c.HQL2Const.once.IsAuto&&this.onTouchMove(e),this.getLockFishByTid(c.HQL2Const.once.seatId)instanceof r.default||this.changeWeaponRotationByTid(e.getLocation(),c.HQL2Const.once.seatId),t instanceof r.default&&c.HQL2Const.once.IsLock&&(cc.log("\u70b9\u51fb\uff1a"+t.config.Name),l.default.once.CmdBYLockFish(t)),this.clickFire(o),this.AutoFire=!0)},t.prototype.onTouchMove=function(e){-1!=c.HQL2Const.once.seatId&&(this._touchPoint=e.getLocation(),this.getLockFishByTid(c.HQL2Const.once.seatId)instanceof r.default||this.changeWeaponRotationByTid(e.getLocation(),c.HQL2Const.once.seatId))},t.prototype.onTouchEnd=function(e){this.AutoFire=!1,-1!=c.HQL2Const.once.seatId&&(this.getLockFishByTid(c.HQL2Const.once.seatId)instanceof r.default||this.changeWeaponRotationByTid(e.getLocation(),c.HQL2Const.once.seatId))},t.prototype.clickFire=function(e){this._limitTime>0||-1===c.HQL2Const.once.seatId||(c.HQL2Const.once.IsAuto?this._touchPoint=e:l.default.once.onTouchWindow(e))},t.prototype.changeWeaponRotationByTid=function(e,t,o){void 0===o&&(o=!0);var n=l.default.once.tableConvertIndex(t);if(this.arr_weapons[n]&&this.arr_weaponAn[n]){n>1&&o&&(e.y=cc.view.getVisibleSize().height-e.y);var i=-this.getConvertWeaponRotationByTid(e,t);this.arr_weapons[n].angle=i,this.arr_weaponAn[n].node.angle=i}},t.prototype.getWeaponOutPositionByTid=function(e,t){void 0===t&&(t=c.HQL2Const.once.WeaponHight);var o=l.default.once.tableConvertIndex(e);return this.arr_weapons[o].convertToWorldSpaceAR(cc.v2(0,t))},t.prototype.getLockFishByTid=function(e){var t=l.default.once.tableConvertIndex(e);return this.arr_locks[t]},t.prototype.onClickedAdd=function(){l.default.once.playSFX("click"),this.changeWeaponBet(1)},t.prototype.onClicked__=function(){l.default.once.playSFX("click"),this.changeWeaponBet(-1)},t.prototype.changeWeaponBet=function(e){var t=c.HQL2Const.once.BLevel;(t+=e)>=c.HQL2Const.once.BLevels.length&&(t=0),t<0&&(t=c.HQL2Const.once.BLevels.length-1),l.default.once.requestChangeCannonBet({userid:c.HQL2Const.once.userId,bet:c.HQL2Const.once.BLevels[t]})},t.prototype.sendHitFishReqType=function(e,t){var o=1;2==e.config.propFish&&(o=7),l.default.once.requestShotTarget(e.fishId,t,o,e.fishId)},t.prototype.showWeapon=function(e){var t=s.default.deepCopy(e),o=l.default.once.userConvertIndex(t.userid),n=this.getLockFishByTid(t.seatId);if(t.userid!=c.HQL2Const.once.userId){var i=n instanceof r.default?n.getWorldPoint():cc.v2(t.touch.x,t.touch.y);this.changeWeaponRotationByTid(i,t.seatId)}var a=this.arrLevels[o];if(t.seatId===c.HQL2Const.once.seatId){var d=t.isDrill?"s208":c.HQL2Const.once.IsLock?"dian":"v"+(a+1);l.default.once.playSFX(d),this.firstFire=!1,l.default.once.GameLayer.EffectLayer.showLable(this._limitTime)}if(n instanceof r.default&&!t.isDrill){this._fireAnCd[o]=1;var p=this.arr_weaponAn[o].currentClip;return p&&-1!==p.name.indexOf("launch2_")||this.arr_weaponAn[o].play("launch2_"),this.arr_circle[o].node.active=!0,this.arr_circle[o].play("lockBall_"),n.beAttack(),void(t.seatId===c.HQL2Const.once.seatId&&this.sendHitFishReqType(n,t.bulletId))}var h=a>=1?1:0;this.arr_weaponAn[o].play("launch"+h+"_"),t.lock=n.fishId,t.level=a,l.default.once.GameLayer.addBullet(t)},t.prototype.setLockFishByTid=function(e,t){var o=l.default.once.tableConvertIndex(e),n=this.getLockFishByTid(e);n instanceof r.default&&n.popLockTid(e),this.hideLockLineByIndex(o),t instanceof r.default&&l.default.once.showLockLineByTid(t,t.lockWeapons),this.an_lines[o].node.active=t instanceof r.default,t instanceof r.default?(this.arr_locks[o]=t,this.arr_weaponAn[o].play("wait2_"),this.an_lines[o].play("lockLightning_")):(this.arr_locks[o]=c.HQL2Const.once.NotFound,404==t?this.refreshWeaponByIndex(1,0):this["onFinishWeaponAn"+o]())},t.prototype.cleanFishAllWeaponLock=function(e){for(var t=0;t<4;t++){var o=this.getLockFishByTid(t);e.fishId===o.fishId&&this.setLockFishByTid(t)}},t.prototype.touchFishIsLock=function(e){var t=this.getLockFishByTid(c.HQL2Const.once.seatId);return c.HQL2Const.once.IsLock&&(t instanceof r.default&&t.fishId!==e.fishId||!(t instanceof r.default))},t.prototype.showDoubleByIndex=function(e,t){void 0===t&&(t=30);var o=this.DoubleBg[e];o.active=!0,o.stopAllActions(),o.runAction(cc.sequence(cc.delayTime(t),cc.callFunc(function(){o.active=!1})))},t.prototype.checkAutoLock=function(){if(-1!=c.HQL2Const.once.seatId&&c.HQL2Const.once.IsLock&&!(this.getLockFishByTid(c.HQL2Const.once.seatId)instanceof r.default)){var e=l.default.once.getMaxFish();e instanceof r.default&&l.default.once.CmdBYLockFish(e)}},t.prototype.update=function(e){if(cc.isValid(this.node)){this.LastFireTime-=e,this._limitTime-=e;for(var t=0;t<this._fireAnCd.length;t++)this._fireAnCd[t]-=e,this._fireAnCd<0&&this._fireAnCd>-90&&(this._fireAnCd[t]=-999,this["onFinishWeaponAn"+t]());this.LastFireTime<-999998||(this.LastFireTime,this.LastFireTime<-91&&this.LastFireTime>-190&&(this.LastFireTime=-999999))}},t.prototype.onFinishWeaponAn0=function(){var e=this.arr_weaponAn[0].currentClip;e&&-1!==e.name.indexOf("launch2_")?this.arr_weaponAn[0].play("wait2_"):this.refreshWeaponByIndex(0,1)},t.prototype.onFinishWeaponAn1=function(){var e=this.arr_weaponAn[1].currentClip;e&&-1!==e.name.indexOf("launch2_")?this.arr_weaponAn[1].play("wait2_"):this.refreshWeaponByIndex(1,1)},t.prototype.onFinishWeaponAn2=function(){var e=this.arr_weaponAn[2].currentClip;e&&-1!==e.name.indexOf("launch2_")?this.arr_weaponAn[2].play("wait2_"):this.refreshWeaponByIndex(2,1)},t.prototype.onFinishWeaponAn3=function(){var e=this.arr_weaponAn[3].currentClip;e&&-1!==e.name.indexOf("launch2_")?this.arr_weaponAn[3].play("wait2_"):this.refreshWeaponByIndex(3,1)},t.prototype.onFinishFireAn0=function(){this.arr_weaponFire[0].node.active=!1},t.prototype.onFinishFireAn1=function(){this.arr_weaponFire[1].node.active=!1},t.prototype.onFinishFireAn2=function(){this.arr_weaponFire[2].node.active=!1},t.prototype.onFinishFireAn3=function(){this.arr_weaponFire[3].node.active=!1},t.prototype.onFinishBoll0=function(){this.arr_circle[0].node.active=!1},t.prototype.onFinishBoll1=function(){this.arr_circle[1].node.active=!1},t.prototype.onFinishBoll2=function(){this.arr_circle[2].node.active=!1},t.prototype.onFinishBoll3=function(){this.arr_circle[3].node.active=!1},t.prototype.onDestroy=function(){this.unschedule(this.speed0),this.unschedule(this.speed1)},a([h([cc.Node])],t.prototype,"SeatWaits",void 0),a([h(cc.Node)],t.prototype,"FishParent",void 0),a([h([cc.Node])],t.prototype,"WeaponUI",void 0),a([h([cc.Node])],t.prototype,"DoubleBg",void 0),a([p],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./HQL2Const":"HQL2Const","./HQL2Fish":"HQL2Fish","./HQL2Manager":"HQL2Manager"}]},{},["HQL2Bill","HQL2Bullet","HQL2Coin","HQL2Const","HQL2Effect","HQL2EffectLayer","HQL2Fish","HQL2FishNet","HQL2Label","HQL2Loading","HQL2Manager","HQL2Menu","HQL2NetWork","HQL2Scene","HQL2User","HQL2Weapon"]);