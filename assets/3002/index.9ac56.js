window.__require=function e(t,o,n){function i(a,c){if(!o[a]){if(!t[a]){var r=a.split("/");if(r=r[r.length-1],!t[r]){var l="function"==typeof __require&&__require;if(!c&&l)return l(r,!0);if(s)return s(r,!0);throw new Error("Cannot find module '"+a+"'")}a=r}var h=o[a]={exports:{}};t[a][0].call(h.exports,function(e){return i(t[a][1][e]||e)},h,h.exports,e,t,o,n)}return o[a].exports}for(var s="function"==typeof __require&&__require,a=0;a<n.length;a++)i(n[a]);return i}({HQLBill:[function(e,t,o){"use strict";cc._RF.push(t,"2c73bmVTEZLtrkZXUkpTb1a","HQLBill");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./HQLManager"),c=cc._decorator,r=c.ccclass,l=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onLoad=function(){this.layer_min=this.node.getChildByName("layer_min"),this.sp_fish0=this.layer_min.getChildByName("sp_fish").getComponent(cc.Sprite),this.lb_gold0=this.layer_min.getChildByName("lb_gold").getComponent("HQLLabel"),this.an_fish=this.layer_min.getChildByName("an_fish").getComponent(cc.Animation),this.an_fish.on("finished",this.onFinishAnimate,this)},t.prototype.show=function(e){var t=this;this.param=e,this.node.active=!0,this.seatId=e.seatId,this.layer_min.active=!0,this.layer_min.scale=.8,a.default.once.playSFX("bill_min"),this.lb_gold0.string=e.award?a.default.once.GameLayer.changeGold(e.award):"";var o=a.default.once.getEffectByType("coloursEffect_");o.wrapMode=cc.WrapMode.Loop,this.an_fish.addClip(o),this.an_fish.play(o.name),this.scheduleOnce(function(){t.clean(),a.default.once.GameLayer.EffectLayer.onFinishEffect(t.param),a.default.once.GameLayer.despawnBill(t)},2)},t.prototype.onFinishAnimate=function(){},t.prototype.clean=function(){this.node.stopAllActions(),this.unscheduleAllCallbacks()},s([r],t)}(cc.Component));o.default=l,cc._RF.pop()},{"./HQLManager":"HQLManager"}],HQLBullet:[function(e,t,o){"use strict";cc._RF.push(t,"c2c6aNaUjdAhYdvbao2UwRO","HQLBullet");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./HQLConst"),c=e("./HQLFish"),r=e("./HQLManager"),l=cc._decorator,h=l.ccclass,p=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.seatId=0,t.bulletId=0,t.angle=0,t.level=0,t.collisionCount=0,t.initTime=0,t._lastUpdateTime=0,t.lockFishId=a.HQLConst.once.NotFound,t.radius=0,t}return i(t,e),t.prototype.registerMsg=function(){},t.prototype.unregisterMsg=function(){},t.prototype.onLoad=function(){this.node.zIndex=-1,this.sp=this.node.getComponent(cc.Sprite),this.node.setAnchorPoint(cc.v2(.5,1)),this.radius=a.HQLConst.once.BulletRadius,this.an_bullet=this.node.getComponent(cc.Animation)},t.prototype.init=function(e){var t=Date.now();this.initTime=t,this.seatId=e.seatId,this.bulletId=e.bulletId,this.bxy=null,this.isDrill=e.isDrill,this.boomWay=e.boomWay,this.boomPercent=e.boomPercent,this.angle=-e.angle,this.node.angle=e.angle,this.node.position=e.point,e.level<2&&(e.level=2),e.level>4&&(e.level=4),this.level=e.level,this.collisionCount=0,this._enableUpdate=!0,this.node.scale=1.46,this.node.active=!0,this.setLockFishID(e.lock),this.initInfo(),this._lastUpdateTime=this.initTime},t.prototype.initInfo=function(){this.level,this.level,this.node.setScale(1)},t.prototype.setLockFishID=function(e){this.lockFish=r.default.once.GameLayer.getLockFishByFishId(e),this.lockFish instanceof c.default?this.lockFishId=e:this.lockFishId=a.HQLConst.once.NotFound},t.prototype.setOutPosition=function(e){this.angle=e.angle,this.node.x+=e.x,this.node.y+=e.y},t.prototype.calculateDrillBoomPoint=function(){if(++this.collisionCount==this.boomWay&&this.isDrill){var e=cc.v2(this.node.x,this.node.y),t=cc.view.getVisibleSize(),o=Math.sin(this.angle/180*Math.PI),n=Math.cos(this.angle/180*Math.PI),i=o>0?t.width/2-e.x:-t.width/2-e.x,s=n>0?t.height/2-e.y:-t.height/2-e.y,c=a.HQLConst.once.BulletSpeed.x*o,r=a.HQLConst.once.BulletSpeed.y*n,l=Math.abs(i/c*this.boomPercent/100),h=Math.abs(s/r*this.boomPercent/100);e.x+=c*Math.min(l,h),e.y+=r*Math.min(l,h),this.bxy=e}},t.prototype.updatexxx=function(){if(this._enableUpdate){if(this.lockFish instanceof c.default){var e=this.lockFish.getWorldPoint(),t=this.node.convertToWorldSpaceAR(cc.v2(0,0));this.angle=r.default.once.convertPointToAngle(t,e)-90}var o=Date.now(),n=(o-this._lastUpdateTime)/1e3;this._lastUpdateTime=o;var i=r.default.once.calculateSpacePoint({angle:this.angle,space:n,speed:a.HQLConst.once.BulletSpeed});this.node.x+=i.x,this.node.y+=i.y;var s=r.default.once.convertPositionAngle({x:this.node.x,y:this.node.y,angle:this.angle});s.out?(this.clearLockID(),this.setOutPosition(s),this.calculateDrillBoomPoint()):this.checkDrillBoom(i.x,i.y),this.node.angle=-this.angle}},t.prototype.checkDrillBoom=function(e,t){if(this.bxy&&this.isDrill){var o=this.node.x>this.bxy.x&&e>0||this.node.x<this.bxy.x&&e<0,n=this.node.y>this.bxy.y&&t>0||this.node.y<this.bxy.y&&t<0;if(o||n){this.node.position=this.bxy;var i=this.node.convertToWorldSpaceAR(cc.v2(0,0)),s=a.HQLConst.once.IsDrillR*a.HQLConst.once.winScale.x,c=r.default.once.inCircleFishs(i,s);r.default.once.requestShotTarget(c.fishId,this.bulletId,3),this.lowerNet(!1)}}},t.prototype.beAttackFish=function(e){e instanceof c.default&&e.alive&&e.beAttack()},t.prototype.clearLockID=function(){this.setLockFishID(-1)},t.prototype.lowerNet=function(e,t){void 0===e&&(e=!0),this._enableUpdate=!1,e&&(t=t||this.node.convertToWorldSpaceAR(cc.v2(0,0)),r.default.once.GameLayer.addNet(t,this.level,this.node.angle,this.seatId)),this.an_bullet.currentClip&&this.an_bullet.removeClip(this.an_bullet.currentClip,!0),r.default.once.GameLayer.despawnBullet(this)},t.prototype.sendHitFishReqType=function(e){if(e instanceof c.default&&this.seatId===a.HQLConst.once.seatId){var t=this.isDrill?3:1;if(2==e.config.propFish&&(t=7,this.isDrill))return;var o=this.lockFish instanceof c.default?this.lockFish.fishId:null;r.default.once.requestShotTarget(e.fishId,this.bulletId,t,o)}},t.prototype.onCollision=function(e){var t=this.lockFishId===e.fishId;if((this._enableUpdate||t)&&(this.lockFishId===a.HQLConst.once.NotFound||t)){if(!this.isDrill){var o=t?e.getWorldPoint():null;this.lowerNet(!0,o)}this.sendHitFishReqType(e),this.beAttackFish(e)}},s([h],t)}(cc.Component));o.default=p,cc._RF.pop()},{"./HQLConst":"HQLConst","./HQLFish":"HQLFish","./HQLManager":"HQLManager"}],HQLCoin:[function(e,t,o){"use strict";cc._RF.push(t,"98dfbIrvvxHGKLhCK/laxCK","HQLCoin");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./HQLConst"),c=e("./HQLManager"),r=cc._decorator,l=r.ccclass,h=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onLoad=function(){this.sb_bg=this.node.getComponent(cc.Sprite),this.width=this.node.width},t.prototype.clean=function(){this.node.stopAllActions(),this.spIndex=0,this.time=-1,this.node.active=!1},t.prototype.init=function(e){var t=this;this.clean(),this.coinAtlas||(this.coinAtlas=c.default.once.getAtlasByType("coin")),this.node.active=!0,this.param=e,e.i;var o=e.position.x+60*e.i,n=e.position.y,i=cc.v2(o,n);this.node.setPosition(i);var s=e.i;this.node.setScale(.8),this.node.opacity=0;var r=cc.sequence(cc.fadeIn(.03),cc.moveBy(.12,cc.v2(0,110)).easing(cc.easeOut(3)),cc.moveBy(.1,cc.v2(0,-110)).easing(cc.easeIn(3))),l=cc.spawn(r,cc.scaleTo(.3,.8)),h=this.node.parent.convertToNodeSpaceAR(e.to),p=cc.v2((i.x+h.x)/2,i.y+50),d=cc.bezierTo(2,[i,p,h]),f=cc.spawn(d.easing(cc.easeOut(2)),cc.scaleTo(2,.7*.8)),u=cc.callFunc(function(){var t="gold_small";e.fid>9&&(t="gold"),e.fid>19&&(t="gold_big"),e.skillId>100&&(t="gold_effect"),c.default.once.playSFX(t)}),y=cc.callFunc(function(){c.default.once.playSFX("back")}),g=cc.callFunc(function(){0===s&&c.default.once.showCoinLbAction({position:h,award:e.award,self:e.self}),c.default.once.GameLayer.despawnCoin(t)}),L=[];s*=.07,L.push(cc.delayTime(s));var v=!e.skillId,m=e.self&&0===e.i;v&&m&&L.push(u),L.push(l),L.push(cc.delayTime(.7)),v&&m&&L.push(y),L.push(f),L.push(g),this.node.runAction(cc.sequence(L)),this.spIndex=e.i%2?-1:3,this.time=a.HQLConst.once.CoinRotationTime},t.prototype.update=function(e){-1!==this.time&&(this.time+=e,this.time>=a.HQLConst.once.CoinRotationTime)&&(this.time=0,++this.spIndex>=12&&(this.spIndex=0),this.param&&this.param.self,this.sb_bg.spriteFrame=this.coinAtlas.getSpriteFrame("gold5_"+this.spIndex))},s([l],t)}(cc.Component));o.default=h,cc._RF.pop()},{"./HQLConst":"HQLConst","./HQLManager":"HQLManager"}],HQLConst:[function(e,t,o){"use strict";var n;cc._RF.push(t,"f2619ccL2JLto/l/ch/M4C7","HQLConst"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameLoadType=o.HQLConst=o.HQLEffectType=o.HQLFireSpeed=o.HQLFishStatus=void 0,function(e){e[e.Die=0]="Die",e[e.Live=1]="Live"}(o.HQLFishStatus||(o.HQLFishStatus={})),function(e){e[e.Speed0=.2]="Speed0",e[e.Speed1=.1]="Speed1"}(n=o.HQLFireSpeed||(o.HQLFireSpeed={})),function(e){e[e.None=0]="None",e[e.Same=101]="Same",e[e.SmallBoom=103]="SmallBoom",e[e.CoinBoom=106]="CoinBoom",e[e.DragonSlayer=206]="DragonSlayer",e[e.BigBoom=104]="BigBoom",e[e.Double=105]="Double",e[e.Fast=100]="Fast",e[e.Bill=120]="Bill",e[e.Box=121]="Box"}(o.HQLEffectType||(o.HQLEffectType={}));var i=function(){function e(){this.NotFound=999999999,this.CoinRotationTime=.06,this.FishRedDuring=.15,this.NetMaxTime=.2,this.BulletSpeed={x:.6,y:.6},this.BoomR=200,this.IsDrillR=200,this.AutoLimit=n.Speed0,this.FightLimit=n.Speed0,this.WeaponHight=150,this.BorderCount=4,this.BulletRadius=25,this.FireCD=180,this.compensate=0,this.MapCompensate=new Map,this.IsDrill=!1,this.BombId="",this.Round=101,this.BulletCount=0,this.NetUp=0,this.NetDown=0,this.winScale=cc.v2(1,1),this.IsAuto=!1,this.IsLock=!1,this.HeartBeatCD=0,this.MapAtlas=new Map,this.MapSwims=new Map,this.MapDieanis=new Map,this.MapEffects=new Map,this.diamond=0,this.RoomBet=1,this.BLevel=0,this.BLevels=[1,2,5,10,20,50,100,200,500,1e3,2e3],this.CannonBets=[],this.seatId=-1,this.userId=-1,this.TableId=-1,this.Entries=0,this.Winning=0,this.users={},this.UIAtals=null}return Object.defineProperty(e,"once",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.destroyInstance=function(){e._instance&&(e._instance=null,delete e._instance)},e}();o.HQLConst=i,function(e){e[e.Sprite=0]="Sprite",e[e.Atlas=1]="Atlas",e[e.Skeleton=2]="Skeleton",e[e.ParticleAsset=3]="ParticleAsset",e[e.Prefab=4]="Prefab",e[e.Json=5]="Json"}(o.GameLoadType||(o.GameLoadType={})),cc._RF.pop()},{}],HQLEffectLayer:[function(e,t,o){"use strict";cc._RF.push(t,"5c0b3O7bcFJeZoWRh6tZrI+","HQLEffectLayer");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./HQLConst"),c=e("./HQLManager"),r=e("../../../Script/utils/Utils"),l=cc._decorator,h=l.ccclass,p=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.an_waves=null,t.lb_fire=null,t.layer_recharge=null,t.sk_haicao=null,t}return i(t,e),Object.defineProperty(t.prototype,"map_info",{get:function(){if(!this._map_info){this._map_info=new Map;for(var e=0;e<4;e++)this._map_info.set(e,[])}return this._map_info},set:function(e){this._map_info=e},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){this.initEvents()},t.prototype.initEvents=function(){this.lb_max=this.node.getChildByName("lb_max"),this.lb_ms=this.node.getChildByName("lb_ms").getComponent(cc.Label),this.an_waves.node.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(5,1.8,1.2),cc.delayTime(1),cc.scaleTo(5,1.5,1))));for(var e=this.node.parent.getChildByName("layer_qp"),t=cc.view.getVisibleSize(),o=function(o){var n=e.children[o].getComponent(sp.Skeleton);n.loop=!1,n.premultipliedAlpha=!0,n.enableBatch=!0,n.setAnimationCacheMode(dragonBones.ArmatureDisplay.AnimationCacheMode.SHARED_CACHE),n.setCompleteListener(function(){var e=r.default.randomNum(0,100,2)/100*t.width-t.width/2,o=r.default.randomNum(0,100,2)/100*t.height-t.height/2;n.timeScale=r.default.randomNum(.3,1.8,2);var i=r.default.randomNum(.2,1.2);n.node.setScale(i),n.node.setPosition(e,o),n.setAnimation(0,"animation",!1)}),n.setAnimation(0,"animation",!1)},n=0;n<e.children.length;n++)o(n)},t.prototype.showNetMs=function(){this.lb_ms.string="\u5ef6\u8fdf\uff1a"+(a.HQLConst.once.NetUp+a.HQLConst.once.NetDown)},t.prototype.prefixInteger=function(e,t){return(e/Math.pow(10,t)).toFixed(t).substr(2)},t.prototype.showLable=function(e){this.lb_fire.node.parent.active=e<-60;var t=Math.ceil(90+e)<0?0:Math.ceil(90+e);this.lb_fire.string="Since you have'nt fired in a minute, you will leave the game in "+t+" s"},t.prototype.showRecharge=function(){Common.showMessage("not enough balance")},t.prototype.onClickedCloseRechargeTip=function(){this.layer_recharge.active=!1,this.layer_recharge.opacity=255,this.layer_recharge.stopAllActions()},t.prototype.defaultLight=function(e){var t="0;0;1000".split(";"),o=t[0]||0,n=t[1]||0,i=e.convertToWorldSpaceAR(cc.v2(parseFloat(o+""),parseFloat(n+""))),s=t[2]||1500;this.initLight(i,s)},t.prototype.initLight=function(e,t){this.v2Light=e,this.lightHeight=parseFloat(t)},t.prototype.pushFishEffect=function(e,t,o,n){for(var i=0;i<e.length;i++){var s=r.default.deepCopy(o),a=e[i];a.alive&&(a.pushEffect(t,s),n&&s.fishId!==a.fishId&&(s.target=a.node.position,s.playSFX=0===i,s.end=i===e.length-1,c.default.once.GameLayer.addEffect(s)))}},t.prototype.addEffect=function(e){var t=this;if(cc.isValid(this.node)){var o=r.default.deepCopy(e);if(o.skillId!==a.HQLEffectType.SmallBoom&&o.skillId!==a.HQLEffectType.BigBoom&&o.skillId!==a.HQLEffectType.CoinBoom||c.default.once.GameLayer.addEffect(o),o.skillId===a.HQLEffectType.Fast){o.duringTime=o.time||2,this.pushFishEffect(c.default.once.GameLayer.getFishs(),a.HQLEffectType.Fast,o);var n=cc.view.getVisibleSize().width/2-20;this.sk_haicao.node.stopAllActions(),this.sk_haicao.node.active=!0,this.sk_haicao.paused=!1,this.sk_haicao.node.opacity=0;var i=-n-70,s=500/-i/2+2;i-=500;var l=cc.callFunc(function(){t.sk_haicao.node.setPosition(n,0),t.sk_haicao.node.opacity=255,c.default.once.GameLayer.changeSceneBg(o.now,o.anim,o.later)}),h=cc.callFunc(function(){t.sk_haicao.paused=!0,t.sk_haicao.node.active=!1,c.default.once.sendChangeScene()}),p=[cc.delayTime(o.duringTime),l,cc.moveTo(s,cc.v2(i,0)),h];this.sk_haicao.node.runAction(cc.sequence(p))}if(o.skillId===a.HQLEffectType.DragonSlayer){var d=Math.ceil(o.awards.length/4);c.default.once.playSFX("s206");for(var f=o.awards.length,u=0;u<f;u++){var y={award:o.awards[u],sum:d,i:u,skillId:a.HQLEffectType.DragonSlayer,angle:u/f*360,delay:u/f*.15};y.position=c.default.once.calculateSpacePoint({angle:y.angle,space:.03*u,speed:cc.v2(.2,.2)}),y.position.x+=o.position.x,y.position.y+=o.position.y,c.default.once.GameLayer.addEffect(y)}}if(o.skillId===a.HQLEffectType.Double&&(c.default.once.playSFX("double"),c.default.once.GameLayer.WeaponLayer.showDoubleByIndex(o.index,o.left)),o.skillId===a.HQLEffectType.Bill){o.index=c.default.once.tableConvertIndex(o.seatId),o.nid=r.default.generateMixed(20);var g=this.map_info.get(o.seatId)||[];o.position=c.default.once.GameLayer.WeaponLayer.getWeaponOutPositionByTid(o.seatId,0),o.position.y=o.index>1?o.position.y-138:o.position.y+138,o.limit=o.limit||o.type,g.push(o),this.map_info.set(o.seatId,g),this.checkPlayBill(o)}}},t.prototype.checkPlayBill=function(e){var t=this.map_info.get(e.seatId),o=function(e,t,o,n){for(var i=!0,s=0,a=0,c=0;c<e.length;c++)e[c].limit===t&&o!==e[c].nid&&(i=!1),e[c].limit===t&&s++,e[c].limit!==t||e[c].playing||a++;return i&&n||a===s&&0!==a};if(t)for(var n=0;n<t.length;n++){var i=t[n];o(t,i.limit,i.nid,!i.playing)&&(t[n].playing=!0,this.map_info.set(e.seatId,t),c.default.once.GameLayer.addBill(t[n]))}},t.prototype.onFinishEffect=function(e){if(-1!==[a.HQLEffectType.Bill].indexOf(e.skillId)){for(var t=this.map_info.get(e.seatId),o=0;o<t.length;o++)if(t[o].nid===e.nid){t.splice(o,1);break}this.map_info.set(e.seatId,t),this.checkPlayBill(e)}},t.prototype.updateShadowEffect=function(e,t){var o=e.x-this.v2Light.x,n=e.y-this.v2Light.y,i=cc.v2(0,0),s=e.sub(this.v2Light).mag(),a=(t+this.lightHeight)*s/this.lightHeight;return i.x=e.x+o*(a/s-1),i.y=e.y+n*(a/s-1),i},t.prototype.onDestroy=function(){},s([p(cc.Animation)],t.prototype,"an_waves",void 0),s([p(cc.Label)],t.prototype,"lb_fire",void 0),s([p(cc.Node)],t.prototype,"layer_recharge",void 0),s([p(sp.Skeleton)],t.prototype,"sk_haicao",void 0),s([h],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./HQLConst":"HQLConst","./HQLManager":"HQLManager"}],HQLEffect:[function(e,t,o){"use strict";cc._RF.push(t,"c4629PatGZG+L8PIQoVoJ3M","HQLEffect");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../../Script/utils/Utils"),c=e("./HQLConst"),r=e("./HQLManager"),l=cc._decorator,h=l.ccclass,p=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.registerMsg=function(){},t.prototype.unregisterMsg=function(){},Object.defineProperty(t.prototype,"sk_effect",{get:function(){return this._sk_effect||this.initSkeleton(),this._sk_effect},set:function(e){this._sk_effect=e},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){this.an_effect=this.node.getChildByName("sp_effect").addComponent(cc.Animation),this.an_effect.on("finished",this.onFinishAnimate,this),this.node_effect=this.node.getChildByName("sk_effect"),this.sp_effect=this.node.getChildByName("sp_effect").getComponent(cc.Sprite),this.sp_bg=this.node.getChildByName("sp_bg").getComponent(cc.Sprite),this.sp_bg.node.on("click",this.onClickedEffect,this)},t.prototype.initSkeleton=function(){this.node_effect.parent=this.node,this.node_effect.scale=1,this._sk_effect=this.node_effect.addComponent(sp.Skeleton),this._sk_effect.premultipliedAlpha=!1,this._sk_effect.enableBatch=!0,this._sk_effect.setAnimationCacheMode(dragonBones.ArmatureDisplay.AnimationCacheMode.SHARED_CACHE),this._sk_effect.setCompleteListener(this.onFinishAnimate.bind(this)),this.node_effect.color=cc.Color.WHITE,this.node_effect.setPosition(0,0)},t.prototype.init=function(e){var t=this;if(this.node.position=e.position||cc.v2(0,0),this.node.angle=0,this.node.active=!0,this.node.zIndex=0,this.param=e,this.node.scale=1,this.node.opacity=255,this.sp_effect.spriteFrame=null,this.sp_bg.spriteFrame=null,this.sp_bg.node.setPosition(0,0),e.skillId===c.HQLEffectType.DragonSlayer){var o;this.node.x+=this.node.width/2,this.node.zIndex=110,(o=r.default.once.getSwimAnimateByID("30")).wrapMode=cc.WrapMode.Loop,this.an_effect.addClip(o),this.an_effect.play(o.name),this.node.opacity=0,this.node.scale=1,this.node.angle=-e.angle,this.node.angle-=90;var n=cc.view.getVisibleSize(),i=Math.sqrt(Math.pow(n.height/1.5,2)+Math.pow(n.width/1.5,2))+60,s=i*Math.sin(e.angle/180*Math.PI),l=i*Math.cos(e.angle/180*Math.PI),h=(Math.floor(e.i/e.sum),Math.floor(e.i%e.sum)),p=n.width/2;p=h*n.width/e.sum-p+1.3*this.node.width,p+=a.default.randomNum(50,200),a.default.randomNum(.01,.6,4);var d=[cc.delayTime(e.delay),cc.fadeIn(.2),cc.delayTime(.3),cc.moveTo(1.5,cc.v2(s,l)),cc.callFunc(function(){t.onFinishEffect()})];this.node.runAction(cc.sequence(d))}return e.skillId==c.HQLEffectType.SmallBoom||e.skillId==c.HQLEffectType.BigBoom?(this.node.scale=1.6,(o=r.default.once.getEffectByType("bombEffect_")).wrapMode=cc.WrapMode.Normal,this.an_effect.addClip(o),void this.an_effect.play(o.name)):e.skillId==c.HQLEffectType.CoinBoom?(this.node.scale=2.5,(o=r.default.once.getEffectByType("coinEffect_")).wrapMode=cc.WrapMode.Normal,this.an_effect.addClip(o),void this.an_effect.play(o.name)):void 0},t.prototype.onFinishAnimate=function(){this.onFinishEffect()},t.prototype.onFinishEffect=function(){r.default.once.GameLayer.EffectLayer.onFinishEffect(this.param),r.default.once.GameLayer.despawnEffect(this)},t.prototype.onClickedEffect=function(){this.param&&this.param.clicked},t.prototype.update=function(){this._sk_effect&&this._sk_effect.node&&(this._sk_effect.node.position=this.node.position)},t.prototype.clean=function(){this.unscheduleAllCallbacks(),this.node.stopAllActions(),this.an_effect.node.stopAllActions(),this.sp_bg.spriteFrame=null,this.param&&(this.param.clicked=!0);var e=this.an_effect.currentClip;e&&this.an_effect.removeClip(e,!0),this.sk_effect&&(this.sk_effect.paused=!0,this.sk_effect.destroy(),this.sk_effect=null),this.node_effect.removeComponent(sp.Skeleton),this.node_effect.parent=this.node,this.node_effect.setPosition(0,0)},s([h],t)}(cc.Component));o.default=p,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./HQLConst":"HQLConst","./HQLManager":"HQLManager"}],HQLFishNet:[function(e,t,o){"use strict";cc._RF.push(t,"1f6832EMpVGlI/Qg+0j9wUq","HQLFishNet");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./HQLConst"),c=e("./HQLManager"),r=cc._decorator,l=r.ccclass,h=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.netRedius=70,t}return i(t,e),t.prototype.onLoad=function(){this.sp_net=this.node.getComponent(cc.Sprite),this.an_net=this.node.getComponent(cc.Animation);var e=c.default.once.getEffectByType("blast1_");e.wrapMode=cc.WrapMode.Normal,this.an_net.addClip(e)},t.prototype.onFinishNet=function(){c.default.once.GameLayer?c.default.once.GameLayer.despawnNet(this):this.node.destroy()},t.prototype.init=function(e,t,o,n){var i=this;this.node.position=this.node.parent.convertToNodeSpaceAR(e),this.node.active=!0,this.node.angle=o,this.sp_net.spriteFrame=null,this.node.opacity=255;var s=[];2==t&&(s=[0,1]),3==t&&(s=[0,1,2]),4==t&&(s=[0,1,2,3]);var r=c.default.once.tableConvertIndex(n),l=c.default.once.GameLayer.WeaponLayer.DoubleBg[r].active;l&&(s=[],this.an_net.play("blast1_"),this.an_net.once("finished",function(){i.onFinishNet()}));for(var h=0;h<this.node.children.length;h++)this.node.children[h].active=-1!=s.indexOf(h);if(!l){2==t&&(this.node.children[0].setPosition(30,0),this.node.children[1].setPosition(-30,0)),3==t&&(this.node.children[0].setPosition(40,0),this.node.children[1].setPosition(-40,0),this.node.children[2].setPosition(0,0)),4==t&&(this.node.children[0].setPosition(30,-30),this.node.children[1].setPosition(-30,30),this.node.children[2].setPosition(30,30),this.node.children[3].setPosition(-30,-30));var p=2*this.netRedius;this.node.width=p,this.node.height=p,this.node.scale=2;var d=[],f=cc.scaleTo(a.HQLConst.once.NetMaxTime,1.2);d.push(f);var u=cc.scaleTo(2*a.HQLConst.once.NetMaxTime/3,1);d.push(u),d.push(cc.fadeOut(.1));var y=cc.callFunc(this.onFinishNet.bind(this));d.push(y),this.node.runAction(cc.sequence(d))}},s([l],t)}(cc.Component));o.default=h,cc._RF.pop()},{"./HQLConst":"HQLConst","./HQLManager":"HQLManager"}],HQLFish:[function(e,t,o){"use strict";cc._RF.push(t,"53fa12tX5xK961MXlswbxVO","HQLFish");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./HQLConst"),c=e("./HQLManager"),r=cc._decorator,l=r.ccclass,h=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fid=-1,t.fishId=-1,t.index=-1,t._state=a.HQLFishStatus.Die,t._outBorder=!1,t.skillId=-1,t.enbaleMove=!0,t.lastPosition=null,t.initTime=0,t._lastUpdateTime=0,t.swimTime=10,t.leaveTime=0,t.mapEffects=new Map,t.radius=0,t}return i(t,e),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){this._state=e,this.checkLock()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outBorder",{get:function(){return this._outBorder},set:function(e){this._outBorder=e,this.checkLock()},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){this.initView()},t.prototype.initView=function(){this.sp_fish=this.node.getChildByName("sp_fish").getComponent(cc.Sprite),this.sp_effect=this.node.getChildByName("sp_effect").getComponent(cc.Sprite),this.sp_shadow=this.node.getChildByName("sp_shadow").getComponent(cc.Sprite),this.an_fish=this.sp_fish.node.getComponent(cc.Animation),this.an_fish.on("finished",this.onFinishAnimate,this),this.btn_click=this.node.getChildByName("click"),this.btn_click.on(cc.Node.EventType.TOUCH_START,this.onClickFish,this)},t.prototype.onClickFish=function(e){c.default.once.GameLayer.WeaponLayer.onTouchStart(e,this)},t.prototype.init=function(e){this.node.active=!0,this.flipY=a.HQLConst.once.seatId>1,this.fid=e.fid,this.fishId=e.fishId,this.index=e.index,this.skillId=e.skillId,this.swimTime=e.pathInterval,this.initTime=Date.now()-e.compensate-1e3*e.swimmingInterval,this.config=e.config,this.FishPath=e.FishPath;var t=e.groups.points[this.index];this.gpoint=cc.v2(e.groups.origin.x+t.x,e.groups.origin.y+t.y),this.colliders=e.conlliderPoints,this.resetInfo();var o=e.swimAni;if(o.wrapMode=cc.WrapMode.Loop,this.an_fish.addClip(o),this.an_fish.play(o.name),this.sp_effect.node.active=28==e.config.fishType||27==e.config.fishType||2==e.config.propFish,this.sp_effect.node.active){var n=c.default.once.getFishLayerIndex(e.fid),i=2==e.config.propFish?"bg_1":"bg_0",s=2!=e.config.propFish;this.sp_effect.node.setScale(1);var r=c.default.once.GameLayer.LoadingLayer.fishs[n];this.sp_effect.node.rotation=0,this.sp_effect.spriteFrame=r.getSpriteFrame(i),s&&this.sp_effect.node.runAction(cc.repeatForever(cc.rotateBy(2,360)))}this.node.runAction(cc.fadeIn(.1))},t.prototype.getColliderPoints=function(){for(var e=this.node.convertToWorldSpaceAR(cc.v2(0,0)),t=[],o=0;o<this.colliders.length;o++)t.push(cc.v2(e.x+1.1*this.colliders[o].x,e.y+1.1*this.colliders[o].y));return{ws:t,zIndex:this.node.zIndex}},t.prototype.resetInfo=function(){this.sp_fish.spriteFrame=null,this.sp_shadow.spriteFrame=null,this.node.opacity=0,this.sp_fish.node.color=cc.Color.WHITE,this._lastUpdateTime=Date.now(),this.setState(a.HQLFishStatus.Live),this.outBorder=c.default.once.checkLimitBorder(this.node),this.cleanLockWeapons(),this.enbaleMove=!0,this.mapEffects=null,this.mapEffects=new Map,this.node.zIndex=parseFloat(this.config.Layer||0),this.leaveTime=this.swimTime,this.node.angle=this.FishPath.scale<0?180:0;var e=parseFloat(this.config.Scale),t=this.FishPath.scale*parseFloat(this.config.Scale);this.sp_fish.node.setScale(e,t),this.sp_shadow.node.setScale(e,t);for(var o=c.default.once.convertWindowScale(),n=0;n<this.colliders.length;n++){var i=this.colliders[n],s=i.x*e*o.x,r=i.y*t*o.y;this.radius=Math.max(this.radius,cc.v2(s,r).mag())}this.lastPosition=cc.v2(this.FishPath.points[0].x,this.FishPath.points[0].y),this.node.setPosition(this.lastPosition.x,this.lastPosition.y)},t.prototype.animateFrameChange=function(){this.setShadowSpriteFrame()},t.prototype.getShadowWorldPoint=function(){return this.sp_shadow.node.convertToWorldSpaceAR(cc.v2(0,0))},t.prototype.getWorldPoint=function(){return this.node.convertToWorldSpaceAR(cc.v2(0,0))},t.prototype.setShadowSpriteFrame=function(){if(this.sp_shadow.spriteFrame!=this.sp_fish.spriteFrame){var e=2!=this.config.propFish&&this.sp_effect.node.active?.5:1;this.sp_shadow.node.scaleX=e*this.sp_shadow.node.scaleX,this.sp_shadow.node.scaleY=e*this.sp_shadow.node.scaleY,this.sp_shadow.spriteFrame=this.sp_effect.node.active?this.sp_effect.spriteFrame:this.sp_fish.spriteFrame,this.btn_click.width=this.sp_shadow.node.width,this.btn_click.height=this.sp_shadow.node.height,21==this.fid&&(this.btn_click.width=700,this.btn_click.height=150),22==this.fid&&(this.btn_click.width=400,this.btn_click.height=180),18!=this.fid&&19!=this.fid&&20!=this.fid||(this.btn_click.width=450,this.btn_click.height=115)}},t.prototype.updateShadowEffect=function(){var e=this.node.convertToWorldSpaceAR(cc.v2(0,0)),t=c.default.once.GameLayer.EffectLayer.updateShadowEffect(e,parseFloat(this.config.Layer)),o=this.sp_shadow.node.parent.convertToNodeSpaceAR(t);this.sp_shadow.node.setPosition(o.x,o.y),this.setShadowSpriteFrame()},t.prototype.getSwimF=function(e){return e-this.initTime},t.prototype.pushEffect=function(e,t){if(e===a.HQLEffectType.Fast){var o=this.leaveTime/t.duringTime;this.mapEffects.set(e,o)}},t.prototype.runCurrent=function(e,t){e.currentClip&&e[t](e.currentClip.name)},t.prototype.popEffect=function(e){this.mapEffects.get(e)&&this.mapEffects.delete(e)},t.prototype.setState=function(e){this.state=e},t.prototype.onFinishAnimate=function(){var e=this.an_fish.currentClip;e&&-1!==e.name.indexOf("die")&&this.despawnFish()},t.prototype.pushLockSeat=function(e){return-1===this.lockWeapons.indexOf(e)&&(this.lockWeapons.push(e),!0)},t.prototype.popLockTid=function(e){var t=this.lockWeapons.indexOf(e);-1!==t&&this.lockWeapons.splice(t,1)},t.prototype.cleanLockWeapons=function(){this.lockWeapons=[]},t.prototype.calculateFPoint=function(e){if(e<=1){var t=c.default.once.makeBreakBezier2(e,this.FishPath.points,this.FishPath.controls),o=t.y+this.gpoint.y;this.flipY&&(o=-o);var n=this.gpoint.x+t.x;return cc.v2(n*a.HQLConst.once.winScale.x,o*a.HQLConst.once.winScale.y)}return cc.v2(1e5,1e5)},t.prototype.updateDegree=function(){var e=cc.v2(this.node.x,this.node.y),t=c.default.once.convertPointToAngle(e,this.lastPosition);this.node.angle=-t,this.lastPosition=e},t.prototype.beAttack=function(){var e=this;this.sp_fish.node.color=cc.Color.BLACK.fromHEX("#FD8484"),this.node.stopActionByTag(a.HQLConst.once.FishAttackAniTag);var t=cc.sequence([cc.delayTime(a.HQLConst.once.FishRedDuring),cc.callFunc(function(){e.sp_fish.node.color=cc.Color.WHITE})]);t.setTag(a.HQLConst.once.FishAttackAniTag),this.node.runAction(t)},t.prototype.playDieAni=function(){var e=c.default.once.getDeathAnimateByID(this.fid);e.wrapMode=cc.WrapMode.Normal,this.an_fish.stop(),this.an_fish.removeClip(this.an_fish.currentClip),this.an_fish.addClip(e),this.an_fish.play(e.name)},t.prototype.goDie=function(){this.enbaleMove=!1,this.setState(a.HQLFishStatus.Die)},Object.defineProperty(t.prototype,"alive",{get:function(){return this.state===a.HQLFishStatus.Live},enumerable:!1,configurable:!0}),t.prototype.checkDespawn=function(){this.leaveTime<0&&this.despawnFish()},t.prototype.clearLock=function(){c.default.once.GameLayer.clearLockFishAllBullet(this.fishId),c.default.once.GameLayer.WeaponLayer.cleanFishAllWeaponLock(this),this.cleanLockWeapons()},t.prototype.despawnFish=function(){this.sp_effect.node.stopAllActions(),this.clearLock(),this.unscheduleAllCallbacks(),this.mapEffects=new Map;var e=this.an_fish.getClips();if(e)for(var t=0;t<e.length;t++)this.an_fish.removeClip(e[t],!0);this.node.active=!1,c.default.once.GameLayer?c.default.once.GameLayer.despawnFish(this):this.node.destroy()},t.prototype.checkLock=function(){this.outBorder&&this.alive||this.clearLock()},t.prototype.updateEffect=function(e){var t=this,o=e;return this.mapEffects.size<=0?o:(this.mapEffects.forEach(function(e,n){var i=t.mapEffects.get(n);n===a.HQLEffectType.Fast&&(o*=i)}),o)},t.prototype.updatexxx=function(e){if(-1!==this.fid){var t=this.updateEffect(e);if(this.enbaleMove){var o=this.updateTime(t);this.updatePonint(o)}this.lastPosition.sub(cc.v2(this.node.x,this.node.y)).mag()>2&&("1"===this.config.Rotation&&this.updateDegree(),this.updateShadowEffect()),this.outBorder=c.default.once.checkLimitBorder(this.node),this.updateLockWeapon()}},t.prototype.updateTime=function(e,t){void 0===t&&(t=!0);var o=this._lastUpdateTime+1e3*e;t&&(this._lastUpdateTime=o);var n=this.getSwimF(o)/1e3;return this.leaveTime=this.swimTime-n,n/this.swimTime},t.prototype.updatePonint=function(e){if(e<=1){var t=this.calculateFPoint(e);this.node.x=t.x,this.node.y=t.y}else this.checkDespawn()},t.prototype.updateLockWeapon=function(){this.lockWeapons.length>0&&c.default.once.showLockLineByTid(this,this.lockWeapons)},t.prototype.onDestroy=function(){},s([l],t)}(cc.Component));o.default=h,cc._RF.pop()},{"./HQLConst":"HQLConst","./HQLManager":"HQLManager"}],HQLLabel:[function(e,t){"use strict";cc._RF.push(t,"97561Wm34ZMMrBnUN9Yq0oj","HQLLabel");var o=cc.Enum({LEFT:0,CENTER:1,RIGHT:2});cc.Class({editor:!1,extends:cc.Component,properties:{_layout:{get:function(){var e=this.node.getComponent(cc.Layout);return e||((e=this.node.addComponent(cc.Layout)).type=1),e}},string:{default:"",notify:function(){this._updateWordArt()}},alignType:{type:o,default:o.CENTER,notify:function(){this._checkAnchorX()}},defaultNames:{default:"2"},spriteAtlas:{type:cc.SpriteAtlas,default:null}},onLoad:function(){this._checkAnchorX()},_checkAnchorX:function(){this.alignType===o.CENTER?this.node.anchorX=.5:this.node.anchorX=this.alignType===o.RIGHT?1:0},_updateWordArt:function(){if(!this.spriteAtlas)return cc.log("\u65e0\u6548\u7684 spriteAtlas \u56fe\u96c6\u8d44\u6e90\uff01");this._names=this.defaultNames.split(","),this.setWordArt()},setWordArt:function(){try{for(var e=(""+this.string).split(""),t=this.node.children,n=0,i=0;i<e.length||i<t.length;i++){var s=t[i];if(s||((s=new cc.Node).anchorY=0,s.y=-12,(a=s.addComponent(cc.Sprite)).trim=!0,a.sizeMode=cc.Sprite.SizeMode.TRIMMED,a.type=cc.Sprite.Type.SIMPLE),s.parent||(s.parent=this.node),s.active=i<e.length,s.active){var a=s.getComponent(cc.Sprite),c=e[this.alignType!==o.CENTER?e.length-1-i:i];if(c=this._names[0]+c,this._names[1]&&(c+=this._names[1]),void 0===c)return void cc.log("\u56fe\u96c6\u8d44\u6e90spriteAtlas \u627e\u4e0d\u5230\u56fe\u7247\u540d\u79f0\uff1a"+c+"\uff01");a.spriteFrame=this.spriteAtlas.getSpriteFrame(""+c),n+=s.width}}n+=(e.length+1)*this._layout.spacingX,this._layout.paddingLeft=this._layout.spacingX,this._layout.paddingRight=this._layout.spacingX,this.node.width=n,this.alignType===o.RIGHT&&(this._layout.horizontalDirection=1),this.alignType===o.LEFT&&(this._layout.horizontalDirection=1),this.alignType===o.CENTER&&(this._layout.horizontalDirection=0)}catch(r){console.log(r)}}}),cc._RF.pop()},{}],HQLLoading:[function(e,t,o){"use strict";cc._RF.push(t,"dc2bfqfDOxO95TzaRPe824W","HQLLoading");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../../Script/utils/Utils"),c=e("./HQLConst"),r=cc._decorator,l=r.ccclass,h=r.property,p=function(t){function o(){var e=null!==t&&t.apply(this,arguments)||this;return e.click=null,e.back=null,e.bill_min=null,e.die=null,e.die_big=null,e.die_small=null,e.effect_108=null,e.gold=null,e.gold_effect=null,e.gold_small=null,e.lock=null,e.weapon_change=null,e.v1=null,e.v2=null,e.v3=null,e.v4=null,e.v5=null,e.v6=null,e.v7=null,e.v8=null,e.v9=null,e.bg0=null,e.bg1=null,e.bg2=null,e.configs=[],e.fishs=[],e.effectArr=[],e.ui=null,e.coin=null,e.font=null,e}return i(o,t),o.prototype.onLoad=function(){c.HQLConst.once.PlayerInfo=e("PlayerInfo").getInstant,c.HQLConst.once.RoomBet=c.HQLConst.once.PlayerInfo.RoomBet,c.HQLConst.once.PlayerInfo.fishBetList&&(c.HQLConst.once.BLevels=c.HQLConst.once.PlayerInfo.fishBetList),this.loadFinish()},o.prototype.loadFinish=function(){c.HQLConst.once.FishConfigs=this.configs[1].json;var e=this.configs[2].json.data;c.HQLConst.once.FishPath=e;var t=this.configs[0].json;c.HQLConst.once.FishGroups=t.data,c.HQLConst.once.FishPoints=this.configs[3].json;var o=[],n=[],i=[{key:"blast1_",space:20},"effect0_","effect1_","effect2_","effect3_","auto_","lock_","wave1_",{key:"coinEffect_",space:20},{key:"bombEffect_",space:20},"iceEffect_",{key:"coloursEffect_",space:10}],s=[],a=["ui","coin","font"];c.HQLConst.once.UIAtals=this.ui;for(var r=0;r<this.fishs.length;r++)this.fishs[r]instanceof cc.SpriteAtlas&&o.push(this.fishs[r].getSpriteFrames());for(r=0;r<this.effectArr.length;r++)this.effectArr[r]instanceof cc.SpriteAtlas&&n.push(this.effectArr[r].getSpriteFrames());for(r=0;r<s.length;r++){var l=s[r];c.HQLConst.once.MapEffects.set(l,this[l])}for(r=0;r<a.length;r++)l=a[r],c.HQLConst.once.MapAtlas.set(l,this[l]);var h=c.HQLConst.once.FishConfigs;for(r=0;r<h.length;r++){var p=h[r],d=(l=p.FishID,"1"===p.AnimType?c.GameLoadType.Skeleton:c.GameLoadType.Atlas);if(d===c.GameLoadType.Atlas){p.SwimActFPS=parseInt(p.SwimActFPS);var f=this.getAni(o,l+"_",d,cc.WrapMode.Loop,p.SwimActFPS);c.HQLConst.once.MapSwims.set(l,f);var u="1"===p.DeadAct?"die"+l+"_":l+"_",y=this.getAni(o,u,d,cc.WrapMode.Loop,2*p.SwimActFPS,null,1);y.name="die"+l+"_",c.HQLConst.once.MapDieanis.set(l,y)}else f="sk_"+l,c.HQLConst.once.MapSwims.set(l,this[f])}for(r=0;r<i.length;r++){var g=i[r],L=(l="string"==typeof g?g:g.key,g.space||10),v=this.getAni(n,l,c.GameLoadType.Atlas,cc.WrapMode.Default,L);c.HQLConst.once.MapEffects.set(l,v)}},o.prototype.convertVectorToPoint=function(e,t,o){return cc.v2(e.x+-(e.x-t.x)*o,e.y+-(e.y-t.y)*o)},o.prototype.makeBreakBezier2=function(e,t,o){if(t&&t.length){if(e<=0)return t[0];if(e>=1)return t[t.length-1];for(var n=0,i=this.cheekVectorOrTimeIndex(t,e,!0),s=[t[i.index-1],o[i.index-1],t[i.index]];n<1e3;){n++;for(var a=s.length-1,c=0;c<a;c++)if(s[c]=this.convertVectorToPoint(s[c],s[c+1],i.f),c===a-1&&(s.splice(a,s.length),1===s.length))return s[0]}}},o.prototype.cheekVectorOrTimeIndex=function(e,t,o){for(var n=0,i=[],s=1;s<e.length;s++){var a=100;if(!o){var c=e[s-1],r=e[s];a=Math.pow(r.x-c.x,2)+Math.pow(r.y-c.y,2),a=Math.sqrt(a)}i.push(a),n+=a}var l=0,h=0;for(s=0;s<i.length;s++){h=s+1;var p=n*t,d=l+(a=i[s]);if(l<p&&p<=d)return{index:h,f:1-(d-p)/a};l=d}return null},o.prototype.desArray=function(e,t){void 0===t&&(t=[]);var o=t.concat(["die"]);return e.sort(function(e,t){for(var n=e.name,i="",s=0;s<o.length;s++)if(-1!==n.indexOf(o[s])){i=o[s];break}var a=n.split(i);n=a[a.length-1];var c=t.name,r=c.split(i);c=r[r.length-1];var l=Math.ceil(n),h=Math.ceil(c);return l>h?1:l<h?-1:0}),e},o.prototype.findArrayFile=function(e,t,o){for(var n=[],i=null,s=0;s<e.length;s++){var r=e[s];if(o===c.GameLoadType.Atlas)if(r instanceof Array)for(var l=0;l<r.length;l++){var h=r[l],p=h.name.split(t);this.same(t,h.name)&&""==p[0]&&a.default.isNumber(p[1])&&n.push(h)}else this.same(t,r.name)&&(p=r.name.split(t),a.default.isNumber(p[1])&&""==p[0]&&n.push(r));else r.name&&-1!==r.name.indexOf(t)&&(i=r)}return o===c.GameLoadType.Atlas?n:i},o.prototype.same=function(e,t){e=e.split(""),t=t.split("");for(var o=0;o<e.length;o++)if(e[o]!=t[o])return!1;return!0},o.prototype.getAni=function(e,t,o,n,i,s,c){void 0===n&&(n=cc.WrapMode.Loop),void 0===s&&(s=null),void 0===c&&(c=1),i=i||10;var r=this.findArrayFile(e,t,o);if(r=this.desArray(r,[t]),1!==c){for(var l=[],h=0;h<c;h++)for(var p=0;p<r.length;p++)l.push(r[p]);r=l}var d=a.default.createWithSpriteFrames(r,i,"animateFrameChange",s);return d.name=t,d.wrapMode=n,d},s([h(cc.AudioClip)],o.prototype,"click",void 0),s([h(cc.AudioClip)],o.prototype,"back",void 0),s([h(cc.AudioClip)],o.prototype,"bill_min",void 0),s([h(cc.AudioClip)],o.prototype,"die",void 0),s([h(cc.AudioClip)],o.prototype,"die_big",void 0),s([h(cc.AudioClip)],o.prototype,"die_small",void 0),s([h(cc.AudioClip)],o.prototype,"effect_108",void 0),s([h(cc.AudioClip)],o.prototype,"gold",void 0),s([h(cc.AudioClip)],o.prototype,"gold_effect",void 0),s([h(cc.AudioClip)],o.prototype,"gold_small",void 0),s([h(cc.AudioClip)],o.prototype,"lock",void 0),s([h(cc.AudioClip)],o.prototype,"weapon_change",void 0),s([h(cc.AudioClip)],o.prototype,"v1",void 0),s([h(cc.AudioClip)],o.prototype,"v2",void 0),s([h(cc.AudioClip)],o.prototype,"v3",void 0),s([h(cc.AudioClip)],o.prototype,"v4",void 0),s([h(cc.AudioClip)],o.prototype,"v5",void 0),s([h(cc.AudioClip)],o.prototype,"v6",void 0),s([h(cc.AudioClip)],o.prototype,"v7",void 0),s([h(cc.AudioClip)],o.prototype,"v8",void 0),s([h(cc.AudioClip)],o.prototype,"v9",void 0),s([h(cc.AudioClip)],o.prototype,"bg0",void 0),s([h(cc.AudioClip)],o.prototype,"bg1",void 0),s([h(cc.AudioClip)],o.prototype,"bg2",void 0),s([h([cc.JsonAsset])],o.prototype,"configs",void 0),s([h([cc.SpriteAtlas])],o.prototype,"fishs",void 0),s([h([cc.SpriteAtlas])],o.prototype,"effectArr",void 0),s([h(cc.SpriteAtlas)],o.prototype,"ui",void 0),s([h(cc.SpriteAtlas)],o.prototype,"coin",void 0),s([h(cc.SpriteAtlas)],o.prototype,"font",void 0),s([l],o)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./HQLConst":"HQLConst",PlayerInfo:void 0}],HQLManager:[function(e,t,o){"use strict";cc._RF.push(t,"f98f753eExDx6FdhvEmT1ms","HQLManager");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./HQLConst"),c=e("./HQLScene"),r=e("./HQLFish"),l=e("./HQLBullet"),h=e("../../../Script/utils/Utils"),p=e("./HQLNetWork"),d=cc._decorator,f=d.ccclass,u=d.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.GameLayer=null,t.MusicDic={},t}var o;return i(t,e),o=t,Object.defineProperty(t,"once",{get:function(){return o.instance||(o.instance=new o),o.instance},enumerable:!1,configurable:!0}),t.destroyInstance=function(){o.instance&&(o.instance=null)},t.prototype.showNetError=function(e){cc.isValid(o.once.GameLayer.node)&&(o.once.GameLayer.MenuLayer.LayerNetError.active=e,a.HQLConst.once.IsAuto&&this.GameLayer.MenuLayer.onClickedAuto(!1))},t.prototype.requestFishFire=function(e,t){var o=a.HQLConst.once.BLevels[a.HQLConst.once.BLevel],n=o*a.HQLConst.once.RoomBet,i=this.codePoint(e),s={userid:a.HQLConst.once.userId,bet:o,position:i,bulletId:h.default.generateMixed(20),isDrill:a.HQLConst.once.IsDrill};a.HQLConst.once.IsDrill?(s.bulletId=a.HQLConst.once.BombId,s.boomWay=10,s.boomPercent=50):t&&(s.fishId=t),n<=a.HQLConst.once.Entries?(this.ShotSelfBullet(s),p.default.once.send("fishShoot",s),a.HQLConst.once.IsDrill=!1):(a.HQLConst.once.IsLock&&this.GameLayer.MenuLayer.onClickedLock(),a.HQLConst.once.IsAuto&&this.GameLayer.MenuLayer.onClickedAuto(),this.GameLayer.EffectLayer.showRecharge(!0))},t.prototype.requestLeaveRoom=function(){p.default.once.requestLeaveRoom()},t.prototype.requestRechargeAll=function(){var e=this.getUser();e&&e.wins&&e.wins>10&&p.default.once.send("chargeAll",JSON.stringify({}))},t.prototype.requestRechargeSum=function(e){var t=this.getUser();t&&t.wins&&t.wins>e&&p.default.once.send("chargeAll",{sum:e})},t.prototype.heartBeat=function(){p.default.once.send("heart_beat",{})},t.prototype.requestShotTarget=function(e,t,o,n,i){void 0===o&&(o=1),void 0===i&&(i=!1);var s={uid:a.HQLConst.once.userId,fishId:e,bulletId:t,bulletType:o};n&&(s.lockFishId=n),i&&(cc.log("fishHit----3---\x3e"+JSON.stringify(s)),s.format=1),cc.log("requestShotTarget:"+JSON.stringify(s)),p.default.once.send("fishHit",s)},t.prototype.requestChangeCannonBet=function(e){p.default.once.send("changePower",e)},t.prototype.CmdHQLLordSettle=function(e){if(cc.log("CmdHQLLordSettle: "+JSON.stringify(e)),e.bonus){e.bonus*=a.HQLConst.once.RoomBet;var t=this.userConvertSeatId(e.userId);o.once.GameLayer.EffectLayer.addEffect({seatId:t,award:e.bonus,skillId:a.HQLEffectType.Bill})}},t.prototype.rechargeAllResult=function(e){var t=this.userConvertSeatId(e.userId);a.HQLConst.once.users[t].score=e.score,a.HQLConst.once.users[t].wins=e.wins,e.userId==a.HQLConst.once.userId&&(this.GameLayer.showRecharge(!0),a.HQLConst.once.Entries=e.score,a.HQLConst.once.Winning=e.wins),this.GameLayer.updateBalance(e.userId,e.score),this.GameLayer.updateDiamond(e.userId,e.wins)},t.prototype.CmdHQLLord=function(e){cc.log("CmdHQLLord: "+JSON.stringify(e));var t=this.userConvertIndex(e.userId);this.GameLayer.EffectLayer.addEffect({skillId:a.HQLEffectType.Double,index:t,left:30})},t.prototype.CmdHQLSmallBomb=function(e){cc.log("CmdHQLSmallBomb: "+JSON.stringify(e));var t=e.position;this.GameLayer.EffectLayer.addEffect({skillId:a.HQLEffectType.SmallBoom,position:t});var o=a.HQLConst.once.BoomR*a.HQLConst.once.winScale.x,n=this.inCircleFishs(e.point,o);e.seatId===a.HQLConst.once.seatId&&n.fishId.length>0&&(cc.log("inCircleFishs:"+JSON.stringify(n.fishId)),this.requestShotTarget(n.fishId,e.bombId,3))},t.prototype.CmdHQLDragonSlayer=function(e){var t=this;cc.log("CmdHQLDragonSlayer: "+JSON.stringify(e));var o=e.position,n=h.default.ranAllo(100,1,50,24);if(this.GameLayer.EffectLayer.addEffect({skillId:a.HQLEffectType.DragonSlayer,position:o,awards:n}),e.seatId===a.HQLConst.once.seatId){for(var i=this.GameLayer.getFishs(),s=[],c=0;c<i.length;c++){var r=i[c];r.alive&&-1!=[18,19,20].indexOf(Math.floor(r.fid))&&s.push(r.fishId)}s.length>0&&this.GameLayer.EffectLayer.scheduleOnce(function(){t.requestShotTarget(s,e.bombId,3)},.5)}},t.prototype.CmdHQLBigBomb=function(e){var t=e.position;if(this.GameLayer.EffectLayer.addEffect({skillId:a.HQLEffectType.BigBoom,position:t}),e.seatId===a.HQLConst.once.seatId){for(var o=this.GameLayer.getFishs(),n=[],i=e.award,s=0,c=a.HQLConst.once.BLevels[a.HQLConst.once.BLevel],r=0;r<o.length;r++){var l=o[r];if(l.alive&&l.config.FishID<=16){var h=l.config.Coin*c*a.HQLConst.once.RoomBet;s+h<i&&(s+=h,n.push(l.fishId))}}cc.log("CmdHQLBigBomb: ",e,n),this.requestShotTarget(n,e.bombId,3)}},t.prototype.CmdHQLSameBomb=function(e){if(cc.log("CmdHQLSameBomb: "+JSON.stringify(e)),e.seatId===a.HQLConst.once.seatId){for(var t=this.GameLayer.getFishs(),o=0;o<t.length;o++){var n=t[o];n.alive&&n.config.fishType==e.fishType&&this.requestShotTarget(n.fishId,e.bombId,7,!1,!0)}cc.log("CmdHQLSameBomb:"+JSON.stringify([]))}},t.prototype.CmdBYFishSeatChange=function(e,t){t&&(t.userId=t.UserId),a.HQLConst.once.users[e]=t,this.GameLayer.refreshTable(t)},t.prototype.CmdBYCannonChange=function(e){if(cc.log("CmdBYCannonChange: "+JSON.stringify(e)+",cg:"+typeof e),"string"==typeof e&&(e=JSON.parse(e)),e.userid==a.HQLConst.once.userId)for(var t=0;t<a.HQLConst.once.BLevels.length;t++)if(e.bet==a.HQLConst.once.BLevels[t]){a.HQLConst.once.BLevel=t;break}this.GameLayer.WeaponLayer.setWeaponGold(e.userid,e.bet),this.GameLayer.WeaponLayer.setLevelByUID(e.userid,e.bet)},t.prototype.CmdBYTable=function(e){var t=e.ResultData;a.HQLConst.once.seatId=t.seatId,a.HQLConst.once.userId=a.HQLConst.once.PlayerInfo.playerId,a.HQLConst.once.users={};for(var n=0;n<t.userList.length;n++){var i=t.userList[n];a.HQLConst.once.users[i.seatId]=i,i.userId==a.HQLConst.once.userId&&(a.HQLConst.once.Entries=i.score,a.HQLConst.once.diamond=i.wins)}a.HQLConst.once.PlayerInfo.gameDisconnect=!1,a.HQLConst.once.PlayerInfo.gameName="HQLFish",a.HQLConst.once.TableId=e.change_scene_type%3||0,o.once.checkSelfTableIndex(),this.GameLayer.changeSceneBg(a.HQLConst.once.TableId,!1,a.HQLConst.once.TableId),this.GameLayer.clearTableFishs(),this.GameLayer.refreshTable(!1),this.GameLayer&&this.GameLayer.EffectLayer&&this.GameLayer.WeaponLayer.LastFireTime<-999998&&(this.GameLayer.WeaponLayer.LastFireTime=-91),this.sendChangeScene()},t.prototype.sendChangeScene=function(){p.default.once.send("changeScene",{})},t.prototype.CmdByStageChange=function(e){var t={now:a.HQLConst.once.TableId,anim:!0,later:e.change_scene_type,skillId:a.HQLEffectType.Fast};this.GameLayer.EffectLayer.addEffect(t),a.HQLConst.once.TableId=e.change_scene_type,cc.log("CmdByStageChange:"+JSON.stringify(e))},t.prototype.ShotSelfBullet=function(e){this.GameLayer&&this.GameLayer.WeaponLayer&&(e.balance=parseInt(e.bet)*a.HQLConst.once.RoomBet,e.uid=e.userid=a.HQLConst.once.userId,a.HQLConst.once.BulletCount++,this.GameLayer.WeaponLayer.LastFireTime=0,e.seatId=this.userConvertSeatId(e.userid),e.touch=this.decodePoint(e.position),this.GameLayer.WeaponLayer.showWeapon(e))},t.prototype.CmdBYShot=function(e){if(this.GameLayer&&this.GameLayer.WeaponLayer){if(e.balance=parseInt(e.bet)*a.HQLConst.once.RoomBet,e.uid=e.userid,e.seatId=this.userConvertSeatId(e.userid),e.userid==a.HQLConst.once.userId)a.HQLConst.once.Entries-=e.balance;else{if(e.fishId){var t=this.getFishByFishId(e.fishId);t instanceof r.default&&this.CmdBYLockFish(t,e.seatId)}else this.CmdBYUnlockFish(e.seatId);e.touch=this.decodePoint(e.position),this.GameLayer.WeaponLayer.showWeapon(e)}a.HQLConst.once.users[e.seatId]&&(a.HQLConst.once.users[e.seatId].score-=e.balance,this.GameLayer.updateBalance(e.userid,a.HQLConst.once.users[e.seatId].score))}},t.prototype.CmdBYShotFish=function(e){var t=this,n=this.getAllFishByFishId(e.fishId),i=n[0],s=this.getTableByUID(e.userId);e.hitSocre*=a.HQLConst.once.RoomBet;var c=!1;if(s&&i instanceof r.default){var h={fishId:e.fishId,userId:e.userId,seatId:s.seatId,award:e.hitSocre,bomb:e.bomb,fid:i.fid,ScoreEffect:i.config.ScoreEffect,position:i.node.position,SettleType:i.config.SettleType,point:i.node.convertToWorldSpaceAR(cc.v2(0,0)),bombId:e.bombId,fishType:i.config.fishType};27!=i.config.fishType&&28!=i.config.fishType||(h.ScoreEffect=15);for(var p=0;p<n.length;p++)n[p].goDie(),n[p].playDieAni();var d=parseInt(i.config.Skill);console.log("HitResult2: ",e),d==a.HQLEffectType.BigBoom&&(this.CmdHQLBigBomb(h),c=!0),d==a.HQLEffectType.SmallBoom&&this.CmdHQLSmallBomb(h),d==a.HQLEffectType.DragonSlayer&&this.CmdHQLDragonSlayer(h),2==i.config.propFish&&this.CmdHQLSameBomb(h),d==a.HQLEffectType.Double&&this.CmdHQLLord(h),-1!=[27,28,18,19,20,16,17,26,25,21,22].indexOf(i.config.fishType)&&(-1==[26,25].indexOf(i.config.fishType)&&o.once.GameLayer.EffectLayer.addEffect({skillId:a.HQLEffectType.CoinBoom,position:h.position}),o.once.GameLayer.EffectLayer.addEffect({seatId:h.seatId,award:h.award,skillId:a.HQLEffectType.Bill})),this.addSFX(h),this.showCoin(h)}c?cc.tween(o.once.GameLayer.node).delay(1).call(function(){cc.log("\u5ef6\u65f61\u79d2\u663e\u793a"),t.addUserScore(s,e)}).start():this.addUserScore(s,e);var f=this.getBulletByBulletId(e.bombId);f instanceof l.default&&!f.isDrill&&this.GameLayer.despawnBullet(f)},t.prototype.addUserScore=function(e,t){e&&a.HQLConst.once.users[e.seatId]&&-1!=[0,1,2,6,7].indexOf(t.butype)&&(a.HQLConst.once.PlayerInfo.useOneScore?(a.HQLConst.once.users[e.seatId].score+=t.hitSocre,a.HQLConst.once.Entries=a.HQLConst.once.users[e.seatId].score,this.GameLayer.updateDiamond(e.userId,a.HQLConst.once.users[e.seatId].score),this.GameLayer.updateBalance(e.userId,a.HQLConst.once.users[e.seatId].score)):(a.HQLConst.once.users[e.seatId].wins+=t.hitSocre,this.GameLayer.updateDiamond(e.userId,a.HQLConst.once.users[e.seatId].wins)))},t.prototype.createFish=function(e){var t=this.getFishConfig(e.fishType);if(e.fishes=e.fishes||[e.fishType],t){var n=h.default.generateMixed(20),i=e.fishPath%a.HQLConst.once.FishPath.length,s=this.getFishPathByID(a.HQLConst.once.FishPath[i].id),c=this.convertToGid(e.fishes.length),r=o.once.getFishPoints(t.FishID);t.fishType=e.fishType,t.propFish=e.propFish;for(var l=0;l<e.fishes.length;l++){var p={groupUuid:n,groupId:c,fid:e.fishes[l],fishId:e.fishId[0],config:t,index:l,skillId:"",FishPath:s,pathInterval:s.time,swimmingInterval:0,compensate:0,conlliderPoints:r};this.GameLayer.refreshFish(p)}}else cc.log("\u627e\u4e0d\u5230\u9c7c\u8be6\u60c5group.fishType---\x3e"+e.fishType)},t.prototype.convertToGid=function(e){for(var t=0;t<a.HQLConst.once.FishGroups.length;t++){var o=a.HQLConst.once.FishGroups[t];if(o.num==e)return o.id}return null},t.prototype.CmdBYLockFish=function(e,t){void 0===t&&(t=a.HQLConst.once.seatId),e instanceof r.default&&e.pushLockSeat(t)&&(this.GameLayer.WeaponLayer.setLockFishByTid(t,e),t==a.HQLConst.once.seatId&&this.playSFX("lock")),e instanceof r.default&&this.GameLayer.showUserLock(t,e.fid)},t.prototype.CmdBYUnlockFish=function(e){void 0===e&&(e=a.HQLConst.once.seatId),this.GameLayer.WeaponLayer.setLockFishByTid(e),this.GameLayer.UnLockFishNtfType(e)},t.prototype.addSFX=function(e){if(e&&e.seatId===a.HQLConst.once.seatId){var t="die_small";Math.floor(e.fid)>9&&(t="die"),Math.floor(e.fid)>19&&(t="die_big"),this.playSFX(t)}},t.prototype.getFishPathByID=function(e){for(var t=a.HQLConst.once.FishPath,o=""+e||"1001",n=0;n<t.length;n++){var i=t[n];if(i.id===o){var s=i;return s.scale=1,s.points[0].x-s.points[s.points.length-1].x>0&&(s.scale=-1),s}}return null},t.prototype.getFishLayerIndex=function(e){for(var t=parseInt(e),o=[[0,1,2,3,4,5,6,7,10,11,12,13,14],[15,16,20],[8,9,17,29],[22],[21,30],[18,19,25,26]],n=0;n<o.length;n++)if(-1!=o[n].indexOf(t))return n;return 0},t.prototype.getFishConfig=function(e){for(var t=0;t<a.HQLConst.once.FishConfigs.length;t++)if(""+a.HQLConst.once.FishConfigs[t].FishID==""+e)return h.default.deepCopy(a.HQLConst.once.FishConfigs[t]);return null},t.prototype.getFishPoints=function(e){return a.HQLConst.once.FishPoints[e]},t.prototype.getFishGroups=function(e){for(var t=0;t<a.HQLConst.once.FishGroups.length;t++)if(""+a.HQLConst.once.FishGroups[t].id==""+e)return a.HQLConst.once.FishGroups[t];return null},t.prototype.getEffectByType=function(e){return a.HQLConst.once.MapEffects.get(""+e)},t.prototype.getAtlasByType=function(e){return a.HQLConst.once.MapAtlas.get(""+e)},t.prototype.getDeathAnimateByID=function(e){var t=a.HQLConst.once.MapDieanis.get(""+e);if(!t)throw new Error("\u627e\u4e0d\u5230\u8be5\u9c7cID\u7684\u6b7b\u4ea1\u52a8\u753b");return t},t.prototype.getSwimAnimateByID=function(e){return a.HQLConst.once.MapSwims.get(""+e)},t.prototype.initData=function(){cc.sys.isMobile?window.addEventListener("resize",this.onResized.bind(this)):cc.view.on("canvas-resize",this.onResized,this),this.onResized()},t.prototype.checkCompensate=function(e){var t=e.clientTime||Date.now(),o=void 0===e.seatId?a.HQLConst.once.seatId:e.seatId,n=e.cToS?e.serverTime-t:t-e.serverTime,i=a.HQLConst.once.MapCompensate.get(o);i||(i=e.cToS?n:-n,a.HQLConst.once.MapCompensate.set(o,i));var s=e.cToS?n-i:n+i;return s<=0&&(i=e.cToS?i+s:i-s,a.HQLConst.once.MapCompensate.set(o,i),s=0),s},t.prototype.convertPositionAngle=function(e){var t=cc.view.getVisibleSize(),o=t.width/2,n=t.height/2,i=e.x>o||e.x<-o,s=i?Math.abs(e.x)-o:0,a=e.y>n||e.y<-n?Math.abs(e.y)-n:0,c=i?360:180;return e.y>n&&(a=-a),e.x>o&&(s=-s),{out:s||a,x:s,y:a,jd:c,angle:c-e.angle}},t.prototype.calculateSpacePoint=function(e){var t=e.xySpeed,o=cc.view.getVisibleSize();if(void 0===e.xySpeed){var n=o.width*e.speed.x*e.space,i=o.height*e.speed.y*e.space;t=Math.sqrt(n*n+i*i)}var s=t*Math.sin(e.angle/180*Math.PI),a=t*Math.cos(e.angle/180*Math.PI);return cc.v2(s,a)},t.prototype.calculateNextBorderPoint=function(e){var t=cc.v2(e.point.x,e.point.y),o=cc.view.getVisibleSize(),n=Math.sin(e.angle/180*Math.PI),i=Math.cos(e.angle/180*Math.PI),s=n>0?o.width/2-t.x:-o.width/2-t.x,a=i>0?o.height/2-t.y:-o.height/2-t.y,c=e.speed.x*n,r=e.speed.y*i,l=Math.abs(s/c),h=Math.abs(a/r),p=Math.min(l,h);return t.x+=c*p,t.y+=r*p,{point:t,time:p}},t.prototype.inCircle=function(e,t,o){return cc.v2(e.x,e.y).sub(cc.v2(t.x,t.y)).mag()<=o},t.prototype.onResized=function(){a.HQLConst.once.winScale=this.convertWindowScale()},t.prototype.checkSelfTableIndex=function(){for(var e in a.HQLConst.once.users){var t=a.HQLConst.once.users[e];t&&t.userId===a.HQLConst.once.userId&&(a.HQLConst.once.seatId=parseInt(t.seatId))}},t.prototype.getUser=function(e){void 0===e&&(e=404);var t=null;for(var o in 404==e&&(e=a.HQLConst.once.seatId),a.HQLConst.once.users){var n=a.HQLConst.once.users[o];n&&n.seatId===e&&(t=n)}return t},t.prototype.flipWeaponY=function(e){return Math.max(a.HQLConst.once.seatId,e)>1&&Math.min(a.HQLConst.once.seatId,e)<=1},t.prototype.userConvertIndex=function(e){return this.tableConvertIndex(this.userConvertSeatId(e))},t.prototype.userConvertSeatId=function(e){var t=this.getTableByUID(e);return t?t.seatId:-1},t.prototype.tableConvertIndex=function(e){void 0===e&&(e=-1);var t=e>-1?e:a.HQLConst.once.seatId;return a.HQLConst.once.seatId>1&&(t=t>1?t-2:t+2),t},t.prototype.getTableByUID=function(e,t){var o=e||a.HQLConst.once.userId;for(var n in a.HQLConst.once.users){var i=a.HQLConst.once.users[n];if(i&&""+i.userId==""+o)return t instanceof Function&&t(i),i}},t.prototype.showCoin=function(e){var t=h.default.deepCopy(e);t.self=e.seatId===a.HQLConst.once.seatId,t.index=this.tableConvertIndex(e.seatId);var o=Math.floor(e.ScoreEffect);if(parseFloat(e.award)>0&&o>0){for(var n=0;n<o;n++){var i=h.default.deepCopy(t);i.i=n,this.GameLayer.addCoin(i)}this.showCoinLbAction(t)}},t.prototype.showCoinLbAction=function(e){var t=this;if(e.award&&parseFloat(e.award)>0){var o=this.GameLayer.addCoinLb(e);if(o instanceof cc.Node){o.opacity=0;var n=cc.spawn(cc.moveTo(.5,cc.v2(o.x,o.y+50)),cc.fadeIn(.3)),i=cc.spawn(cc.moveTo(1,cc.v2(o.x,o.y+100)).easing(cc.easeIn(3)),cc.fadeOut(1));o.runAction(cc.sequence(n,i,cc.callFunc(function(){t.GameLayer.despawnCoinLb(o)})))}}},t.prototype.checkLimitBorder=function(e){var t=cc.view.getVisibleSize(),o=e.x>=-t.width/2&&e.x<=t.width/2,n=e.y>=-t.height/2&&e.y<=t.height/2;return o&&n},t.prototype.inCircleFishs=function(e,t){void 0===t&&(t=100);for(var o=[],n=this.GameLayer.getFishs(),i=[],s=0;s<n.length;s++){var a=n[s],c=a.node.convertToNodeSpaceAR(cc.v2(e.x,e.y));if(a.alive)for(var r=0;r<a.colliders.length;r++){var l=a.colliders[r];if(this.inCircle(l,c,t)){if(a.beAttack(),!a.fishId){cc.log("f.fishId;;;;;");break}i.push(a),o.push(a.fishId);break}}}return{fishId:o,fish:i}},t.prototype.getMaxFish=function(){for(var e=this.GameLayer.getFishs(),t=null,o=e.length-1;o>=0;o--){var n=e[o],i=this.checkLimitBorder(n.node);if(n.alive&&i)if(t instanceof r.default){var s=parseFloat(n.config.Type),a=parseFloat(t.config.Type);4===s&&(s=6),4===a&&(a=6),s>a&&(t=n)}else t=n}return t},t.prototype.setLimitFire=function(e,t){void 0===e&&(e=0),void 0===t&&(t=!1),this.GameLayer.WeaponLayer.setTimelimit(e),t&&a.HQLConst.once.IsAuto&&this.GameLayer.MenuLayer.onClickedAuto(!1)},t.prototype.onTouchWindow=function(e,t){if(this.GameLayer.WeaponLayer.timeLimit){this.GameLayer.WeaponLayer.setClickLimit(!1);var o=this.GameLayer.WeaponLayer.balanceLimit;this.setLimitFire(a.HQLConst.once.FightLimit,!o),this.requestFishFire(e,t)}},t.prototype.showLockLineByTid=function(e,t){for(var o=0;o<t.length;o++){var n=t[o];this.GameLayer.WeaponLayer.showLockLineByTid(n,e)}},t.prototype.getFishByFishId=function(e){for(var t=this.GameLayer.getFishs(),o=0;o<t.length;o++){var n=t[o];if(e===n.fishId)return n}return null},t.prototype.getAllFishByFishId=function(e){for(var t=[],o=this.GameLayer.getFishs(),n=0;n<o.length;n++){var i=o[n];e===i.fishId&&t.push(i)}return t},t.prototype.getBulletByBulletId=function(e){for(var t=this.GameLayer.getBullets(),o=0;o<t.length;o++){var n=t[o];if(e===n.bulletId)return n}return null},t.prototype.removeEvents=function(){cc.sys.isMobile?window.removeEventListener("resize",this.onResized.bind(this)):cc.view.off("canvas-resize",this.onResized,this),this.unscheduleAllCallbacks()},t.prototype.getFrameByName=function(e){var t=null;return a.HQLConst.once.MapAtlas.forEach(function(o){var n=o.getSpriteFrame(e);n&&(t=n)}),t},t.prototype.cheekVectorOrTimeIndex=function(e,t,o){for(var n=0,i=[],s=1;s<e.length;s++){var a=100;if(!o){var c=e[s-1],r=e[s];a=Math.pow(r.x-c.x,2)+Math.pow(r.y-c.y,2),a=Math.sqrt(a)}i.push(a),n+=a}var l=0,h=0;for(s=0;s<i.length;s++){h=s+1;var p=n*t,d=l+(a=i[s]);if(l<p&&p<=d)return{index:h,f:1-(d-p)/a};l=d}return null},t.prototype.makeBreakBezier2=function(e,t,o){if(t&&t.length){if(e<=0)return t[0];if(e>=1)return t[t.length-1];for(var n=0,i=this.cheekVectorOrTimeIndex(t,e,!0),s=[t[i.index-1],o[i.index-1],t[i.index]];n<1e3;){n++;for(var a=s.length-1,c=0;c<a;c++)if(s[c]=this.convertVectorToPoint(s[c],s[c+1],i.f),c===a-1&&(s.splice(a,s.length),1===s.length))return s[0]}}},t.prototype.convertVectorToPoint=function(e,t,o){return cc.v2(e.x+-(e.x-t.x)*o,e.y+-(e.y-t.y)*o)},t.prototype.convertPointToAngle=function(e,t){var o=0,n=e.y-t.y,i=e.x-t.x;return 0===i?o=n>0?-90:90:(i<0&&n>0&&(o=180-180*Math.atan(n/i)/Math.PI),i<0&&n<0&&(o=180-180*Math.atan(n/i)/Math.PI),i>0&&n>0&&(o=270+180*Math.atan(i/n)/Math.PI),i>0&&n<0&&(o=90+180*Math.atan(i/n)/Math.PI)),o},t.prototype.convertWindowsizePath=function(e){for(var t=e,o=this.convertWindowScale(),n=0;n<t.length;n++){for(var i=0;i<t[n].points.length;i++)t[n].points[i].x*=o.x,t[n].points[i].y*=o.y;for(i=0;i<t[n].controls.length;i++)t[n].controls[i].x*=o.x,t[n].controls[i].y*=o.y}return t},t.prototype.convertWindowScale=function(){var e=cc.view.getVisibleSize(),t=e.width/1334,o=e.height/750;return cc.v2(t,o)},t.prototype.addBill=function(e){if(e&&this.GameLayer&&this.GameLayer.EffectLayer&&cc.isValid(this.GameLayer.node)&&Math.floor(e.SettleType)>=0){var t=(""+e.SettleType).split(""),o=e.seatId===a.HQLConst.once.seatId,n=e.award;-1!==["1","0"].indexOf(t[0])&&-1!==["1","0"].indexOf(t[1])&&(t=o?[1]:[0]);for(var i=Math.floor(e.fid),s=0;s<t.length;s++){var c=Math.floor(t[s]),r=e.skillId===a.HQLEffectType.Box?1:c;this.GameLayer.EffectLayer.addEffect({seatId:e.seatId,skillId:a.HQLEffectType.Bill,type:c,fid:i,award:n,limit:r,number:e.number})}}},t.prototype.codePoint=function(e){return e||(e=cc.v2(0,0)),{x:1*e.x/a.HQLConst.once.winScale.x,y:1*e.y/a.HQLConst.once.winScale.y}},t.prototype.decodePoint=function(e){return e||(e=cc.v2(0,0)),{x:1*e.x*a.HQLConst.once.winScale.x,y:1*e.y*a.HQLConst.once.winScale.y}},t.prototype.playBGM=function(e,t){void 0===t&&(t=!0),e=e||this.MusicDic[404],t&&(this.MusicDic[404]=e),this.play(e,!0,!0)},t.prototype.stopBGM=function(){cc.audioEngine.stopAll()},t.prototype.playSFX=function(e){this.play(e,!1,!1)},t.prototype.stopSFX=function(e){this.MusicDic[e]&&cc.audioEngine.stop(this.MusicDic[e])},t.prototype.play=function(e,t,o){void 0===o&&(o=!1);var n=this.GameLayer.LoadingLayer[e];n&&(this.MusicDic[e]=o?cc.audioEngine.playMusic(n,t):cc.audioEngine.playEffect(n,t))},s([u(c.default)],t.prototype,"GameLayer",void 0),o=s([f],t)}(cc.Component);o.default=y,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./HQLBullet":"HQLBullet","./HQLConst":"HQLConst","./HQLFish":"HQLFish","./HQLNetWork":"HQLNetWork","./HQLScene":"HQLScene"}],HQLMenu:[function(e,t,o){"use strict";cc._RF.push(t,"ea2a4WVsYtF6rSwPcdpLad9","HQLMenu");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../../Script/utils/Utils"),c=e("./HQLConst"),r=e("./HQLManager"),l=e("./HQLNetWork"),h=cc._decorator,p=h.ccclass,d=h.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LayerNetError=null,t.LayerRule=null,t.sp_setup=null,t.an_auto=null,t.an_lock=null,t._mune=!1,t}return i(t,e),t.prototype.onLoad=function(){this._index=0,this.node.width=cc.winSize.width>1334?1334:cc.winSize.width,this.btn_auto=this.node.getChildByName("btn_auto"),this.btn_lock=this.node.getChildByName("btn_lock"),this.btn_jiasu=this.node.getChildByName("btn_jiasu"),this.btn_auto.on("click",this.onClickedAuto,this),this.btn_lock.on("click",this.onClickedLock,this),this.btn_jiasu.on("click",this.onClickedJiasu,this),this.node.getChildByName("btn_bill").on("click",this.onClickedBill,this),this.layer_mune=this.node.getChildByName("layer_mune"),cc.find("layer_mune/btn_back",this.node).on("click",this.onClickedBack,this),cc.find("layer_mune/btn_setup",this.node).on("click",this.onClickedSetup,this),cc.find("layer_mune/btn_rule",this.node).on("click",this.onClickedRule,this),this.btn_show=cc.find("layer_mune/btn_show/sp",this.node).getComponent(cc.Sprite),this.btn_show.node.parent.on("click",this.onClickedShow,this),this.initKuang(),cc.game.on(cc.game.EVENT_HIDE,this.onHide,this);var e=cc.sys.localStorage.getItem("HQL_AudioVolume");this.setAudioVolume(null==e||e>0)},t.prototype.onHide=function(){console.log("\u6e38\u620f\u8fdb\u5165\u540e\u53f0"),c.HQLConst.once.IsAuto&&this.onClickedAuto()},t.prototype.onclickedLeave=function(){l.default.once.levea()},t.prototype.initKuang=function(){var e=r.default.once.getEffectByType("auto_");e&&(e.wrapMode=cc.WrapMode.Loop,this.an_auto.addClip(e));var t=r.default.once.getEffectByType("lock_");t&&(t.wrapMode=cc.WrapMode.Loop,this.an_lock.addClip(t))},t.prototype.onResized=function(){},t.prototype.onClickedSetup=function(){r.default.once.playSFX("click"),cc.audioEngine.getMusicVolume()>0?this.setAudioVolume(!1):this.setAudioVolume(!0)},t.prototype.setAudioVolume=function(e){e?(this.sp_setup.spriteFrame=c.HQLConst.once.UIAtals.getSpriteFrame("volume"),cc.audioEngine.setMusicVolume(1),cc.audioEngine.setEffectsVolume(1),cc.sys.localStorage.setItem("HQL_AudioVolume",1)):(this.sp_setup.spriteFrame=c.HQLConst.once.UIAtals.getSpriteFrame("mute"),cc.audioEngine.setMusicVolume(0),cc.audioEngine.setEffectsVolume(0),cc.sys.localStorage.setItem("HQL_AudioVolume",0))},t.prototype.onClickedRule=function(){this.LayerRule.active=!this.LayerRule.active},t.prototype.onClickedShow=function(){r.default.once.playSFX("click"),this._mune=!this._mune,this.btn_show.spriteFrame=r.default.once.getFrameByName(this._mune?"spread":"fold");for(var e=[],t=0;t<3;t++)e[t]=cc.find("layer_mune/"+["btn_back","btn_setup","btn_rule"][t],this.node),e[t].stopAllActions(),e[t].active=this._mune,e[t].opacity=0,e[t].scale=1;if(this._mune)for(t=0;t<e.length;t++)e[t].runAction(cc.sequence(cc.delayTime(.1*t),cc.spawn(cc.sequence(cc.scaleTo(.05,1.2),cc.scaleTo(.05,1)),cc.fadeIn(.1))))},t.prototype.onClickedBack=function(){r.default.once.playSFX("click"),r.default.once.requestLeaveRoom()},t.prototype.onClickedBill=function(){var e=a.default.ranAllo(100,1,50,24);r.default.once.GameLayer.EffectLayer.addEffect({awards:e,skillId:c.HQLEffectType.DragonSlayer,position:cc.v2(300,150)})},t.prototype.onClickCloseRule=function(){r.default.once.playSFX("click"),this.LayerRule.active=!1},t.prototype.onClickedAuto=function(e){void 0===e&&(e=!0),e&&r.default.once.playSFX("click"),c.HQLConst.once.IsAuto=!c.HQLConst.once.IsAuto,c.HQLConst.once.IsAuto?this.btn_auto.opacity=255:this.btn_auto.opacity=200},t.prototype.onClickedJiasu=function(e){void 0===e&&(e=!0),e&&r.default.once.playSFX("click"),c.HQLConst.once.AutoLimit==c.HQLFireSpeed.Speed0?(c.HQLConst.once.AutoLimit=c.HQLFireSpeed.Speed1,c.HQLConst.once.FightLimit=c.HQLFireSpeed.Speed1):(c.HQLConst.once.AutoLimit=c.HQLFireSpeed.Speed0,c.HQLConst.once.FightLimit=c.HQLFireSpeed.Speed0),this.btn_jiasu.opacity=c.HQLConst.once.AutoLimit==c.HQLFireSpeed.Speed1?255:200},t.prototype.onClickedLock=function(){r.default.once.playSFX("click"),c.HQLConst.once.IsLock=!c.HQLConst.once.IsLock,c.HQLConst.once.IsLock?this.btn_lock.opacity=255:(r.default.once.CmdBYUnlockFish(),this.btn_lock.opacity=200)},t.prototype.onDestroy=function(){cc.game.off(cc.game.EVENT_HIDE,this.onHide,this)},s([d(cc.Node)],t.prototype,"LayerNetError",void 0),s([d(cc.Node)],t.prototype,"LayerRule",void 0),s([d(cc.Sprite)],t.prototype,"sp_setup",void 0),s([d(cc.Animation)],t.prototype,"an_auto",void 0),s([d(cc.Animation)],t.prototype,"an_lock",void 0),s([p],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./HQLConst":"HQLConst","./HQLManager":"HQLManager","./HQLNetWork":"HQLNetWork"}],HQLNetWork:[function(e,t,o){"use strict";cc._RF.push(t,"5265fGLt51JhIOXbsOQ3MW5","HQLNetWork");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./HQLConst"),c=e("./HQLManager"),r=cc._decorator,l=r.ccclass,h=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return i(t,e),o=t,t.prototype.onLoad=function(){o.once=this,GameConfig.SubGameMgr.subGameNet=this,this.send("loginGame",{})},t.prototype.start=function(){},t.prototype.send=function(e,t){void 0===t&&(t={}),window.sendNetWorkData&&(console.log("send cmd:"+e+",data:",t),window.sendNetWorkData(e,"string"==typeof t?t:JSON.stringify(t)))},t.prototype.requestLeaveRoom=function(){cc.log("xxxxxxxxx requestLeaveRoom"),Common.backHall("Are you sure you want to leave the game?",function(){})},t.prototype.addNetEvent=function(e,t){if("loginGameResult"==e){var o=this.changeResultJSON_Function(t);console.log("\u6e38\u620f\u767b\u9646\u6210\u529f=======================",o),o.resultid?(a.HQLConst.once.RoomBet=o.Obj.bet,a.HQLConst.once.PlayerInfo.win_pool=o.Obj.winPool,a.HQLConst.once.PlayerInfo.playerDiamond=o.Obj.wins,a.HQLConst.once.PlayerInfo.playerId=o.Obj.id,a.HQLConst.once.Entries=o.Obj.score,this.send("LoginRoom",{roomid:1})):this.tryLeave()}if("LoginRoomResult"==e&&(t=this.changeResultJSON_Function(t),cc.log("LoginRoomResult",t),t.ResultCode)){cc.log("LoginRoomResult------------------\x3e"+JSON.stringify(t)),a.HQLConst.once.BLevels=t.ResultData.betList,c.default.once.CmdBYTable(t);for(var n=t.ResultData.userList,i=0;i<n.length;i++)c.default.once.CmdBYCannonChange(n[i])}if("HitResult"==e&&1==(o=this.changeResultJSON_Function(t)).ResultCode&&c.default.once.CmdBYShotFish(o.ResultData),"FishOut"==e){o=this.changeResultJSON_Function(t);c.default.once.createFish(o)}if("fishShoot"==e){o=this.changeResultJSON_Function(t);c.default.once.CmdBYShot(o)}if("getDownTimeResult"==e&&(o=this.changeResultJSON_Function(t),console.log("getDownTimeResult======================="+JSON.stringify(o))),"doubleEnd"==e&&(o=this.changeResultJSON_Function(t),c.default.once.CmdHQLLordSettle(o)),"chargeAllResult"==e&&(o=this.changeResultJSON_Function(t),console.log("chargeAllResult",o),c.default.once.rechargeAllResult(o)),"playEnter"==e&&(o=this.changeResultJSON_Function(t)).ResultCode&&(cc.log("playEnter:"+JSON.stringify(t)),c.default.once.CmdBYFishSeatChange(o.ResultData.seatId,o.ResultData)),"PlayerOut"==e&&(o=this.changeResultJSON_Function(t),cc.log("PlayerOut:"+JSON.stringify(t)),c.default.once.CmdBYFishSeatChange(o.PlayerSeatId,null)),"changePowerResult"==e&&(o=this.changeResultJSON_Function(t),cc.log("changePowerResult :"+JSON.stringify(o)),c.default.once.CmdBYCannonChange(o)),"useSkillResult"==e&&(o=this.changeResultJSON_Function(t),console.log("useSkillResult",o)),"fishHit_boardResult"==e){var s=this.changeResultJSON_Function(t);s.uid==a.HQLConst.once.PlayerInfo.playerId&&this.send("fishHit",s)}"fishSceneChange"==e&&(o=this.changeResultJSON_Function(t))&&(cc.log("fishSceneChange:"+JSON.stringify(t)),o.change_scene_type%=3,c.default.once.CmdByStageChange(o)),"disconnect"==e&&this.requestLeaveRoom()},t.prototype.tryLeave=function(){this.levea()},t.prototype.levea=function(){Common.backHall("Are you sure you want to leave the game?",function(){})},t.prototype.closeSocket=function(){},t.prototype.changeResultJSON_Function=function(e){return JSON.parse(e)},t.prototype.onDestroy=function(){o.once=null},o=s([l],t)}(cc.Component));o.default=h,cc._RF.pop()},{"./HQLConst":"HQLConst","./HQLManager":"HQLManager"}],HQLScene:[function(e,t,o){"use strict";cc._RF.push(t,"c66fciPpt9AbKbRB1AASUvz","HQLScene");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./HQLConst"),c=e("./HQLManager"),r=e("./HQLEffect"),l=e("./HQLMenu"),h=e("./HQLCoin"),p=e("./HQLBullet"),d=e("./HQLFish"),f=e("./HQLFishNet"),u=e("./HQLWeapon"),y=e("./HQLEffectLayer"),g=e("./HQLBill"),L=e("./HQLUser"),v=e("./HQLLoading"),m=e("../../../Script/utils/Utils"),_=cc._decorator,C=_.ccclass,H=_.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LoadingLayer=null,t.MenuLayer=null,t.WeaponLayer=null,t.EffectLayer=null,t.RechargeLayer=null,t.FishParent=null,t.BulletParent=null,t.GoldParent=null,t.GoldLabelParent=null,t.NetParent=null,t.EffectSKParent=null,t.EffectParent=null,t.arr_fishs=[],t.arr_bullets=[],t.arr_effect=[],t.arr_coin=[],t.arr_seats=[],t}return i(t,e),t.prototype.onLoad=function(){this.LoadingLayer.loadFinish(),c.default.once.GameLayer=this,this.initView(),this.EffectLayer.defaultLight(this.node),c.default.once.initData(),this.loadFinish()},t.prototype.changeGold=function(e){return(parseFloat(e)/a.HQLConst.once.PlayerInfo.exchangeRate).toFixed(2)},t.prototype.loadFinish=function(){this.initData();for(var e=0;e<this.arr_seats.length;e++)this.arr_seats[e].initUI(),this.arr_seats[e].cleanInfo();this.WeaponLayer.init()},t.prototype.initData=function(){this.arr_fishs=[],this.arr_bullets=[],this.arr_effect=[],this.arr_coin=[];var e=cc.find("layer_load/pr_net",this.node);e.addComponent(f.default);var t=cc.find("layer_load/pr_fish",this.node);t.addComponent(d.default);var o=cc.find("layer_load/pr_bullet",this.node);o.addComponent(p.default);var n=cc.find("layer_load/pr_effect",this.node);n.addComponent(r.default);var i=cc.find("layer_load/pr_coin",this.node);i.addComponent(h.default);var s=cc.find("layer_load/lb_coin",this.node),a=cc.find("layer_load/pr_bill",this.node);a.addComponent(g.default),this.pool_fish=this.createPool(400,t),this.pool_bullet=this.createPool(300,o),this.pool_net=this.createPool(130,e),this.pool_coin=this.createPool(400,i),this.pool_effect=this.createPool(50,n),this.pool_bill=this.createPool(20,a),this.pool_coinlb=this.createPool(200,s)},t.prototype.createPool=function(e,t){var o=new cc.NodePool;o.prefab=t;for(var n=0;n<e;n++)o.put(cc.instantiate(t));return o},t.prototype.getNodeByPool=function(e){var t=e.get();return t||(t=cc.instantiate(e.prefab)),t},t.prototype.clearLockFishAllBullet=function(e){for(var t=this.getBullets(),o=0;o<t.length;o++){var n=t[o];n.lockFishId===e&&n.clearLockID()}},t.prototype.initView=function(){cc.log("HQLConst.once.PlayerInfo.useOneScore",a.HQLConst.once.PlayerInfo.useOneScore);var e=a.HQLConst.once.PlayerInfo.useOneScore?this.node.getChildByName("layer_users2").children:this.node.getChildByName("layer_users").children;this.arr_seats=[];for(var t=0;t<4;t++){var o=e[t].getComponent(L.default);this.arr_seats.push(o)}for(this.layer_bgs=this.node.getChildByName("layer_bgs"),t=0;t<5;t++){var n=this.RechargeLayer.getChildByName("btn_"+t);m.default.addClickEvent(n,this,m.default.getComponentName(this),"onClickedRecharge",t)}},t.prototype.getFishs=function(){return this.arr_fishs||[]},t.prototype.getBullets=function(){return this.arr_bullets||[]},t.prototype.changeSceneBg=function(e,t,o){void 0===e&&(e=0);var n="bg"+o%3;if(c.default.once.playBGM(n),e!=o){for(var i=this.layer_bgs.children,s=0;s<i.length;s++){var a=i[s],r=a.name==="layer_"+e&&t,l=a.name==="layer_"+o;a.active=r||l,a.active&&(a.setPosition(0,0),a.opacity=255,a.zIndex=l?0:1)}if(t){c.default.once.playSFX("effect_108");var h=this.layer_bgs.getChildByName("layer_"+e);h.stopAllActions();var p=h.getChildByName("bg");p.stopAllActions(),h.runAction(cc.moveTo(2,cc.v2(-1630,0))),p.runAction(cc.sequence(cc.moveTo(2,cc.v2(1630,0)),cc.callFunc(function(){p.setPosition(0,0),h.active=""+e==""+o})))}}},t.prototype.updateBalance=function(e,t){var o=c.default.once.getTableByUID(e);if(o){var n=this.getUserByTable(o.seatId);n&&n.updateBalance(t)}},t.prototype.updateDiamond=function(e,t){var o=c.default.once.getTableByUID(e);if(o){var n=this.getUserByTable(o.seatId);n&&n.updateDiamond(t)}},t.prototype.getUserByTable=function(e){for(var t=null,o=0;o<this.arr_seats.length;o++)this.arr_seats[o]._seatId===e&&(t=this.arr_seats[o]);return t},t.prototype.refreshTable=function(e){void 0===e&&(e=null);var t=[0,1,2,3];for(var o in a.HQLConst.once.users){var n=a.HQLConst.once.users[o];if(n){var i=parseInt(n.seatId);if(t.splice(t.indexOf(i),1),e&&n.userId!==e.userId)continue;var s=c.default.once.tableConvertIndex(i),r=c.default.once.userConvertIndex(a.HQLConst.once.userId);cc.log("index======>"+s+"---selfIndex--\x3e"+r+"--u------\x3e"+JSON.stringify(n)),this.WeaponLayer.setConvertWeaponActive(n.userId,!0,null!=e),null!=e&&this.WeaponLayer.setLevelByUID(n.userId,0),this.arr_seats[s].refreshUserInfo(n),this.arr_seats[s].node.active=!0,n.userId==a.HQLConst.once.userId?this.WeaponLayer.setWeaponGold(n.userId,a.HQLConst.once.BLevels[a.HQLConst.once.BLevel]):this.WeaponLayer.setWeaponGold(n.userId,n.bet)}}for(var l=0;l<t.length;l++)s=c.default.once.tableConvertIndex(t[l]),cc.log("cleanInfoByTid------\x3e"+s),this.arr_seats[s].cleanInfo(),this.WeaponLayer.cleanInfoByTid(t[l])},t.prototype.showUserLock=function(e,t){var o=c.default.once.tableConvertIndex(e),n=this.arr_seats[o];n&&n.showLockFish(t)},t.prototype.UnLockFishNtfType=function(e){var t=c.default.once.tableConvertIndex(e),o=this.arr_seats[t];o&&o.unLock()},t.prototype.updateFish=function(){var e=a.HQLConst.once.FishConfigs[m.default.randomNum(0,a.HQLConst.once.FishConfigs.length)].FishID,t=a.HQLConst.once.FishGroups[7],o=t.id,n=a.HQLConst.once.FishPath[0],i=c.default.once.getFishConfig(e),s=c.default.once.getFishPathByID(n.id),r=c.default.once.getFishPoints(e);r=m.default.deepCopy(r);for(var l=0;l<t.num;l++)this.refreshFish({config:i,FishPath:s,fid:e,groupId:o,index:l,compensate:0,swimmingInterval:0,pathInterval:n.time,conlliderPoints:r})},t.prototype.refreshFish=function(e){var t=e,o="layer_"+c.default.once.getFishLayerIndex(t.fid);if(30==parseInt(t.fid)&&cc.log("--------dsfdsfdsfdfsdfsdfsdfsdf"),this.pool_fish.size()<5&&cc.log("\u9c7c\u82d7\u62a5\u8b66"),t.config&&o)if(t.groups=c.default.once.getFishGroups(t.groupId),t.groups){if(!(t.groups&&t.groups.origin&&t.groups.points&&t.groups.points[t.index])){var n="!groups";return t.groups.origin||(n="!groups.origin"),t.groups.points||(n="!groups.points"),t.groups.points[t.index]||(n="!groups.points[param.index]"),void cc.log("\u627e\u4e0d\u5230\u9c7c\u7ec4\u914d\u7f6e\u4fe1\u606f ID\uff1a"+t.groupId+"  \u7f3a\u5931\u4fe1\u606f\uff1a"+n+"  param.index:"+t.index)}if(t.FishPath)if(t.swimAni=c.default.once.getSwimAnimateByID(t.fid),t.swimAni){var i=this.getNodeByPool(this.pool_fish),s=i.getComponent(d.default);this.arr_fishs.push(s),i.parent=this.FishParent.getChildByName(o),s.init(t)}else cc.log("\u627e\u4e0d\u5230\u9c7c\u7684\u52a8\u753bID\uff1a"+t.fid);else cc.log("\u627e\u4e0d\u5230\u9c7c\u7684\u8def\u5f84ID\uff1a"+t.pid)}else cc.log("\u627e\u4e0d\u5230\u9c7c\u7ec4\u914d\u7f6e\u4fe1\u606f ID\uff1a"+t.groupId);else cc.log("fishError\u627e\u4e0d\u5230\u9c7c\u7684\u4fe1\u606f ID\uff1a"+t.fid+"  "+!o)},t.prototype.getLockFishByFishId=function(e){for(var t=0;t<this.WeaponLayer.arr_locks.length;t++){var o=this.WeaponLayer.arr_locks[t];if(e===o.fishId)return o}return null},t.prototype.addNet=function(e,t,o,n){var i=this.getNodeByPool(this.pool_net),s=i.getComponent(f.default);i.zIndex=5e3,this.NetParent.addChild(i),s.init(e,t,o,n)},t.prototype.addEffect=function(e){if(cc.isValid(this.node)){var t=this.getNodeByPool(this.pool_effect),o=t.getComponent(r.default);this.EffectParent.addChild(t),e.parent=this.EffectSKParent,o.init(e),this.arr_effect.push(o)}},t.prototype.getEffectBySkillId=function(e,t){void 0===t&&(t=!0);for(var o=[],n=0;n<this.arr_effect.length;n++){var i=this.arr_effect[n];if(i.param&&i.param.skillId===e){if(!t)return i;o.push(i)}}return t?o:null},t.prototype.addBullet=function(e){var t=e;t.angle=t.angle||this.WeaponLayer.getWeaponRotationByTid(t.seatId);var o=this.WeaponLayer.getWeaponOutPositionByTid(t.seatId),n=this.getNodeByPool(this.pool_bullet),i=n.getComponent(p.default);n.zIndex=2e3,this.arr_bullets.push(i),t.point=t.point||this.BulletParent.convertToNodeSpaceAR(o),this.BulletParent.addChild(n),t.isDrill&&(t.lock=null),i.init(t)},t.prototype.showRecharge=function(){Common.showMessage("not enough balance")},t.prototype.onClickedRecharge=function(e,t){cc.log("onClickedRecharge----\x3e"+t),4==parseInt(t)?c.default.once.requestRechargeAll():c.default.once.requestRechargeSum([1,10,50,100][parseInt(t)])},t.prototype.addBill=function(e){var t=this.getNodeByPool(this.pool_bill);t.parent=this.EffectParent,t.position=e.position?this.EffectParent.convertToNodeSpaceAR(e.position):cc.v2(0,0),t.getComponent(g.default).show(e)},t.prototype.addCoin=function(e){var t=this.getNodeByPool(this.pool_coin);t.parent=e.parent||this.GoldParent,t.zIndex=1e4;var o=e,n=this.arr_seats[o.index];if(n){var i=n.getUserWorldPoint(),s=t.getComponent(h.default);o.to=i,s.init(o),this.arr_coin.push(s)}},t.prototype.addCoinLb=function(e){e||(e={});var t=this.getNodeByPool(this.pool_coinlb);if(t.parent=this.GoldLabelParent,e.position)t.position=e.position;else{var o=c.default.once.tableConvertIndex(e.seatId),n=this.arr_seats[o].getUserWorldPoint();t.position=t.parent.convertToNodeSpaceAR(n)}t.active=!0,t.zIndex=10001;var i=t.getComponent("HQLLabel");return i.defaultNames="score_",i.spriteAtlas=i.spriteAtlas||a.HQLConst.once.UIAtals,i.string=""+c.default.once.GameLayer.changeGold(e.award),t},t.prototype.despawnBill=function(e){e.node&&this.pool_bill.put(e.node)},t.prototype.despawnBullet=function(e){e.seatId===a.HQLConst.once.seatId&&a.HQLConst.once.BulletCount--,e.lockFishId=a.HQLConst.once.NotFound,e.node&&this.pool_bullet.put(e.node);var t=this.arr_bullets.indexOf(e);this.arr_bullets.splice(t,1)},t.prototype.despawnEffect=function(e){e.clean();var t=this.arr_effect.indexOf(e);this.arr_effect.splice(t,1),this.pool_effect.put(e.node)},t.prototype.despawnCoin=function(e){e.node instanceof cc.Node&&(this.pool_coin.put(e.node),e.clean()),e instanceof cc.Node&&this.pool_coin.put(e);var t=this.arr_coin.indexOf(e);this.arr_coin.splice(t,1)},t.prototype.despawnCoinLb=function(e){e.node instanceof cc.Node&&(this.pool_coinlb.put(e.node),e.clean()),e instanceof cc.Node&&this.pool_coinlb.put(e)},t.prototype.clearTableFishs=function(){for(var e=this.FishParent.childrenCount-1;e>=0;e--){var t=this.FishParent.children[e].getComponent(d.default);t&&this.despawnFish(t)}},t.prototype.despawnFish=function(e){e.node&&e instanceof d.default&&this.pool_fish.put(e.node);var t=this.arr_fishs.indexOf(e);-1!==t&&this.arr_fishs.splice(t,1)},t.prototype.despawnNet=function(e){e.node&&this.pool_net.put(e.node)},t.prototype.update=function(e){if(cc.isValid(this.node)){(a.HQLConst.once.HeartBeatCD-=e)<0&&(a.HQLConst.once.HeartBeatCD=5,c.default.once.heartBeat());for(var t=[],o=0;o<this.arr_fishs.length;o++){var n=this.arr_fishs[o];if(n.updatexxx(e),n&&n.alive){var i=n.node.convertToWorldSpaceAR(cc.v2(0,0));t.push({fish:n,fwsp:i})}}for(var s=[],r=0;r<this.arr_bullets.length;r++){var l=this.arr_bullets[r];l.updatexxx(e);var h=l.node.convertToWorldSpaceAR(cc.v2(0,0)),p=cc.v2(h.x,h.y-50),d=cc.v2(h.x-20,h.y),f=cc.v2(h.x+20,h.y);s.push({bullet:l,bwsp:h,bwspDown:p,bwspLeft:d,bwspRight:f})}for(r=0;r<s.length;r++){var u=s[r];for(o=0;o<t.length;o++){var y=t[o],g=u.bwsp.sub(y.fwsp).mag();if(y.fish.radius>g){var L=y.fish.getColliderPoints().ws;(g<50||y.fish==u.bullet.lockFish||m.default.rayCasting(u.bwsp,L)||m.default.rayCasting(u.bwspDown,L)||m.default.rayCasting(u.bwspLeft,L)||m.default.rayCasting(u.bwspRight,L))&&u.bullet.onCollision(y.fish)}}}}},t.prototype.onDestroy=function(){var e=function(e){for(var t=0;t<e.length;t++){var o=e[t];o.node&&(o.node.removeFromParent(),o.node.destroy())}};e(this.arr_coin),e(this.arr_bullets),e(this.arr_fishs),e(this.arr_effect),a.HQLConst.destroyInstance(),c.default.destroyInstance()},s([H(v.default)],t.prototype,"LoadingLayer",void 0),s([H(l.default)],t.prototype,"MenuLayer",void 0),s([H(u.default)],t.prototype,"WeaponLayer",void 0),s([H(y.default)],t.prototype,"EffectLayer",void 0),s([H(cc.Node)],t.prototype,"RechargeLayer",void 0),s([H(cc.Node)],t.prototype,"FishParent",void 0),s([H(cc.Node)],t.prototype,"BulletParent",void 0),s([H(cc.Node)],t.prototype,"GoldParent",void 0),s([H(cc.Node)],t.prototype,"GoldLabelParent",void 0),s([H(cc.Node)],t.prototype,"NetParent",void 0),s([H(cc.Node)],t.prototype,"EffectSKParent",void 0),s([H(cc.Node)],t.prototype,"EffectParent",void 0),s([C],t)}(cc.Component);o.default=b,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./HQLBill":"HQLBill","./HQLBullet":"HQLBullet","./HQLCoin":"HQLCoin","./HQLConst":"HQLConst","./HQLEffect":"HQLEffect","./HQLEffectLayer":"HQLEffectLayer","./HQLFish":"HQLFish","./HQLFishNet":"HQLFishNet","./HQLLoading":"HQLLoading","./HQLManager":"HQLManager","./HQLMenu":"HQLMenu","./HQLUser":"HQLUser","./HQLWeapon":"HQLWeapon"}],HQLUser:[function(e,t,o){"use strict";cc._RF.push(t,"24ec0WIm7hMX7m4C6nHMItd","HQLUser");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./HQLConst"),c=e("./HQLManager"),r=cc._decorator,l=r.ccclass,h=r.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._seatId=-1,t.lb_total=null,t.lb_gold=null,t}return i(t,e),t.prototype.initUI=function(){this.unLock(),this.node.getChildByName("btn_add").on("click",this.onClickedAdd,this)},t.prototype.onClickedAdd=function(){this._seatId==a.HQLConst.once.seatId&&(c.default.once.GameLayer.showRecharge(!1),c.default.once.playSFX("click"))},t.prototype.refreshUserInfo=function(e){if(cc.log("uinfo----\x3e"+JSON.stringify(e)),e){this._seatId=e.seatId,this.node.getChildByName("btn_add").active=e.seatId==a.HQLConst.once.seatId&&!a.HQLConst.once.PlayerInfo.useOneScore,this.updateBalance(e.score),this.updateDiamond(e.wins),this.node.active=!0,this.lb_gold.node.parent.active=!0;var t=c.default.once.tableConvertIndex(this._seatId);this.node.x=.19*cc.view.getVisibleSize().width,this.node.x=t%2?this.node.x+297:-this.node.x-297}},t.prototype.updateBalance=function(e){e=e||0,this.lb_gold.string=c.default.once.GameLayer.changeGold(e)},t.prototype.updateDiamond=function(e){e=e||0,this.lb_total.string=c.default.once.GameLayer.changeGold(e)},t.prototype.showLockFish=function(){},t.prototype.unLock=function(){},t.prototype.cleanInfo=function(){this.node.active=!1,this._seatId=-1,this.lb_total.string="",this.lb_gold.string="0",this.lb_gold.node.parent.active=!1,this.unLock()},t.prototype.getUserWorldPoint=function(){return this.node.convertToWorldSpaceAR(cc.v2(0,-30))},s([h(cc.Label)],t.prototype,"lb_total",void 0),s([h(cc.Label)],t.prototype,"lb_gold",void 0),s([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{"./HQLConst":"HQLConst","./HQLManager":"HQLManager"}],HQLWeapon:[function(e,t,o){"use strict";cc._RF.push(t,"7be1abPi9ZIs5ESFKsA4VNm","HQLWeapon");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../../Script/utils/Utils"),c=e("./HQLConst"),r=e("./HQLFish"),l=e("./HQLManager"),h=cc._decorator,p=h.ccclass,d=h.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.FishParent=null,t.SeatWaits=[],t.arr_weaponSp=[],t.WeaponUI=[],t.DoubleBg=[],t.arr_golds=[],t.spacingY=5,t.firstFire={set:function(e){e!==this._firstFire&&(this._firstFire=e,!this._firstFire&&this.GameLayer.MenuLayer._mune&&this.GameLayer.MenuLayer.onClickedShow())},get:function(){return this._firstFire}},t.arr_weapons=[],t.arr_lines=[],t.arr_circle=[],t.arrLevels=[],t.arr_locks=[c.HQLConst.once.NotFound,c.HQLConst.once.NotFound,c.HQLConst.once.NotFound,c.HQLConst.once.NotFound],t.arr_changes=[],t._limitTime=0,t.LastFireTime=0,t.AutoFire=!1,t}return i(t,e),t.prototype.onLoad=function(){},t.prototype.init=function(){this.initViewData(),this.FishParent.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.FishParent.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.FishParent.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.FishParent.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.FishParent._touchListener.setSwallowTouches(!1),this.schedule(this.speed0,c.HQLFireSpeed.Speed0),this.schedule(this.speed1,c.HQLFireSpeed.Speed1),this.firstFire=!0},t.prototype.speed1=function(){c.HQLConst.once.FightLimit==c.HQLFireSpeed.Speed1&&(this.limitFireCd(),this.checkAutoFire())},t.prototype.speed0=function(){c.HQLConst.once.FightLimit==c.HQLFireSpeed.Speed0&&(this.limitFireCd(),this.checkAutoFire())},t.prototype.limitFireCd=function(){this.checkAutoLock(),this._canFire=!0},t.prototype.checkAutoFire=function(){if(-1!=c.HQLConst.once.seatId&&(c.HQLConst.once.IsAuto||this.AutoFire)){var e=this.getWeaponOutPositionByTid(c.HQLConst.once.seatId),t=l.default.once.tableConvertIndex(),o=this.arr_locks[t];o instanceof r.default&&(e=o.getWorldPoint()),this._touchPoint&&(e=this._touchPoint,this._touchPoint=null),l.default.once.onTouchWindow(e,o.fishId),this.firstFire=!1}},t.prototype.setWeaponGold=function(e,t){var o=l.default.once.userConvertIndex(e),n=this.arr_golds[o];if(n){var i=t*c.HQLConst.once.RoomBet;n.string=l.default.once.GameLayer.changeGold(i),cc.log("setWeaponGold",i,l.default.once.GameLayer.changeGold(i)),n.node.active=!0}},t.prototype.setConvertWeaponActive=function(e,t,o){void 0===o&&(o=!0);var n=l.default.once.userConvertIndex(e);try{var i=this.WeaponUI[n];if(i.active=this.arr_weaponSp[n].node.active=t,this.SeatWaits[n].active=!t,this.WeaponUI[n].getChildByName("btn_add").active=t&&c.HQLConst.once.userId===e,this.WeaponUI[n].getChildByName("btn_minus").active=t&&c.HQLConst.once.userId===e,c.HQLConst.once.userId===e&&o){for(var s=[cc.fadeIn(.1)],a=0;a<8;a++)s.push(cc.moveTo(.5,cc.v2(0,a%2==0?160:190)));s.push(cc.fadeOut(.1));var r=i.getChildByName("sp_there");r.active=!0,r.stopAllActions(),r.runAction(cc.sequence(s))}}catch(h){cc.log("setConvertWeaponActive---\x3e"+JSON.stringify(h))}},t.prototype.initViewData=function(){for(var e=this.WeaponUI,t=0;t<4;t++){var o=e[t];o.getChildByName("sp_lock").getComponent(cc.Sprite).spriteFrame=l.default.once.getFrameByName("icon_locking");var n=cc.find("an_pao/an_pao",o).getComponent(cc.Sprite);this.arr_weaponSp[t]=n,n.node.children[0].active=!1,this.DoubleBg.push(o.getChildByName("an_cannon")),cc.find("btn_add",o).on("click",this.onClickedAdd,this),cc.find("btn_minus",o).on("click",this.onClicked__,this),cc.find("btn_add",o).active=!1,cc.find("btn_minus",o).active=!1,this.arr_golds.push(o.getChildByName("lb_level").getComponent(cc.Label)),this.arr_weapons.push(o.getChildByName("tip"));var i=o.getChildByName("layer_line").getComponent(cc.Layout);i.spacingY=this.spacingY,this.arr_lines.push(i);var s=o.getChildByName("sp_lock");this.arr_circle.push(s),this.arrLevels.push(0)}},t.prototype.setTimelimit=function(e){this._limitTime=e},Object.defineProperty(t.prototype,"timeLimit",{get:function(){return this._limitTime<=0&&this._canFire},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"balanceLimit",{get:function(){var e=this.getLevelCoinByUID();return c.HQLConst.once.Entries>=e},enumerable:!1,configurable:!0}),t.prototype.setClickLimit=function(e){this._canFire=e},t.prototype.paramAniName=function(e){return e<2&&(e=2),e>4&&(e=4),"paotong"+e+"_0"},t.prototype.getLevelCoinByUID=function(e){void 0===e&&(e=404);var t=404===e?c.HQLConst.once.userId:e,o=l.default.once.userConvertIndex(t);return parseFloat(this.arr_golds[o].string)},t.prototype.refreshWeaponByIndex=function(e,t){var o=this.arrLevels[e];if(void 0!==o){var n=this.paramAniName(o,t),i=this.arr_weaponSp[e];i.spriteFrame=c.HQLConst.once.UIAtals.getSpriteFrame(n),o<2&&(o=2),o>4&&(o=4),i.node.children[0].getComponent(cc.Sprite).spriteFrame=c.HQLConst.once.UIAtals.getSpriteFrame("fire"+o)}},t.prototype.showChangeWeaponByIndex=function(e){var t=this.arrLevels[e],o=this.paramAniName(t,1);t<2&&(t=2),t>4&&(t=4),this.arr_weaponSp[e].spriteFrame=c.HQLConst.once.UIAtals.getSpriteFrame(o),this.arr_weaponSp[e].node.children[0].getComponent(cc.Sprite).spriteFrame=c.HQLConst.once.UIAtals.getSpriteFrame("fire"+t)},t.prototype.setLevelByUID=function(e,t){var o=l.default.once.userConvertIndex(e);l.default.once.playSFX("weapon_change"),this.arrLevels[o]=t,this.showChangeWeaponByIndex(o)},t.prototype.cleanInfoByTid=function(e){var t=l.default.once.tableConvertIndex(e);this.arrLevels[t]=0,this.showDoubleByIndex(t,0),this.arr_weaponSp[t].node.active=!1,this.arr_golds[t].node.active=!1,this.DoubleBg[t].active=!1,this.WeaponUI[t].active=!1,this.SeatWaits[t].active=!0,this.setLockFishByTid(e)},t.prototype.hideLockLineByIndex=function(e){var t=this.arr_lines[e];t&&(t.node.active=!1,this.arr_circle[e].active=!1)},t.prototype.showLockLineByTid=function(e,t){if(t instanceof r.default){var o=t.getWorldPoint(),n=l.default.once.tableConvertIndex(e);this.changeWeaponRotationByTid(o,e,!1);var i=this.arr_weapons[n],s=this.arr_circle[n];s.position=i.parent.convertToNodeSpaceAR(o),s.active=!0;var a=this.arr_lines[n];a.node.angle=i.angle;var h=this.getWeaponOutPositionByTid(e,100);a.node.position=a.node.parent.convertToNodeSpaceAR(h),a.node.scale=1;var p=o.sub(h).mag()-10;a.height=p;var d=p/(36+this.spacingY);d=Math.ceil(d)-1;for(var f=a.node.children.length,u=0;u<d||u<f;u++){var y=a.node.children[u];y||((y=cc.instantiate(a.node.children[0])).active=!1,y.getComponent(cc.Sprite).spriteFrame=c.HQLConst.once.UIAtals.getSpriteFrame("anchoro0")),y.scale=1,a.node!==y.parent&&(y.parent=a.node),y.active!==u<d&&(y.active=u<d)}a.node.active=!0}},t.prototype.getConvertWeaponRotationByTid=function(e,t,o){void 0===o&&(o=0);var n=l.default.once.tableConvertIndex(t),i=this.arr_weapons[n];if(cc.isValid(i)){var s=o,a=i.convertToWorldSpaceAR(cc.v2(0,s));return l.default.once.convertPointToAngle(a,e)-90}},t.prototype.getWeaponRotationByTid=function(e){var t=l.default.once.tableConvertIndex(e);return this.arr_weapons[t].angle},t.prototype.getWeaponLowerPositionByTid=function(e){var t=l.default.once.tableConvertIndex(e);return this.arr_weapons[t].convertToWorldSpaceAR(cc.v2(0,0))},t.prototype.onTouchStart=function(e,t){void 0===t&&(t=null),l.default.once.playSFX("click");var o=e.getLocation(),n=l.default.once.tableConvertIndex(),i=this.WeaponUI[n],s=i.getChildByName("btn_add").convertToWorldSpaceAR(cc.v2(0,0)),a=i.getChildByName("btn_minus").convertToWorldSpaceAR(cc.v2(0,0));s.sub(o).mag()<50||a.sub(o).mag()<50||-1!=c.HQLConst.once.seatId&&(c.HQLConst.once.IsAuto&&this.onTouchMove(e),this.getLockFishByTid(c.HQLConst.once.seatId)instanceof r.default||this.changeWeaponRotationByTid(e.getLocation(),c.HQLConst.once.seatId),t instanceof r.default&&c.HQLConst.once.IsLock&&l.default.once.CmdBYLockFish(t),this.clickFire(o),this.AutoFire=!0)},t.prototype.onTouchMove=function(e){-1!=c.HQLConst.once.seatId&&(this._touchPoint=e.getLocation(),this.getLockFishByTid(c.HQLConst.once.seatId)instanceof r.default||this.changeWeaponRotationByTid(e.getLocation(),c.HQLConst.once.seatId))},t.prototype.onTouchEnd=function(e){this.AutoFire=!1,-1!=c.HQLConst.once.seatId&&(this.getLockFishByTid(c.HQLConst.once.seatId)instanceof r.default||this.changeWeaponRotationByTid(e.getLocation(),c.HQLConst.once.seatId))},t.prototype.clickFire=function(e){this._limitTime>0||-1===c.HQLConst.once.seatId||(c.HQLConst.once.IsAuto?this._touchPoint=e:l.default.once.onTouchWindow(e))},t.prototype.changeWeaponRotationByTid=function(e,t,o){void 0===o&&(o=!0);var n=l.default.once.tableConvertIndex(t);if(this.arr_weapons[n]&&this.arr_weaponSp[n]){n>1&&o&&(e.y=cc.view.getVisibleSize().height-e.y);var i=-this.getConvertWeaponRotationByTid(e,t);this.arr_weapons[n].angle=i,this.arr_weaponSp[n].node.parent.angle=i}},t.prototype.getWeaponOutPositionByTid=function(e,t){void 0===t&&(t=c.HQLConst.once.WeaponHight);var o=l.default.once.tableConvertIndex(e);return this.arr_weapons[o].convertToWorldSpaceAR(cc.v2(0,t))},t.prototype.getLockFishByTid=function(e){var t=l.default.once.tableConvertIndex(e);return this.arr_locks[t]},t.prototype.onClickedAdd=function(){l.default.once.playSFX("click"),this.changeWeaponBet(1)},t.prototype.onClicked__=function(){l.default.once.playSFX("click"),this.changeWeaponBet(-1)},t.prototype.changeWeaponBet=function(e){var t=c.HQLConst.once.BLevel;(t+=e)>=c.HQLConst.once.BLevels.length&&(t=0),t<0&&(t=c.HQLConst.once.BLevels.length-1),l.default.once.requestChangeCannonBet(JSON.stringify({userid:c.HQLConst.once.userId,bet:c.HQLConst.once.BLevels[t]}))},t.prototype.showWeapon=function(e){var t=a.default.deepCopy(e),o=l.default.once.userConvertIndex(t.userid),n=this.getLockFishByTid(t.seatId);if(t.userid!=c.HQLConst.once.userId){var i=n instanceof r.default?n.getWorldPoint():cc.v2(t.touch.x,t.touch.y);this.changeWeaponRotationByTid(i,t.seatId)}var s=this.arrLevels[o],h=this.arr_weaponSp[o];if(h.node.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,-10)),cc.moveBy(.1,cc.v2(0,10)))),h.node.children[0].stopAllActions(),h.node.children[0].active=!0,h.node.children[0].opacity=0,h.node.children[0].runAction(cc.sequence(cc.fadeIn(.05),cc.delayTime(.1),cc.callFunc(function(){h.node.children[0].active=!1}))),t.lock=n.fishId,t.level=s,l.default.once.GameLayer.addBullet(t),t.seatId===c.HQLConst.once.seatId){s<1&&(s=1);var p=t.isDrill?"s208":"v"+s;l.default.once.playSFX(p),this.firstFire=!1,l.default.once.GameLayer.EffectLayer.showLable(this._limitTime)}},t.prototype.setLockFishByTid=function(e,t){var o=l.default.once.tableConvertIndex(e),n=this.getLockFishByTid(e);n instanceof r.default&&n.popLockTid(e),this.hideLockLineByIndex(o),t instanceof r.default?this.arr_locks[o]=t:this.arr_locks[o]=c.HQLConst.once.NotFound},t.prototype.cleanFishAllWeaponLock=function(e){for(var t=0;t<4;t++){var o=this.getLockFishByTid(t);e.fishId===o.fishId&&this.setLockFishByTid(t)}},t.prototype.touchFishIsLock=function(e){var t=this.getLockFishByTid(c.HQLConst.once.seatId);return c.HQLConst.once.IsLock&&(t instanceof r.default&&t.fishId!==e.fishId||!(t instanceof r.default))},t.prototype.showDoubleByIndex=function(e,t){void 0===t&&(t=30);var o=this.DoubleBg[e];o.active=!0,o.stopAllActions(),o.runAction(cc.sequence(cc.delayTime(t),cc.callFunc(function(){o.active=!1})))},t.prototype.checkAutoLock=function(){if(-1!=c.HQLConst.once.seatId&&c.HQLConst.once.IsLock&&!(this.getLockFishByTid(c.HQLConst.once.seatId)instanceof r.default)){var e=l.default.once.getMaxFish();e instanceof r.default&&l.default.once.CmdBYLockFish(e)}},t.prototype.update=function(e){cc.isValid(this.node)&&(this.LastFireTime-=e,this._limitTime-=e,this.LastFireTime<-999998||(this.LastFireTime<-60&&l.default.once.GameLayer.EffectLayer.showLable(this.LastFireTime),this.LastFireTime<-91&&this.LastFireTime>-190&&(this.LastFireTime=-999999,l.default.once.GameLayer.MenuLayer.onClickedBack())))},t.prototype.onDestroy=function(){this.unschedule(this.speed0),this.unschedule(this.speed1)},s([d(cc.Node)],t.prototype,"FishParent",void 0),s([d([cc.Node])],t.prototype,"SeatWaits",void 0),s([d([cc.Node])],t.prototype,"WeaponUI",void 0),s([d([cc.Node])],t.prototype,"DoubleBg",void 0),s([p],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./HQLConst":"HQLConst","./HQLFish":"HQLFish","./HQLManager":"HQLManager"}]},{},["HQLBill","HQLBullet","HQLCoin","HQLConst","HQLEffect","HQLEffectLayer","HQLFish","HQLFishNet","HQLLabel","HQLLoading","HQLManager","HQLMenu","HQLNetWork","HQLScene","HQLUser","HQLWeapon"]);