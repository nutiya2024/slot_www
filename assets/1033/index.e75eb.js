window.__require=function e(t,n,o){function i(a,r){if(!n[a]){if(!t[a]){var l=a.split("/");if(l=l[l.length-1],!t[l]){var s="function"==typeof __require&&__require;if(!r&&s)return s(l,!0);if(c)return c(l,!0);throw new Error("Cannot find module '"+a+"'")}a=l}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){return i(t[a][1][e]||e)},u,u.exports,e,t,n,o)}return n[a].exports}for(var c="function"==typeof __require&&__require,a=0;a<o.length;a++)i(o[a]);return i}({S146Const:[function(e,t,n){"use strict";cc._RF.push(t,"7d7d15WRzJLv50yL7VT87sA","S146Const");var o=this&&this.__decorate||function(e,t,n,o){var i,c=arguments.length,a=c<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(c<3?i(a):c>3?i(t,n,a):i(t,n))||a);return c>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var i=cc._decorator,c=i.ccclass,a=(i.property,99999999),r=function(){function e(){this.GameLayer=null,this.GameNet=null,this.PlayerInfo=null,this.Speed=!1,this.Auto=!1,this.Entries=0,this.Winning=0,this.WinPool=0,this.AniLimit=null,this.SwingCD=300,this.AniIndex=-1,this.RunIndex=[a,a,a,a,a],this.CurSpeedTime=[0,0,0,0,0],this.BuffaloIndex=-1,this.Speeds=null,this.JPES=0,this.BET=[1,2,3,4,5,6,7,8,10,12,14,17,20,25,30,40,50,60],this.LINES=25,this.BETNUM=25,this.LotteryRes=null,this.BuffaloRes=null,this.BuffaloType=null,this.FevenRes=null,this.FevenTurn=null,this.FevenTimes=3,this.FevenCountIndex=0,this.FevenIndex=[a,a,a],this.FevenSpeedTime=[0,0,0,0,0],this.MaxIndex=a,this.ClickLimitTime=0,this.OpenRunTime=1.5,this.MapEffects=new Map,this.MapAtlas=new Map}var t;return t=e,Object.defineProperty(e,"once",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),e.destroyInstance=function(){t._instance&&(t._instance=null)},t=o([c],e)}();n.default=r,cc._RF.pop()},{}],S146Effect:[function(e,t,n){"use strict";cc._RF.push(t,"5b5a0GGKvJPArGUCPDD7R6x","S146Effect");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=this&&this.__decorate||function(e,t,n,o){var i,c=arguments.length,a=c<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(c<3?i(a):c>3?i(t,n,a):i(t,n))||a);return c>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../../Script/utils/Utils"),r=e("./S146Const"),l=cc._decorator,s=l.ccclass,u=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btnCoinUp=null,t.bull=[],t.chooseBull=[],t.runBull=null,t.tap=null,t.kuang=null,t.AllWin=null,t.smoke=null,t.feven=null,t.free=null,t.runLayer=null,t.LayerRunBull=null,t.LayerSmoke=null,t.LayerFly=null,t.LayerFeven=null,t.LayerNormal=null,t.LayerFree=null,t.FevenTitle=null,t.LayerExtra=null,t.LayerChoose=null,t.SpExtra=null,t.FevenTimes=null,t.lines=[],t.pat_line3=null,t.freeBulls=[],t.skWood=null,t.SpIcons=[],t.poolRunBull=null,t.poolSmoke=null,t.poolShan=null,t.poolFlyBull=null,t.poolFlyBullBg=null,t.poolStar=null,t._cdChoose=32,t._clickChoose=!1,t._cdChooseBull=32,t._clickChooseBull=!1,t}return i(t,e),t.prototype.onLoad=function(){this.poolRunBull=this.createPool(30,this.runBull.node),this.poolSmoke=this.createPool(60,this.smoke),this.poolFlyBull=this.createPool(30,this.node.getChildByName("fly_bull")),this.poolFlyBullBg=this.createPool(30,this.kuang),this.poolShan=this.createPool(30,this.node.getChildByName("par_shan")),this.poolStar=this.createPool(30,this.node.getChildByName("par_star")),this._lbCdChoose=cc.find("layer_action/lb_cd",this.LayerChoose).getComponent("S146Label"),this._lbCdCooseBull=cc.find("layer_chooseBull/lb_cd",this.node).getComponent("S146Label");for(var e=0;e<this.chooseBull.length;e++)this.chooseBull[e].setCompleteListener(this.onFinishChooseBull.bind(this));this._lbFevenBunus=this.FevenTitle.getChildByName("lb_bouns").getComponent("S146Label"),this._lbFevenTimes=this.FevenTimes.getChildByName("lb_cd").getComponent("S146Label"),this._lbOfStart=cc.find("layer_title/lb_start",this.LayerFree).getComponent("S146Label"),this._lbOfEnd=cc.find("layer_title/lb_end",this.LayerFree).getComponent("S146Label"),this._lbYWin=cc.find("layer_effect2/layer_ywin/lb_gold",this.node.parent).getComponent("S146Label"),this._lbBWin=cc.find("layer_effect2/layer_bwin/lb_gold",this.node.parent).getComponent("S146Label")},t.prototype.onFinishChooseBull=function(){},t.prototype.showBullSwing=function(e){void 0===e&&(e=[0,1,2]),r.default.once.GameLayer.playSFX("winnigStart");for(var t=function(t){if(-1!=e.indexOf(t)){var o=n.bull[t];o.setAnimation(0,"winning",!1),o.node.runAction(cc.sequence(cc.delayTime(4.3),cc.callFunc(function(){o.setAnimation(0,"idle",!0)})))}},n=this,o=0;o<this.bull.length;o++)t(o)},t.prototype.showBigWin=function(e,t){var n=this;void 0===e&&(e=0);var o=[this._lbYWin,this._lbBWin][e];r.default.once.GameLayer.playBGM(["bigWin","magWin"][e]),this._lbBWin.node.parent.getChildByName("pat_star").getComponent(cc.ParticleSystem).resetSystem(),o.node.parent.active=!0,o.string="0";var i=t/300,c=[];o.string="0";for(var a=function(e){c.push(cc.callFunc(function(){var t=i*e;o.string=""+r.default.once.GameLayer.changeGold(t)})),c.push(cc.delayTime(8/300)),40==e&&c.push(cc.callFunc(function(){n.btnCoinUp.active=!0}))},l=0;l<300;l++)a(l);c.push(cc.callFunc(function(){o.string=""+r.default.once.GameLayer.changeGold(t)})),c.push(cc.delayTime(1)),c.push(cc.callFunc(function(){n.shopBigWin()})),o.node.stopAllActions(),o.node.runAction(cc.sequence(c))},t.prototype.shopBigWin=function(){this._lbYWin.node.parent.active=!1,this._lbBWin.node.parent.active=!1,this.btnCoinUp.active=!1,this._lbBWin.node.stopAllActions(),this._lbYWin.node.stopAllActions(),r.default.once.AniLimit=0,r.default.once.GameLayer.finishOnceLoop(),r.default.once.GameLayer.playBGM(null)},t.prototype.runAllWin=function(e){var t=this,n=cc.view.getVisibleSize().width/2+this.AllWin.width/2+200;this.AllWin.setPosition(n,this.AllWin.y),this.AllWin.setScale(.8),this.AllWin.active=!0,this.AllWin.runAction(cc.sequence(cc.delayTime(e),cc.moveTo(1,cc.v2(0,this.AllWin.y)),cc.scaleTo(.5,.85),cc.scaleTo(.5,.8),cc.callFunc(function(){}),cc.scaleTo(1,0),cc.callFunc(function(){t.AllWin.active=!1})))},t.prototype.clearFlyBull=function(){for(var e=this.LayerFly.children.length-1;e>=0;e--){var t=this.LayerFly.children[e];"flyIcon"==t.name&&this.poolFlyBull.put(t)}},t.prototype.flyBullBack=function(e){for(var t=this,n=0,o=!0,i=function(t){var i=c.SpIcons[t],a=Math.floor(t/5)+1,l=Math.floor(t%5),s=e[l][a];if(i.node.active&&i.spriteFrame){n=5;var u=c.getNodeByPool(c.poolFlyBull);u.active=!0,u.opacity=0,u.stopAllActions(),u.name="flyIcon",u.getChildByName("sp").getComponent(cc.Sprite).spriteFrame=r.default.once.GameLayer.ICON.getSpriteFrame("icon_"+r.default.once.BuffaloType),u.parent=c.LayerFly,u.getChildByName("low").active=!1,u.getChildByName("top").active=!0;var d=i.node.convertToWorldSpaceAR(cc.v2(0,0));d=c.LayerFly.convertToNodeSpaceAR(d),u.position=d;var p=s.node.convertToWorldSpaceAR(cc.v2(0,0));p=c.LayerFly.convertToNodeSpaceAR(p);var f=[];f.push(cc.delayTime(2)),f.push(cc.callFunc(function(){u.opacity=255,i.spriteFrame=null,i.node.active=!1})),f.push(cc.scaleTo(.3,1.2)),o&&(f.push(cc.callFunc(function(){r.default.once.GameLayer.playSFX("flyBull2")})),o=!1),f.push(cc.spawn(cc.moveTo(1,p),cc.scaleTo(1,1))),f.push(cc.callFunc(function(){u.getChildByName("top").active=!1})),u.runAction(cc.sequence(f))}},c=this,a=0;a<this.SpIcons.length;a++)i(a);this.scheduleOnce(function(){t.showExtra()},n)},t.prototype.flyBull=function(e,t){for(var n=this,o=!0,i=function(i){if(e[i]==r.default.once.BuffaloType){var a=c.getNodeByPool(c.poolFlyBull);a.active=!0,a.stopAllActions(),a.getChildByName("low").active=!0,a.getChildByName("top").active=!1;var l=a.getChildByName("sp").getComponent(cc.Sprite),s={9:"lan",8:"hong",10:"huang"};l.spriteFrame=r.default.once.GameLayer.ICON.getSpriteFrame("icon_"+r.default.once.BuffaloType);var u=a.getChildByName("bg").getComponent(cc.Sprite);u.node.stopAllActions(),u.node.active=!0,u.node.opacity=0,u.spriteFrame=r.default.once.GameLayer.ICON.getSpriteFrame(s[r.default.once.BuffaloType]);var d=c.SpIcons[i].node.convertToWorldSpaceAR(cc.v2(0,0));a.parent=c.LayerFly;var p=Math.floor(i/5)+1,f=Math.floor(i%5),h=t[f][p].node.convertToWorldSpaceAR(cc.v2(0,0));h=c.LayerFly.convertToNodeSpaceAR(h),d=c.LayerFly.convertToNodeSpaceAR(d),a.setPosition(h.x,h.y);var y=[];y.push(cc.scaleTo(.3,1.2)),o&&(y.push(cc.callFunc(function(){r.default.once.GameLayer.playSFX("flyBull")})),o=!1);var v=c.SpIcons[i].node.convertToWorldSpaceAR(cc.v2(0,{9:0,8:15,10:5}[r.default.once.BuffaloType]));v=c.LayerFly.convertToNodeSpaceAR(v);var g=c.getNodeByPool(c.poolShan);g.parent=c.LayerFly,g.setPosition(v.x,v.y-5),g.opacity=0,g.active=!0;var m=g.getComponent(cc.ParticleSystem),S=c.getNodeByPool(c.poolStar);S.parent=c.LayerFly,S.setPosition(v.x,v.y),S.opacity=0,S.active=!0;var _=S.getComponent(cc.ParticleSystem);y.push(cc.spawn(cc.moveTo(.8,d),cc.scaleTo(.8,1))),y.push(cc.callFunc(function(){g.opacity=255,m.resetSystem(),S.opacity=255,_.resetSystem(),n.SpIcons[i].spriteFrame=l.spriteFrame,n.SpIcons[i].node.active=!0,u.node.opacity=0,n.poolFlyBull.put(a)})),a.runAction(cc.sequence(y));var F=c.getNodeByPool(c.poolFlyBullBg);F.getComponent(cc.Sprite).spriteFrame=r.default.once.GameLayer.ICON.getSpriteFrame(s[r.default.once.BuffaloType]),F.parent=c.LayerFly,F.stopAllActions(),F.setScale(1),F.active=!0,F.opacity=0,F.setPosition(v.x,v.y),F.runAction(cc.sequence(cc.delayTime(1.7),cc.blink(2,5),cc.callFunc(function(){n.poolShan.put(g),n.poolStar.put(S),n.poolFlyBullBg.put(F)})))}},c=this,a=0;a<e.length;a++)i(a)},t.prototype.hideTap=function(){this.tap.active=!1},t.prototype.showExtra=function(){var e=this;this.LayerExtra.active=!0,this._lbOfEnd.node.active=this._lbOfStart.node.active=cc.find("layer_title/of",this.LayerFree).active=!1;var t=this.LayerExtra.getChildByName("sp_mask");t.opacity=150,t.runAction(cc.sequence(cc.delayTime(3.3),cc.fadeOut(.5)));var n=this.LayerExtra.getChildByName("extra");n.opacity=255,n.setPosition(0,-333);var o=this.SpExtra.convertToWorldSpaceAR(cc.v2(0,0));o=n.parent.convertToNodeSpaceAR(o),n.setScale(0),r.default.once.GameLayer.playSFX("ex"),n.runAction(cc.sequence(cc.scaleTo(.5,.7),cc.delayTime(1.8),cc.spawn(cc.moveTo(1,o),cc.scaleTo(1,.3)),cc.callFunc(function(){r.default.once.GameLayer.refreshBuffaloRes(),n.opacity=0,e.SpExtra.active=!0,e.SpExtra.opacity=255})))},t.prototype.createPool=function(e,t){var n=new cc.NodePool;n.prefab=t;for(var o=0;o<e;o++)n.put(cc.instantiate(t));return n},t.prototype.getNodeByPool=function(e){var t=e.get();return t||(t=cc.instantiate(e.prefab)),t},t.prototype.showEffectType=function(e){5==e&&this.showWood(),6==e&&this.onClickFree(0)},t.prototype.showNetError=function(){var e=this.node.getChildByName("retry");e.active=!0,e.opacity=0,e.runAction(cc.sequence(cc.fadeIn(.2),cc.delayTime(1.5),cc.callFunc(function(){e.active=!1})))},t.prototype.showWood=function(){this._clickChoose=!1,this.skWood.node.parent.getChildByName("mask").opacity=150,this.skWood.node.parent.setPosition(0,0),this.skWood.setAnimation(0,"animation",!1),this.free.active=this.feven.active=this.skWood.node.parent.active=!0;var e=this.skWood.node.parent.getChildByName("layer_action");this.free.opacity=this.feven.opacity=255,e.opacity=0,this._cdChoose=31,e.active=!0,e.runAction(cc.sequence(cc.delayTime(1),cc.fadeIn(.5),cc.delayTime(.7),cc.callFunc(function(){r.default.once.GameLayer.playBGM("free5")})))},t.prototype.showChooseBull=function(){this._cdChooseBull=32;var e=this.chooseBull[0].node.parent;e.active=!0,e.opacity=0,e.runAction(cc.fadeIn(.2)),this._clickChooseBull=!1;for(var t=0;t<this.chooseBull.length;t++)this.chooseBull[t].setAnimation(0,"idle",!0)},t.prototype.hideWood=function(e,t,n){var o=this;void 0===n&&(n=function(){}),this._clickChoose=!0,e.color=cc.Color.WHITE,t.runAction(cc.sequence(cc.fadeOut(1),cc.callFunc(function(){r.default.once.GameLayer.playSFX("suolian"),o.skWood.node.parent.runAction(cc.moveBy(2,cc.v2(0,1500))),o.skWood.node.parent.getChildByName("mask").runAction(cc.fadeOut(2)),n(),t.active=!1})))},t.prototype.refreshFreeOfStart=function(){this._lbOfStart.string=r.default.once.BuffaloIndex+1},t.prototype.refreshFevenBonus=function(){var e=0;for(var t in r.default.once.FevenRes.feverResult.startIdx){var n=r.default.once.FevenRes.feverResult.startIdx[t];e+=r.default.once.FevenRes.viewarray.nBet*parseFloat(n)}this._lbFevenBunus.string=r.default.once.GameLayer.changeGold(e)},t.prototype.refreshFevenTime=function(){this._lbFevenTimes.string=r.default.once.FevenTimes},t.prototype.shakeRunLayer=function(e,t,n){void 0===e&&(e=0),void 0===t&&(t=function(){}),void 0===n&&(n=80);var o=[];o.push(cc.delayTime(e));for(var i=this.runLayer.position,c=0;c<n;c++){var r=a.default.randomNum(0,20)-10,l=a.default.randomNum(0,20)-10;o.push(cc.moveTo(.04,cc.v2(i.x+r,i.y+l)))}o.push(cc.moveTo(.04,cc.v2(i.x,i.y))),o.push(cc.callFunc(t,this)),this.runLayer.runAction(cc.sequence(o))},t.prototype.showRunBull=function(e,t){var n=this;void 0===t&&(t=0);var o=cc.view.getVisibleSize().height/10,i=2*-cc.view.getVisibleSize().width;this.scheduleOnce(function(){r.default.once.GameLayer.playSFX("runBull")},e);for(var c=function(c){var r=l.getNodeByPool(l.poolRunBull);r.stopAllActions(),r.parent=l.LayerRunBull,r.active=!0;var s=c%10*o+(a.default.randomNum(0,o)-o/2)-cc.view.getVisibleSize().height/2,u=.27*Math.floor(c/10)+e+a.default.randomNum(0,1,2)-.5;r.setPosition(cc.view.getVisibleSize().width,s+t);var d=[];d.push(cc.delayTime(u)),d.push(cc.moveBy(1.2,cc.v2(i,0))),d.push(cc.callFunc(function(){n.poolRunBull.put(r)})),r.runAction(cc.sequence(d));var p=l.getNodeByPool(l.poolSmoke);p.parent=l.LayerSmoke,p.active=!0,p.setPosition(cc.view.getVisibleSize().width,s+t),p.opacity=0,p.runAction(cc.sequence(cc.delayTime(u),cc.fadeTo(.1,255),cc.moveBy(1.2,cc.v2(i,0)),cc.callFunc(function(){n.poolSmoke.put(p)})))},l=this,s=0;s<120;s++)c(s)},t.prototype.showFevenRun=function(){var e=this;this.LayerFree.active=!1,r.default.once.GameLayer.playBGM("fevenBgm"),this.LayerFeven.active=this._lbFevenTimes.node.parent.active=this._lbFevenBunus.node.parent.active=!0,r.default.once.GameLayer.setLine3Active(),this.LayerFeven.height=400,this._lbFevenTimes.node.parent.scale=this._lbFevenBunus.node.parent.scale=.3,this._lbFevenTimes.string=3,this._lbFevenTimes.node.parent.runAction(cc.sequence(cc.scaleTo(1.5,1.25),cc.scaleTo(1,1))),this._lbFevenBunus.node.parent.runAction(cc.sequence(cc.scaleTo(1.5,1.25),cc.scaleTo(1,1)));var t=cc.delayTime(1),n=[];n.push(t);for(var o=0;o<90;o++)n.push(cc.callFunc(function(){e.LayerFeven.height+=385/90})),n.push(cc.delayTime(1.5/90));for(n.push(cc.callFunc(function(){e.LayerFeven.height=785})),this.LayerFeven.runAction(cc.sequence(n)),o=0;o<4;o++)this.lines[o].scale=1.041,this.lines[o].runAction(cc.sequence(t,cc.scaleTo(1.5,1,2.1)));this.lines[4].setPosition(-2,213.7),this.lines[4].runAction(cc.sequence(t,cc.moveTo(1.5,cc.v2(-2,600))))},t.prototype.closeFecenRun=function(){this.lines[4].setPosition(-2,213.7);for(var e=0;e<4;e++)this.lines[e].scale=1.041;this._lbFevenTimes.node.parent.active=this._lbFevenBunus.node.parent.active=!1},t.prototype.onClickFeven=function(){this._clickChoose||(r.default.once.GameLayer.playSFX("btnFreeType"),r.default.once.GameNet.sendSelectFreeType(1))},t.prototype.onClickFree=function(){var e=this;this._clickChoose||(r.default.once.GameLayer.playSFX("btnFreeType"),r.default.once.GameLayer.playBGM("chooseBull"),r.default.once.GameNet.sendSelectFreeType(2),this.hideWood(this.free,this.feven,function(){e.shakeRunLayer(2,e.showChooseBull),e.showRunBull(2.5)}))},t.prototype.resetUI=function(){var e=this.chooseBull[0].node.parent;e.stopAllActions(),e.active=!1,this.LayerFeven.active=!1,this.LayerFree.active=!1,this.hideFevenLayer(),this.closeFecenRun()},t.prototype.onClickBull=function(e,t){if(!this._clickChooseBull){r.default.once.GameLayer.playSFX("swiningAll"),t=parseInt(t),this._clickChooseBull=!0,this.chooseBull[t].setAnimation(0,"winning",!1);for(var n=0;n<this.chooseBull.length;n++)this.chooseBull[n].node.color=n==t?cc.Color.WHITE:cc.Color.GRAY;this.shakeRunLayer(2.5,function(){},120),this.showRunBull(2.8);var o=this.chooseBull[0].node.parent;for(o.stopAllActions(),o.runAction(cc.sequence(cc.delayTime(3),cc.fadeOut(2),cc.delayTime(3.5),cc.callFunc(function(){o.active=!1,r.default.once.GameNet.sendSelectFreeBuffaloType([2,1,3][t])}))),n=void 0;n<this.SpIcons.length;n++)this.SpIcons[n].spriteFrame=null,this.SpIcons[n].node.active=!1;this.LayerFree.opacity=0,this.LayerFree.active=!0,this.LayerFree.stopAllActions();var i=cc.find("layer_title/sp_bull",this.LayerFree).getComponent(cc.Sprite);i.spriteFrame=this.freeBulls[t],this._lbOfEnd.node.active=this._lbOfStart.node.active=cc.find("layer_title/of",this.LayerFree).active=!0,this._lbOfStart.string=0,this._lbOfEnd.string=[7,5,10][t],this.SpExtra.opacity=0,i.node.x=[0,0,-17][t],this.LayerFree.runAction(cc.sequence(cc.delayTime(4.5),cc.fadeIn(2),cc.callFunc(function(){r.default.once.GameLayer.playBGM("free10",!0)})))}},t.prototype.hideFevenLayer=function(){r.default.once.GameLayer.playBGM("bgm",!0),this.LayerFeven.active=this._lbFevenTimes.node.parent.active=this._lbFevenBunus.node.parent.active=!1,this.lines[4].setPosition(-2,213.7)},t.prototype.showLine3=function(){this.pat_line3.active=!0},t.prototype.hideLine3=function(){this.pat_line3.active=!1},t.prototype.update=function(e){if(this._cdChoose-=e,this.skWood.node.parent.active&&!this._clickChoose){this._cdChoose<=0&&(this._cdChoose=0,this.onClickFeven(0));var t=Math.floor(this._cdChoose);this._lbCdChoose.string=t,this.feven.color=t%2==0?cc.Color.WHITE:cc.Color.WHITE.fromHEX("A9A9A9"),this.free.color=t%2!=0?cc.Color.WHITE:cc.Color.WHITE.fromHEX("A9A9A9")}if(this._cdChooseBull-=e,this.chooseBull[0].node.parent.active&&!this._clickChooseBull){this._cdChooseBull<=0&&(this._cdChooseBull=0,this.onClickBull(0,0)),t=Math.floor(this._cdChooseBull);for(var n=0;n<this.chooseBull.length;n++)this.chooseBull[n].node.color=n==t%3?cc.Color.WHITE:cc.Color.GRAY;this._lbCdCooseBull.string=t}},c([u(cc.Node)],t.prototype,"btnCoinUp",void 0),c([u([sp.Skeleton])],t.prototype,"bull",void 0),c([u([sp.Skeleton])],t.prototype,"chooseBull",void 0),c([u(sp.Skeleton)],t.prototype,"runBull",void 0),c([u(cc.Node)],t.prototype,"tap",void 0),c([u(cc.Node)],t.prototype,"kuang",void 0),c([u(cc.Node)],t.prototype,"AllWin",void 0),c([u(cc.Node)],t.prototype,"smoke",void 0),c([u(cc.Node)],t.prototype,"feven",void 0),c([u(cc.Node)],t.prototype,"free",void 0),c([u(cc.Node)],t.prototype,"runLayer",void 0),c([u(cc.Node)],t.prototype,"LayerRunBull",void 0),c([u(cc.Node)],t.prototype,"LayerSmoke",void 0),c([u(cc.Node)],t.prototype,"LayerFly",void 0),c([u(cc.Node)],t.prototype,"LayerFeven",void 0),c([u(cc.Node)],t.prototype,"LayerNormal",void 0),c([u(cc.Node)],t.prototype,"LayerFree",void 0),c([u(cc.Node)],t.prototype,"FevenTitle",void 0),c([u(cc.Node)],t.prototype,"LayerExtra",void 0),c([u(cc.Node)],t.prototype,"LayerChoose",void 0),c([u(cc.Node)],t.prototype,"SpExtra",void 0),c([u(cc.Node)],t.prototype,"FevenTimes",void 0),c([u([cc.Node])],t.prototype,"lines",void 0),c([u(cc.Node)],t.prototype,"pat_line3",void 0),c([u([cc.SpriteFrame])],t.prototype,"freeBulls",void 0),c([u(sp.Skeleton)],t.prototype,"skWood",void 0),c([u([cc.Sprite])],t.prototype,"SpIcons",void 0),c([s],t)}(cc.Component);n.default=d,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./S146Const":"S146Const"}],S146Label:[function(e,t){"use strict";cc._RF.push(t,"df8aeLMp19Ga4r2Pc6zjcBU","S146Label");var n=cc.Enum({LEFT:0,CENTER:1,RIGHT:2});cc.Class({editor:!1,extends:cc.Component,properties:{_layout:{get:function(){var e=this.node.getComponent(cc.Layout);return e||((e=this.node.addComponent(cc.Layout)).type=1),e}},string:{default:"",notify:function(){this._updateWordArt()}},alignType:{type:n,default:n.CENTER,notify:function(){this._checkAnchorX()}},defaultNames:{default:"2"},convert:{default:!1},spriteAtlas:{type:cc.SpriteAtlas,default:null}},onLoad:function(){this._checkAnchorX()},_checkAnchorX:function(){this.alignType===n.CENTER?this.node.anchorX=.5:this.node.anchorX=this.alignType===n.RIGHT?1:0},_updateWordArt:function(){if(!this.spriteAtlas)return cc.log("\u65e0\u6548\u7684 spriteAtlas \u56fe\u96c6\u8d44\u6e90\uff01");this._names=this.defaultNames.split(","),this.setWordArt()},setWordArt:function(){try{for(var e=(""+this.string).split(""),t=this.node.children,o=0,i=0;i<e.length||i<t.length;i++){var c=t[i];if(c||((a=(c=new cc.Node).addComponent(cc.Sprite)).trim=!1,a.sizeMode=cc.Sprite.SizeMode.RAW,a.type=cc.Sprite.Type.SIMPLE),c.parent||(c.parent=this.node),c.active=i<e.length,c.active){var a=c.getComponent(cc.Sprite),r=e[this.alignType!==n.CENTER?e.length-1-i:i];if("."===r&&(r="_"),r=this._names[0]+r,this._names[1]&&(r+=this._names[1]),void 0===r)return void cc.log("\u56fe\u96c6\u8d44\u6e90spriteAtlas \u627e\u4e0d\u5230\u56fe\u7247\u540d\u79f0\uff1a"+r+"\uff01");a.spriteFrame=this.spriteAtlas.getSpriteFrame(""+r),o+=c.width}}o+=(e.length+1)*this._layout.spacingX,this._layout.paddingLeft=this._layout.spacingX,this._layout.paddingRight=this._layout.spacingX,this.node.width=o,this.alignType===n.RIGHT&&(this._layout.horizontalDirection=1),this.alignType===n.LEFT&&(this._layout.horizontalDirection=1),this.alignType===n.CENTER&&(this._layout.horizontalDirection=0)}catch(l){cc.log(l)}}}),cc._RF.pop()},{}],S146Loading:[function(e,t,n){"use strict";cc._RF.push(t,"ce105dHTNVMg6holjhO+k0w","S146Loading");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=this&&this.__decorate||function(e,t,n,o){var i,c=arguments.length,a=c<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(c<3?i(a):c>3?i(t,n,a):i(t,n))||a);return c>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.GameLoadType=void 0;var a,r=e("../../../Script/utils/Utils"),l=e("./S146Const");(function(e){e[e.Sprite=0]="Sprite",e[e.Atlas=1]="Atlas",e[e.Skeleton=2]="Skeleton",e[e.ParticleAsset=3]="ParticleAsset",e[e.Prefab=4]="Prefab",e[e.Json=5]="Json"})(a=n.GameLoadType||(n.GameLoadType={}));var s=cc._decorator,u=s.ccclass,d=s.property,p=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.ex=null,e.flyBull2=null,e.flyBull=null,e.wua=null,e.fua=null,e.unSpeed=null,e.speed=null,e.jia=null,e.jian=null,e.wu=null,e.unAuto=null,e.auto=null,e.runDown=null,e.free5=null,e.free10=null,e.icon120=null,e.bgm=null,e.magWin=null,e.bigWin=null,e.btnStart=null,e.swiningAll=null,e.dingding=null,e.coinUp=null,e.chooseBull=null,e.runBull=null,e.wood=null,e.suolian=null,e.runLine3=null,e.btnFreeType=null,e.anDouble=null,e.fevenBgm=null,e.goldFly=null,e.winScale=null,e.coinUpEnd=null,e.effectsAtals=[],e.icon=null,e.s146=null,e.MusicDic={},e}return i(n,t),n.prototype.onLoad=function(){},n.prototype.playBGM=function(t,n){void 0===n&&(n=!0),0!=e("PlayerInfo").getInstant.musicControl&&(t=t||this.MusicDic[404],n&&(this.MusicDic[404]=t),this.play(t,!0,!0))},n.prototype.stopBGM=function(){cc.audioEngine.stopAll()},n.prototype.playEffect=function(t){0!=e("PlayerInfo").getInstant.soundEffectControl&&this.play(t,!1,!1)},n.prototype.stopEffect=function(e){this.MusicDic[e]&&cc.audioEngine.stop(this.MusicDic[e])},n.prototype.play=function(e,t,n){void 0===n&&(n=!1),t&&cc.audioEngine.stopAll();var o=this[e];o&&(this.MusicDic[e]=cc.audioEngine.play(o,t,1))},n.prototype.loadFinish=function(){l.default.once.PlayerInfo=e("PlayerInfo").getInstant;for(var t=[],n=["Coin_win_","Vfx_BlowOut_scal50_","s11_wild_","Diamond_","Mob_UpUI_Board_2_1280_Shine_","coin_2_","newcoin","coin_1_"],o=["icon","s146"],i=0;i<this.effectsAtals.length;i++)t.push(this.effectsAtals[i].getSpriteFrames());for(i=0;i<o.length;i++){var c=o[i];l.default.once.MapAtlas.set(c,this[c])}for(i=0;i<n.length;i++){var r=n[i],s=(c="string"==typeof r?r:r.key,r.space||10),u=this.getAni(t,c,a.Atlas,cc.WrapMode.Default,s);l.default.once.MapEffects.set(c,u)}},n.prototype.getAni=function(e,t,n,o,i,c,a){void 0===o&&(o=cc.WrapMode.Loop),void 0===c&&(c=null),void 0===a&&(a=1),i=i||10;var l=this.findArrayFile(e,t,n);if(l=this.desArray(l,[t]),1!==a){for(var s=[],u=0;u<a;u++)for(var d=0;d<l.length;d++)s.push(l[d]);l=s}var p=r.default.createWithSpriteFrames(l,i,"animateFrameChange",c);return p.name=t,p.wrapMode=o,p},n.prototype.findArrayFile=function(e,t,n){for(var o=[],i=null,c=0;c<e.length;c++){var l=e[c];if(n===a.Atlas)if(l instanceof Array)for(var s=0;s<l.length;s++){var u=l[s];if(-1!==u.name.indexOf(t)){var d=u.name.split(t);r.default.isNumber(d[1])&&o.push(u)}}else-1!==l.name.indexOf(t)&&(d=l.name.split(t),r.default.isNumber(d[1])&&o.push(l));else l.name&&-1!==l.name.indexOf(t)&&(i=l)}return n===a.Atlas?o:i},n.prototype.desArray=function(e,t){void 0===t&&(t=[]);var n=t.concat(["swim","death"]);return e.sort(function(e,t){for(var o=e.name,i="",c=0;c<n.length;c++)if(-1!==o.indexOf(n[c])){i=n[c];break}var a=o.split(i);o=a[a.length-1];var r=t.name,l=r.split(i);r=l[l.length-1];var s=Math.ceil(o),u=Math.ceil(r);return s>u?1:s<u?-1:0}),e},c([d(cc.AudioClip)],n.prototype,"ex",void 0),c([d(cc.AudioClip)],n.prototype,"flyBull2",void 0),c([d(cc.AudioClip)],n.prototype,"flyBull",void 0),c([d(cc.AudioClip)],n.prototype,"wua",void 0),c([d(cc.AudioClip)],n.prototype,"fua",void 0),c([d(cc.AudioClip)],n.prototype,"unSpeed",void 0),c([d(cc.AudioClip)],n.prototype,"speed",void 0),c([d(cc.AudioClip)],n.prototype,"jia",void 0),c([d(cc.AudioClip)],n.prototype,"jian",void 0),c([d(cc.AudioClip)],n.prototype,"wu",void 0),c([d(cc.AudioClip)],n.prototype,"unAuto",void 0),c([d(cc.AudioClip)],n.prototype,"auto",void 0),c([d(cc.AudioClip)],n.prototype,"runDown",void 0),c([d(cc.AudioClip)],n.prototype,"free5",void 0),c([d(cc.AudioClip)],n.prototype,"free10",void 0),c([d(cc.AudioClip)],n.prototype,"icon120",void 0),c([d(cc.AudioClip)],n.prototype,"bgm",void 0),c([d(cc.AudioClip)],n.prototype,"magWin",void 0),c([d(cc.AudioClip)],n.prototype,"bigWin",void 0),c([d(cc.AudioClip)],n.prototype,"btnStart",void 0),c([d(cc.AudioClip)],n.prototype,"swiningAll",void 0),c([d(cc.AudioClip)],n.prototype,"dingding",void 0),c([d(cc.AudioClip)],n.prototype,"coinUp",void 0),c([d(cc.AudioClip)],n.prototype,"chooseBull",void 0),c([d(cc.AudioClip)],n.prototype,"runBull",void 0),c([d(cc.AudioClip)],n.prototype,"wood",void 0),c([d(cc.AudioClip)],n.prototype,"suolian",void 0),c([d(cc.AudioClip)],n.prototype,"runLine3",void 0),c([d(cc.AudioClip)],n.prototype,"btnFreeType",void 0),c([d(cc.AudioClip)],n.prototype,"anDouble",void 0),c([d(cc.AudioClip)],n.prototype,"fevenBgm",void 0),c([d(cc.AudioClip)],n.prototype,"goldFly",void 0),c([d(cc.AudioClip)],n.prototype,"winScale",void 0),c([d(cc.AudioClip)],n.prototype,"coinUpEnd",void 0),c([d([cc.SpriteAtlas])],n.prototype,"effectsAtals",void 0),c([d(cc.SpriteAtlas)],n.prototype,"icon",void 0),c([d(cc.SpriteAtlas)],n.prototype,"s146",void 0),c([u],n)}(cc.Component);n.default=p,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./S146Const":"S146Const",PlayerInfo:void 0}],S146Menu:[function(e,t,n){"use strict";cc._RF.push(t,"fd56d9U64JPgIQN3A6MI/Fa","S146Menu");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=this&&this.__decorate||function(e,t,n,o){var i,c=arguments.length,a=c<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(c<3?i(a):c>3?i(t,n,a):i(t,n))||a);return c>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./S146Const"),r=cc._decorator,l=r.ccclass,s=r.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btnMore=null,t.btnStart=null,t.btnAuto=null,t.btnAdd=null,t.btn___=null,t.btnRecharge=null,t.layerInfo=null,t.btnClose=null,t.btnRunClose=null,t.layerRule=null,t.rechargeHand=null,t.tgMusic=null,t.lbBet=null,t.lbEntries=null,t.lbWin=null,t.lbWinNing=null,t.lbIP=null,t.lbJPES=null,t.spLight=null,t.lbGrand=null,t.lbMinor=null,t.lbMajor=null,t.lbMini=null,t.layerRecharge=null,t.layerNetError=null,t.btnNetError=null,t.layerSure=null,t.layerWL=null,t.btn_add=null,t.labCoinsTip=null,t}return i(t,e),t.prototype.onLoad=function(){this.btnClose.node.active=!1,this.labCoinsTip.active=!1,cc.log("S146Const.once.BET:"+a.default.once.BET),a.default.once.PlayerInfo.slotBetList&&(a.default.once.BET=a.default.once.PlayerInfo.slotBetList),this.layerWL.active=!1,this.btn_add.active=!1},t.prototype.start=function(){},t.prototype.onClickMenu=function(){a.default.once.GameLayer.playSFX("wua"),this.btnClose.node.active=!0;var e=cc.find("Canvas").width;this.layerInfo.stopAllActions(),this.btnMore.node.stopAllActions(),this.layerInfo.runAction(cc.sequence(cc.fadeIn(.1),cc.moveTo(.5,cc.v2(e/2-70,215)))),this.btnMore.node.runAction(cc.sequence(cc.moveTo(.5,cc.v2(e/2+200,240)),cc.fadeOut(.1)))},t.prototype.onClickCloseMenu=function(){a.default.once.GameLayer.playSFX("wua"),this.btnClose.node.active=!1;var e=cc.find("Canvas").width;this.layerInfo.stopAllActions(),this.btnMore.node.stopAllActions(),this.layerInfo.runAction(cc.sequence(cc.moveTo(.5,cc.v2(e/2+200,215)),cc.fadeOut(.5))),this.btnMore.node.runAction(cc.sequence(cc.fadeIn(.1),cc.moveTo(.5,cc.v2(e/2-50,240))))},t.prototype.onClickRechargeAdd=function(e,t){t=parseInt(t),a.default.once.GameLayer.playSFX("wu"),a.default.once.GameNet.sendRecharge(t),this.onClickCloseRecharge()},t.prototype.onClickAuto=function(){a.default.once.Auto=!a.default.once.Auto;var e=a.default.once.Auto?"e8c5ddf3-1a87-4de1-9c3a-c29fbb93ed0a":"952ff14a-adf9-4c62-849a-4e1747dbf1c0",t=a.default.once.Auto?"auto":"unAuto";a.default.once.GameLayer.playSFX(t),this.btnAuto.node.getComponent(cc.Sprite).spriteFrame=a.default.once.MapAtlas.get("s146").getSpriteFrame(e),a.default.once.Auto&&this.btnStart.interactable&&this.onClickStart()},t.prototype.onClickedNetError=function(){var e=this;this.btnNetError.interactable=!1,this.btnNetError.node.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){e.btnNetError.interactable=!0,a.default.once.GameNet.outGame()})))},t.prototype.closeNetError=function(){this.btnNetError.node.stopAllActions(),this.showNetError(!1)},t.prototype.showNetError=function(e){cc.isValid(this.node)&&(this.layerNetError.active=e,e&&a.default.once.GameNet.socket.disconnect())},t.prototype.onClickLobby=function(){a.default.once.GameLayer.playSFX("fua"),a.default.once.GameNet.outGame()},t.prototype.onClickExit=function(){a.default.once.GameLayer.playSFX("fua"),a.default.once.GameNet.closeSocket()},t.prototype.showHand=function(){var e=this;this.rechargeHand.active=!0,this.rechargeHand.stopAllActions(),this.rechargeHand.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){e.rechargeHand.active=!1}))),this.labCoinsTip.active=!0,this.labCoinsTip.opacity=255,this.scheduleOnce(function(){cc.tween(e.labCoinsTip).to(1,{opacity:0}).call(function(){e.labCoinsTip.active=!1}).start()},3)},t.prototype.hideHand=function(){this.rechargeHand.stopAllActions(),this.rechargeHand.active=!1},t.prototype.onClickStart=function(){if(a.default.once.ClickLimitTime>0)cc.log("\u8bf7\u4e0d\u8981\u9891\u7e41\u70b9\u51fb");else{a.default.once.GameLayer.playSFX("btnStart");var e=a.default.once.BET[a.default.once.JPES]*a.default.once.BETNUM;if(e>a.default.once.Entries)return this.showHand(),void(a.default.once.Auto&&this.onClickAuto(0));this.lbWin.string="0",a.default.once.AniLimit=null,a.default.once.ClickLimitTime=5,a.default.once.LotteryRes={},a.default.once.GameLayer.EffectLayer.hideTap(),a.default.once.GameLayer.runAlway(),a.default.once.GameNet.sendLotty(a.default.once.JPES,[e]),this.setBetBtnFalse()}},t.prototype.onClickRule=function(){a.default.once.GameLayer.playSFX("fua"),this.layerRule.active=!0},t.prototype.onClickCloseRule=function(){a.default.once.GameLayer.playSFX("fua"),this.layerRule.active=!1},t.prototype.onClickCloseSure=function(){a.default.once.GameLayer.playSFX("fua"),this.layerSure.active=!1},t.prototype.onClickCloseRun=function(){if(a.default.once.LotteryRes&&a.default.once.LotteryRes.viewarray){a.default.once.RunIndex[0]<a.default.once.MaxIndex-2&&a.default.once.GameLayer.playSFX("btnStart");for(var e=0;e<5;e++)a.default.once.GameLayer._iconBgs[e][0].node.parent.stopAllActions();for(e=0;e<a.default.once.RunIndex.length;e++)a.default.once.RunIndex[e]!=a.default.once.MaxIndex&&(a.default.once.RunIndex[e]=a.default.once.MaxIndex-1,a.default.once.CurSpeedTime[e]=-0)}},t.prototype.onClickLight=function(){a.default.once.Speed=!a.default.once.Speed;var e=a.default.once.Speed?29:28,t=a.default.once.Speed?"speed":"unSpeed";a.default.once.GameLayer.playSFX(t),this.spLight.spriteFrame=a.default.once.MapAtlas.get("s146").getSpriteFrame(""+e),this.spLight.node.children[0].active=a.default.once.Speed},t.prototype.refreshInfo=function(){this.lbEntries.string=a.default.once.GameLayer.changeGold(a.default.once.Entries),this.lbWinNing.string=a.default.once.GameLayer.changeGold(a.default.once.Winning),this.lbIP.string=a.default.once.PlayerInfo.playerName,this.refreshWinPool(),this.refreshJPES()},t.prototype.setBetBtnFalse=function(){this.btnStart.interactable=!1,this.btnAdd.interactable=!1,this.btn___.interactable=!1,this.btnRecharge.interactable=!1,this.btnRunClose.node.active=!0},t.prototype.resetBetBtnState=function(){this.btnStart.interactable=!0,this.btnAdd.interactable=!0,this.btn___.interactable=!0,this.btnRecharge.interactable=!0,this.btnRunClose.node.active=!1},t.prototype.refreshJPES=function(){var e=a.default.once.BET[a.default.once.JPES];this.lbJPES.string=""+e;var t=e*a.default.once.BETNUM;this.lbBet.string=a.default.once.GameLayer.changeGold(t)},t.prototype.refreshWinPool=function(){var e=a.default.once.WinPool/a.default.once.PlayerInfo.exchangeRate;this.lbGrand.string="$"+e.toFixed(2),this.lbMajor.string="$"+(.5*e).toFixed(2),this.lbMinor.string="$"+(.2*e).toFixed(2),this.lbMini.string="$"+(.05*e).toFixed(2)},t.prototype.onClickAdd=function(){a.default.once.GameLayer.playSFX("jia"),a.default.once.JPES=++a.default.once.JPES>=a.default.once.BET.length?0:a.default.once.JPES,this.refreshJPES()},t.prototype.onClick__=function(){a.default.once.GameLayer.playSFX("jian"),a.default.once.JPES=--a.default.once.JPES<0?a.default.once.BET.length-1:a.default.once.JPES,this.refreshJPES()},t.prototype.showGameWin=function(e){var t=this;if(e>0){var n=e/60,o=[];this.lbWin.string="0";for(var i=function(e){o.push(cc.callFunc(function(){var o=n*e;t.lbWin.string=""+a.default.once.GameLayer.changeGold(o)})),o.push(cc.delayTime(1.6/60))},c=0;c<60;c++)i(c);o.push(cc.callFunc(function(){t.lbWin.string=a.default.once.GameLayer.changeGold(e),a.default.once.GameLayer.playSFX("coinUpEnd")})),this.lbWin.node.stopAllActions(),this.lbWin.node.runAction(cc.sequence(o)),a.default.once.GameLayer.playSFX("coinUp")}},t.prototype.onClickOpenRecharge=function(){this.hideHand(),this.layerRecharge.active=!0,a.default.once.GameLayer.playSFX("wu")},t.prototype.onClickCloseRecharge=function(){a.default.once.GameLayer.playSFX("wu"),this.layerRecharge.active=!1},t.prototype.onToggleMusic=function(){this.tgMusic.node.getChildByName("Background").active=!this.tgMusic.isChecked,!this.tgMusic.isChecked?cc.audioEngine.pauseAll():cc.audioEngine.resumeAll()},t.prototype.update=function(e){a.default.once.ClickLimitTime-=e},c([s(cc.Button)],t.prototype,"btnMore",void 0),c([s(cc.Button)],t.prototype,"btnStart",void 0),c([s(cc.Button)],t.prototype,"btnAuto",void 0),c([s(cc.Button)],t.prototype,"btnAdd",void 0),c([s(cc.Button)],t.prototype,"btn___",void 0),c([s(cc.Button)],t.prototype,"btnRecharge",void 0),c([s(cc.Node)],t.prototype,"layerInfo",void 0),c([s(cc.Button)],t.prototype,"btnClose",void 0),c([s(cc.Button)],t.prototype,"btnRunClose",void 0),c([s(cc.Node)],t.prototype,"layerRule",void 0),c([s(cc.Node)],t.prototype,"rechargeHand",void 0),c([s(cc.Toggle)],t.prototype,"tgMusic",void 0),c([s(cc.Label)],t.prototype,"lbBet",void 0),c([s(cc.Label)],t.prototype,"lbEntries",void 0),c([s(cc.Label)],t.prototype,"lbWin",void 0),c([s(cc.Label)],t.prototype,"lbWinNing",void 0),c([s(cc.Label)],t.prototype,"lbIP",void 0),c([s(cc.Label)],t.prototype,"lbJPES",void 0),c([s(cc.Sprite)],t.prototype,"spLight",void 0),c([s(cc.Label)],t.prototype,"lbGrand",void 0),c([s(cc.Label)],t.prototype,"lbMinor",void 0),c([s(cc.Label)],t.prototype,"lbMajor",void 0),c([s(cc.Label)],t.prototype,"lbMini",void 0),c([s(cc.Node)],t.prototype,"layerRecharge",void 0),c([s(cc.Node)],t.prototype,"layerNetError",void 0),c([s(cc.Button)],t.prototype,"btnNetError",void 0),c([s(cc.Node)],t.prototype,"layerSure",void 0),c([s(cc.Node)],t.prototype,"layerWL",void 0),c([s(cc.Node)],t.prototype,"btn_add",void 0),c([s(cc.Node)],t.prototype,"labCoinsTip",void 0),c([l],t)}(cc.Component);n.default=u,cc._RF.pop()},{"./S146Const":"S146Const"}],S146Network:[function(e,t,n){"use strict";cc._RF.push(t,"b4394UHf/xCcrr/0kbwL/x+","S146Network");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=this&&this.__decorate||function(e,t,n,o){var i,c=arguments.length,a=c<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(c<3?i(a):c>3?i(t,n,a):i(t,n))||a);return c>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./S146Const"),r=e("./S146Secen"),l=cc._decorator,s=l.ccclass,u=l.property,d=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=null,e}return i(n,t),n.prototype.onLoad=function(){a.default.once.GameNet=this,a.default.once.PlayerInfo=e("PlayerInfo").getInstant,GameConfig.SubGameMgr.subGameNet=this,this.send("loginGame",{})},n.prototype.addNetEvent=function(e,t){var n=null;if("UPDATE_COIN"==e&&(a.default.once.Entries=t,this.view&&this.view.MenuLayer.refreshInfo()),"error"==e&&cc.log("socket error"),"connect_error"==e&&(cc.log("connect_error"),this.view&&this.view.MenuLayer&&this.view.MenuLayer.showNetError(!0)),"connect_timeout"==e&&cc.log("connect_timeout"),"disconnect"==e&&this.view&&this.view.MenuLayer&&this.view.MenuLayer.showNetError(!0),"loginGameResult"==e)if(n=window.changeResultJSON_Function(t),this.send("LoginfreeCount",{}),1==n.resultid){a.default.once.WinPool=n.Obj.nGamblingWinPool,a.default.once.Entries=n.Obj.score,a.default.once.Winning=n.Obj.wins,a.default.once.BET=n.Obj.betList,a.default.once.JPES=0;for(var o=0;o<n.Obj.betList.length;o++)if(n.Obj.betDefault==n.Obj.betList[o]){a.default.once.JPES=o;break}this.view.loginGameResult()}else this.outGame();"lotteryResult"==e&&(n=window.changeResultJSON_Function(t),this.endNet(),n.ResultCode&&1==n.ResultCode?(n.ResultData.viewarray.nWinDetail.length||(n.ResultData.viewarray.nWinDetail=[]),n.ResultData.viewarray.nWinLines.length||(n.ResultData.viewarray.nWinLines=[]),n.ResultData.viewarray.nWinLinesDetail.length||(n.ResultData.viewarray.nWinLinesDetail=[]),a.default.once.LotteryRes=n.ResultData,a.default.once.LotteryRes.nHandCards=n.ResultData.viewarray.nHandCards,a.default.once.LotteryRes.sHandCards=n.ResultData.viewarray.sHandCards,a.default.once.LotteryRes.nWinCards=n.ResultData.viewarray.nWinCards,a.default.once.Entries-=n.ResultData.viewarray.nBet,this.view.MenuLayer.refreshInfo(),a.default.once.Entries=n.ResultData.userscore,a.default.once.Winning+=n.ResultData.winscore,this.view.lotteryResult()):this.view.resetRun()),"selectFreeTypeResult"==e&&(n=window.changeResultJSON_Function(t),cc.log("selectFreeTypeResult",n),1==n.ResultCode&&1==n.freeType&&(a.default.once.FevenRes=n.result,a.default.once.Entries=n.result.userscore,a.default.once.Winning+=n.result.winscore,this.view.selectFreeTypeResult())),"LoginfreeCountResult"==e&&(n=window.changeResultJSON_Function(t),cc.log("LoginfreeCountResult",n),cc.find("Loading")&&(cc.find("Loading").active=!1),1==n.ResultCode&&-1!=[5,6].indexOf(parseInt(n.freeType))&&(n.freeType=parseInt(n.freeType),this.view.EffectLayer.hideTap(),this.view.EffectLayer.showEffectType(n.freeType),this.view.LoginfreeCountResult())),"pushGamblingWinPool"==e&&(n=window.changeResultJSON_Function(t),cc.log("pushGamblingWinPool:",n),1==n.ResultCode&&(a.default.once.WinPool=n.nGamblingWinPool,this.view.MenuLayer.refreshWinPool())),"selectFreeBuffaloTypeResult"==e&&(n=window.changeResultJSON_Function(t),cc.log("selectFreeBuffaloTypeResult"+JSON.stringify(n)),1==n.ResultCode?(a.default.once.BuffaloRes=n.result,6==n.result.viewarray.length&&(a.default.once.BuffaloType=10),8==n.result.viewarray.length&&(a.default.once.BuffaloType=9),11==n.result.viewarray.length&&(a.default.once.BuffaloType=8),a.default.once.Entries=n.result.userscore,a.default.once.Winning+=n.result.winscore,this.view.selectFreeBuffaloTypeResult()):(this.view.resetRun(),this.view.EffectLayer.resetUI()))},n.prototype.send=function(e,t){void 0===t&&(t={}),cc.log("send cmd:"+e+",data:"+JSON.stringify(t)),window.sendNetWorkData(e,JSON.stringify(t))},n.prototype.sendRecharge=function(){},n.prototype.sendLotty=function(e,t){this.startNet(),this.send("lottery",{bet:e,nBetList:t})},n.prototype.sendSelectFreeType=function(e){this.send("selectFreeType",{type:e})},n.prototype.sendSelectFreeBuffaloType=function(e){this.send("selectFreeBuffaloType",{type:e})},n.prototype.startNet=function(){var e=[];e.push(cc.delayTime(5)),e.push(cc.callFunc(function(){a.default.once.GameLayer.resetRun()}));var t=cc.sequence(e);t.setTag(4040404),this.node.runAction(t)},n.prototype.endNet=function(){this.node.stopActionByTag(4040404)},n.prototype.outGame=function(){Common.backHall("Are you sure you want to leave the game?",function(){})},n.prototype.closeSocket=function(){},n.prototype.changeResultJSON_Function=function(e){return cc.sys.isNative?JSON.parse(e):e},n.prototype.onDestroy=function(){},c([u(r.default)],n.prototype,"view",void 0),c([s],n)}(cc.Component);n.default=d,cc._RF.pop()},{"./S146Const":"S146Const","./S146Secen":"S146Secen",PlayerInfo:void 0}],S146Secen:[function(e,t,n){"use strict";cc._RF.push(t,"9bf61dGVYJNnL+k5kwa0Pte","S146Secen");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=this&&this.__decorate||function(e,t,n,o){var i,c=arguments.length,a=c<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(c<3?i(a):c>3?i(t,n,a):i(t,n))||a);return c>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../../Script/utils/Utils"),r=e("./S146Const"),l=e("./S146Effect"),s=e("./S146Loading"),u=e("./S146Menu"),d=cc._decorator,p=d.ccclass,f=d.property,h={5:cc.v2(10,0),6:cc.v2(1,-2),7:cc.v2(-7,0),8:cc.v2(-1,-3),9:cc.v2(7,-2)},y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.MenuLayer=null,t.LoadLayer=null,t.EffectLayer=null,t.layer_an=null,t.runMask=null,t.FevenAni=null,t._iconPositions=[],t._iconBgs=[],t._iconSps=[],t._fevenPositions=[],t._fevenBgs=[],t._fevenSps=[],t._pool_ding=null,t._pool_kuang=null,t}return i(t,e),Object.defineProperty(t.prototype,"UI",{get:function(){return r.default.once.MapAtlas.get("s146")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ICON",{get:function(){return r.default.once.MapAtlas.get("icon")},enumerable:!1,configurable:!0}),t.prototype.playSFX=function(e){this.LoadLayer.playEffect(e)},t.prototype.playBGM=function(e,t){void 0===t&&(t=!1),this.LoadLayer.playBGM(e,t)},t.prototype.onLoad=function(){r.default.once.GameLayer=this,this.LoadLayer.loadFinish(),this.initUI(),this.playBGM("bgm",!0),cc.game.on(cc.game.EVENT_HIDE,function(){cc.log("\u6e38\u620f\u8fdb\u5165\u540e\u53f0"),r.default.once.Auto&&this.MenuLayer.onClickAuto(0)},this)},t.prototype.changeGold=function(e){return(parseFloat(e)/r.default.once.PlayerInfo.exchangeRate).toFixed(2)},t.prototype.createPool=function(e,t){var n=new cc.NodePool;n.prefab=t;for(var o=0;o<e;o++)n.put(cc.instantiate(t));return n},t.prototype.getNodeByPool=function(e){var t=e.get();return t||(t=cc.instantiate(e.prefab)),t},t.prototype.initUI=function(){cc.sys.isNative&&cc.sys.os===cc.sys.OS_ANDROID?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","cocosChangeOrientation","(I)V",2):cc.sys.isNative&&cc.sys.os===cc.sys.OS_IOS&&jsb.reflection.callStaticMethod("AppController","cocosChangeOrientation:",2),cc.view.setOrientation(cc.macro.ORIENTATION_PORTRAIT);var e=cc.find("layer_load/ding",this.node);this._pool_ding=this.createPool(15,e);var t=cc.find("layer_load/kuang",this.node);this._pool_kuang=this.createPool(40,t);for(var n=0,o=cc.find("layer_run/layer_normal",this.node),i=1;i<6;i++){for(var c=[],a=[],r=[],l=0;l<5;l++){var s=++n%12+1;(f=o.children[i].children[l].getComponent(cc.Sprite)).spriteFrame=null,c.push(f),a.push(cc.v2(f.node.x,f.node.y));var u=f.node.children[0].getComponent(cc.Sprite),d=this.convertToPosition(s);u.node.setPosition(d.x,d.y),u.node.setScale(1,1),u.sizeMode=cc.Sprite.SizeMode.RAW,u.type=cc.Sprite.Type.SIMPLE,u.trim=!1,u.spriteFrame=0==l||4==l?null:this.ICON.getSpriteFrame("icon_"+s),r.push(u),u.node.addComponent(cc.Animation)}this._iconSps.push(r),this._iconBgs.push(c),this._iconPositions.push(a)}var p=cc.find("layer_run/layer_feven",this.node);for(i=0;i<3;i++){for(c=[],a=[],r=[],l=0;l<8;l++){var f;s=++n%11,(f=p.children[i+1].children[l].getComponent(cc.Sprite)).spriteFrame=null,c.push(f),a.push(cc.v2(f.node.x,f.node.y)),u=f.node.children[0].getComponent(cc.Sprite),d=this.convertToPosition(s),u.node.setPosition(d.x,d.y),u.node.setScale(1,1),u.node.color=cc.Color.GRAY,u.sizeMode=cc.Sprite.SizeMode.RAW,u.type=cc.Sprite.Type.SIMPLE,u.trim=!1,u.node.children[0].active=!1,u.spriteFrame=0==l||7==l?null:this.ICON.getSpriteFrame("icon_"+s),r.push(u),u.node.addComponent(cc.Animation)}this._fevenSps.push(r),this._fevenBgs.push(c),this._fevenPositions.push(a)}},t.prototype.lotteryResult=function(){var e=this.getLineIcon(1,12),t=this.getLineIcon(2,12),n=this.getLineIcon(3,12),o=e.concat(t).concat(n);e.length+t.length+n.length>=3&&r.default.once.LotteryRes.viewarray.nWinLinesDetail.unshift(o)},t.prototype.resetRun=function(){this.EffectLayer.showNetError(),this.MenuLayer.resetBetBtnState(),this.resetIcon(),r.default.once.ClickLimitTime=-1,r.default.once.Auto&&this.MenuLayer.onClickAuto(0)},t.prototype.loginGameResult=function(){this.MenuLayer.refreshInfo()},t.prototype.selectFreeBuffaloTypeResult=function(){this.MenuLayer.setBetBtnFalse(),r.default.once.BuffaloIndex=-1,this.refreshBuffaloRes()},t.prototype.refreshFevenIcon=function(){var e=r.default.once.LotteryRes?r.default.once.LotteryRes.viewarray.nHandCards:[0,1,2,3,4,5,6,7,8,9,10,1,2,1,1],t=[e[1],e[2],e[3],e[6],e[7],e[8],e[11],e[12],e[13]],n=cc.find("layer_run/layer_feven",this.node);for(var o in r.default.once.FevenRes.feverResult.startIdx)t[o]=12;for(var i=0;i<3;i++)for(var c=0;c<8;c++){var l=n.children[i+1].children[c].getComponent(cc.Sprite);l.spriteFrame=null;var s=3*(c-1)+i,u=t[s]||parseInt(""+a.default.randomNum(1,11)),d=l.node.children[0].getComponent(cc.Sprite),p=this.convertToPosition(u);d.node.setPosition(p.x,p.y),d.node.color=12==u?cc.Color.WHITE:cc.Color.GRAY,d.node.opacity=12==u?0:255,d.spriteFrame=0==c||7==i?null:this.ICON.getSpriteFrame("icon_"+u),d.node.children[0].getComponent(cc.Sprite).spriteFrame=this.ICON.getSpriteFrame("icon_12_1"),d.node.children[0].children[0].getComponent("S146Label").spriteAtlas=this.ICON;var f=this.FevenAni.children[s];if(f){f.active=12==u,f.children[0].children[0].active=!0;for(var h=f.getComponent(cc.Animation);h.getClips().length>0;)h.removeClip(h.getClips()[0]);for(var y=0;y<2;y++){var v=r.default.once.MapEffects.get(["coin_1_","coin_2_"][y]);v.sample=60,v.wrapMode=cc.WrapMode.Normal,h.stop(),h.resume(),h.addClip(v)}this.showFevenGold(f,d,s,u,2)}}},t.prototype.showFevenGold=function(e,t,n,o,i,c){var a=this;if(void 0===i&&(i=0),void 0===c&&(c="coin_1_"),e.active){e.getComponent(cc.Sprite).spriteFrame=this.ICON.getSpriteFrame("icon_12");var l=e.children[0].getComponent(cc.Sprite);l.node.active=12==o,l.spriteFrame=this.ICON.getSpriteFrame("icon_12_1"),l.node.scale=1;var s=l.node.getChildByName("lb").getComponent("S146Label");s.spriteAtlas=this.ICON,s.string=this.changeGold(r.default.once.FevenRes.viewarray.nBet*r.default.once.FevenRes.feverResult.startIdx[n]);var u=e.getComponent(cc.Animation),d="coin_1_"==c?0:.6;e.runAction(cc.sequence(cc.delayTime(i),cc.callFunc(function(){u.play(c)}),cc.scaleTo(.7,1.2),cc.callFunc(function(){s.string=a.changeGold(r.default.once.FevenRes.viewarray.nBet*r.default.once.FevenRes.feverResult.startIdx[n])}),cc.scaleTo(.7+d,1),cc.callFunc(function(){u.resume(),u.stop(),e.getComponent(cc.Sprite).spriteFrame=a.ICON.getSpriteFrame("icon_12")})));var p=this.FevenAni.convertToNodeSpaceAR(t.node.parent.convertToWorldSpaceAR(cc.v2(0,0)));e.setPosition(p.x,p.y)}},t.prototype.refreshIcons=function(){for(var e=r.default.once.FevenTurn.icons,t=[-1,e[0],e[1],e[2],-1,-1,e[3],e[4],e[5],-1,-1,e[6],e[7],e[8],-1,-1],n=0;n<5;n++)for(var o=0;o<5;o++){var i=this._iconSps[n][o],c=t[5*(o-1)+n];if(c&&-1!=c){i.spriteFrame=this.ICON.getSpriteFrame("icon_"+c.icon);var a=this.convertToPosition(c.icon);i.node.setPosition(a.x,a.y)}}for(n=0;n<this.FevenAni.children.length;n++)this.FevenAni.children[n].active=!1},t.prototype.refreshFeven=function(){var e=this,t=r.default.once.FevenRes;if(--r.default.once.FevenTimes<0){var n="";for(var o in r.default.once.FevenRes.feverResult.startIdx)n=o,r.default.once.FevenTurn.icons[o]={icon:12,gold:0};var i=0,c=0,l=function(t){s.LoadLayer.MusicDic[404]="bgm";var o=r.default.once.FevenRes.feverResult.startIdx[t]*r.default.once.FevenRes.viewarray.nBet;c+=o;var a=s.FevenAni.children[parseInt(t)].children[0].children[0],l=cc.instantiate(a);l.parent=s.layer_an;var u=a.convertToWorldSpaceAR(cc.v2(0,0));a.active=!1,u=s.layer_an.convertToNodeSpaceAR(u),l.setPosition(u.x,u.y);var d=[];d.push(cc.delayTime(1.2*i+1)),d.push(cc.scaleTo(.5,1)),d.push(cc.callFunc(function(){e.playSFX("goldFly")}));var p=s.MenuLayer.lbWin.node.convertToWorldSpaceAR(cc.v2(0,0));p=l.parent.convertToNodeSpaceAR(p),d.push(cc.spawn(cc.scaleTo(.3,.35),cc.moveTo(.3,p))),n==t&&(d.push(cc.callFunc(function(){l.opacity=0})),d.push(cc.delayTime(1)),d.push(cc.callFunc(function(){e.EffectLayer.hideFevenLayer(),e.refreshIcons(),e.setLine3Active(!0);var t=c/r.default.once.FevenRes.viewarray.nBet;r.default.once.FevenRes=null,r.default.once.FevenTurn=null,r.default.once.LotteryRes=null,e.checkFinish(t,c)}))),d.push(cc.callFunc(function(){l.destroy()})),s.MenuLayer.lbWin.node.runAction(cc.sequence(cc.delayTime(1.2*i+1),cc.delayTime(.8),cc.callFunc(function(){var t=parseFloat(e.MenuLayer.lbWin.string)*r.default.once.PlayerInfo.exchangeRate;e.MenuLayer.lbWin.string=e.changeGold(o+t),e.playSFX("winScale")}),cc.scaleTo(.2,1.5),cc.scaleTo(.2,1))),l.stopAllActions(),l.runAction(cc.sequence(d)),i++},s=this;for(var o in r.default.once.FevenRes.feverResult.startIdx)l(o)}if(!(t&&++r.default.once.FevenCountIndex>=t.feverResult.turns.length)){r.default.once.FevenTurn={};var u=a.default.deepCopy(t.feverResult.turns[r.default.once.FevenCountIndex]);r.default.once.FevenTurn.icons=[];for(var d=0;d<18;d++){var p={icon:a.default.randomNum(1,11),gold:0};r.default.once.FevenTurn.icons.push(p)}for(var o in r.default.once.FevenTurn.double=!1,this.EffectLayer.refreshFevenTime(),u)if("double"!=o){var f=u[o];r.default.once.FevenTimes=3,r.default.once.FevenRes.feverResult.startIdx[o]=parseFloat(f),r.default.once.FevenTurn.icons[o].gold=r.default.once.FevenRes.viewarray.nBet*parseFloat(f),r.default.once.FevenTurn.icons[o].icon=12}else r.default.once.FevenTurn.double=!0;this.runFevenAlway()}},t.prototype.setLine3Active=function(e){void 0===e&&(e=!1);for(var t=1;t<4;t++)this._iconBgs[t][0].node.parent.active=e},t.prototype.selectFreeTypeResult=function(){var e=this;this.refreshFevenIcon(),r.default.once.FevenCountIndex=-1,r.default.once.FevenTimes=3,r.default.once.FevenIndex=[r.default.once.MaxIndex,r.default.once.MaxIndex,r.default.once.MaxIndex],this.EffectLayer.hideWood(this.EffectLayer.feven,this.EffectLayer.free,function(){e.EffectLayer.showFevenRun()}),this.MenuLayer.lbWin.string="0",this.EffectLayer.refreshFevenBonus(),this.scheduleOnce(function(){e.refreshFeven()},4)},t.prototype.runFevenAlway=function(){r.default.once.Speeds=a.default.getHorseRaceLampTimeSpaceAuto(2*r.default.once.OpenRunTime,0,10,0,[2,2,2,3,3,3,3,3,3,3,4,6],2);var e=r.default.once.MaxIndex;r.default.once.FevenIndex=[e,e,e],r.default.once.FevenSpeedTime=[0,0,0];for(var t=function(e){var t=n._fevenBgs[e][0].node.parent;r.default.once.FevenSpeedTime[e]=.34*e,t.stopAllActions();var o=[];o.push(cc.moveBy(.1,cc.v2(0,50))),o.push(cc.callFunc(function(){r.default.once.FevenIndex[e]=0})),o.push(cc.moveBy(.7,cc.v2(0,-50))),t.runAction(cc.sequence(o))},n=this,o=0;o<3;o++)t(o)},t.prototype.LoginfreeCountResult=function(){this.MenuLayer.setBetBtnFalse()},t.prototype.refreshBuffaloRes=function(){var e=r.default.once.BuffaloRes;e&&++r.default.once.BuffaloIndex>=e.viewarray.length||(r.default.once.LotteryRes=a.default.deepCopy(e),r.default.once.LotteryRes.viewarray=r.default.once.LotteryRes.viewarray[r.default.once.BuffaloIndex],this.EffectLayer.refreshFreeOfStart(),this.runAlway())},t.prototype.convertToPosition=function(e){return h[e]||cc.v2(0,0)},t.prototype.updateIconAni=function(e,t,n,o,i){void 0===o&&(o=!0);var c=r.default.once.LotteryRes;n=n||c.viewarray.nWinCards[e];var a=Math.floor(e/5)+1,l=Math.floor(e%5),s=this._iconPositions[l][a],u=c.viewarray.nHandCards[e];t.node.parent.parent.y=10;var d=this.convertToPosition(u),p=t.node.parent.parent.convertToWorldSpaceAR(cc.v2(s.x+d.x,s.y+d.y));if(p=this.layer_an.convertToNodeSpaceAR(p),n){var f=c.viewarray.nHandCards[e];if(t.node.opacity=0,11==f||12==f){var h=this.getNodeByPool(this._pool_ding);h.parent=this.layer_an,h.active=!0,h.opacity=255,h.name="an_wanneng",h.setPosition(p.x,p.y);var y=i;y||(y=11==f?"s11_wild_":"coin_2_");var v=r.default.once.MapEffects.get(y),g=h.getComponent(cc.Animation);if(v){for(v.sample=40,v.wrapMode=o?cc.WrapMode.Loop:cc.WrapMode.Normal,g.stop(),g.resume();g.getClips().length>0;)g.removeClip(g.getClips()[0]);g.addClip(v),g.play(y)}if(i)return g}else{var m=this.getNodeByPool(this._pool_kuang);m.getComponent(cc.Sprite).spriteFrame=t.spriteFrame,m.active=!0,m.scale=1,m.opacity=255,m.name="an_kuang",m.parent=this.layer_an,m.setPosition(p.x,p.y),-1!=[8,9,10].indexOf(f)&&(m.stopAllActions(),m.scale=1,m.runAction(cc.sequence(cc.scaleTo(.3,1.1),cc.scaleTo(.3,1))))}var S=this.getNodeByPool(this._pool_kuang);S.getComponent(cc.Sprite).spriteFrame=this.UI.getSpriteFrame("0241a28b-8626-4eeb-92fc-eee6ba498e88"),S.active=!0,S.name="an_kuang",S.scale=.5,S.parent=this.layer_an,S.opacity=255,S.runAction(cc.sequence(cc.fadeTo(.5,150),cc.fadeIn(.5))),S.setPosition(p.x,p.y)}else t.node.opacity=255},t.prototype.showOpenAni=function(e){var t=this;void 0===e&&(e=0),r.default.once.ClickLimitTime=-1,this.EffectLayer.clearFlyBull();var n=r.default.once.LotteryRes,o=n.viewarray.nWinLinesDetail&&n.viewarray.nWinLinesDetail.length>0,i=e;this.runMask.opacity=0;for(var c=0;c<this._iconBgs.length;c++)for(var a=this._iconBgs[c],l=1;l<a.length;l++){var s=5*(l-1)+c,u=this._iconSps[c][l];n.viewarray.nWinCards[s]&&(i=e+1.5+.5,this.runMask.opacity=100),this.updateIconAni(s,u)}n&&n.viewarray&&o&&(r.default.once.AniIndex=-1,r.default.once.AniLimit=r.default.once.OpenRunTime),r.default.once.BuffaloRes&&-1!=r.default.once.BuffaloIndex&&(r.default.once.BuffaloIndex==r.default.once.BuffaloRes.viewarray.length-1?(n.viewarray.win=r.default.once.BuffaloRes.winscore,this.EffectLayer.shakeRunLayer(1,function(){t.EffectLayer.LayerFree.active=!1}),this.EffectLayer.showRunBull(1.5),this.LoadLayer.MusicDic[404]="bgm",r.default.once.BuffaloRes=null,i+=5):-1!=n.viewarray.nHandCards.indexOf(r.default.once.BuffaloType)&&(i+=1.2,this.EffectLayer.flyBull(n.viewarray.nHandCards,this._iconBgs))),this.MenuLayer.showGameWin(n.viewarray.win),this.scheduleOnce(function(){var e=n.viewarray.win/n.viewarray.nBet;t.checkFinish(e,n.viewarray.win)},i)},t.prototype.checkFinish=function(e,t){e>=10?this.EffectLayer.showBigWin(1,t):e>=5?this.EffectLayer.showBigWin(0,t):this.finishOnceLoop()},t.prototype.finishOnceLoop=function(){r.default.once.LotteryRes&&5==parseInt(r.default.once.LotteryRes.freeType)?(r.default.once.AniLimit=null,this.runMask.opacity=0,this.claenLight(),r.default.once.Auto&&this.MenuLayer.onClickAuto(0),this.MenuLayer.setBetBtnFalse(),this.EffectLayer.showWood()):r.default.once.BuffaloRes?r.default.once.BuffaloIndex<r.default.once.BuffaloRes.viewarray.length-2?this.refreshBuffaloRes():(r.default.once.AniLimit=null,this.claenLight(),this.EffectLayer.flyBullBack(this._iconBgs)):(this.MenuLayer.refreshInfo(),this.MenuLayer.resetBetBtnState(),r.default.once.Auto&&this.MenuLayer.onClickStart())},t.prototype.refreshLightAni=function(){var e=r.default.once.LotteryRes;if(e&&e.viewarray.nWinLinesDetail){this.claenLight();var t=e.viewarray.nWinLinesDetail[r.default.once.AniIndex],n=this.getLineIcon(1,12),o=this.getLineIcon(2,12),i=this.getLineIcon(3,12),c=n.length+o.length+i.length>=3;c&&(r.default.once.AniLimit=null,this.runMask.opacity=100,this.playSFX("wood"));for(var a=0;a<t.length;a++){var l=t[a],s=Math.floor(l/5)+1,u=Math.floor(l%5),d=this._iconSps[u][s];this.updateIconAni(l,d,c,!c)}}},t.prototype.claenLight=function(){for(var e=0;e<5;e++)for(var t=0;t<5;t++)this._iconSps[e][t].node.opacity=255;for(e=this.layer_an.childrenCount-1;e>=0;e--){var n=this.layer_an.children[e];"an_kuang"==n.name&&(n.stopAllActions(),n.removeFromParent(),n.active=!1,this._pool_kuang.put(n)),"an_wanneng"==n.name&&this._pool_ding.put(n)}},t.prototype.runAlway=function(){this.EffectLayer.hideTap(),r.default.once.Speeds=a.default.getHorseRaceLampTimeSpaceAuto(r.default.once.OpenRunTime+.25,0,10,0,[7,5,4,2,2,2,2,2,2,3,4],10),r.default.once.AniLimit=null,this.runMask.opacity=0,this.claenLight();var e=r.default.once.MaxIndex+1;r.default.once.RunIndex=[e,e,e,e,e];var t=r.default.once.Speed?0:.34;r.default.once.CurSpeedTime=[0,0,0,0,0];for(var n=function(e){r.default.once.CurSpeedTime[e]=t*e;var n=o._iconBgs[e][0].node.parent;n.stopAllActions();var i=[];i.push(cc.moveBy(.1,cc.v2(0,100))),i.push(cc.callFunc(function(){r.default.once.RunIndex[e]=0})),i.push(cc.moveBy(.7,cc.v2(0,-100))),n.runAction(cc.sequence(i))},o=this,i=0;i<5;i++)n(i)},t.prototype.getLineIcon=function(e,t){var n=r.default.once.LotteryRes,o=[];if(n&&n.viewarray)for(var i=0;i<5;i++)for(var c=0;c<5;c++){var a=5*(c-1)+i;e==i&&n.viewarray.nHandCards[a]==t&&o.push(a)}return o},t.prototype.resetIcon=function(){for(var e=0;e<5;e++){var t=this._iconBgs[e][0].node.parent;t.stopAllActions(),t.setPosition(t.x,10)}for(e=0;e<r.default.once.RunIndex.length;e++)r.default.once.RunIndex[e]=r.default.once.MaxIndex,r.default.once.CurSpeedTime[e]=0;for(e=0;e<this._iconPositions.length;e++)for(var n=this._iconPositions[e],o=0;o<n.length;o++){var i=n[o],c=this._iconBgs[e][o].node;c.stopAllActions(),c.setPosition(i.x,i.y),(0==o||4==o)&&(this._iconSps[e][o].spriteFrame=null)}},t.prototype.addIcon12Ani=function(e,t){var n=this;void 0===t&&(t=!1);for(var o=function(t){var o=e[t],c=Math.floor(o/5)+1,a=Math.floor(o%5),r=i._iconSps[a][c];r.scheduleOnce(function(){var e=n.updateIconAni(o,r,!0,!1,"coin_1_");e.node.stopAllActions(),e.node.runAction(cc.sequence(cc.delayTime(1.2),cc.callFunc(function(){r.node.opacity=255,e.resume(),e.stop(),n._pool_ding.put(e.node)})))},.2)},i=this,c=0;c<e.length;c++)o(c)},t.prototype.update=function(e){var t=this,n=r.default.once.LotteryRes;if(!this.MenuLayer.btnStart.interactable&&n)for(var o=this._iconPositions[0][0].y-100,i=this._iconPositions[0][4].y-o,c=0;c<r.default.once.RunIndex.length;c++)if(r.default.once.RunIndex[c]<r.default.once.MaxIndex){if((b=r.default.once.CurSpeedTime[c]-e)<=0)for(var l=this.getLineIcon(1,12),s=this.getLineIcon(2,12),u=this.getLineIcon(3,12);b<=0;){if(++r.default.once.RunIndex[c]>=r.default.once.Speeds.length/2&&!n.viewarray&&--r.default.once.RunIndex[c],r.default.once.RunIndex[c]>=r.default.once.Speeds.length){r.default.once.RunIndex[c]=r.default.once.MaxIndex;for(var d=0;d<5;d++)if(c==d){(B=this._iconBgs[d][0].node.parent).stopAllActions(),B.setPosition(B.x,10);for(var p=0;p<5;p++){var f=this._iconPositions[d][p],h=5*(p-1)+d,y=0==p,v=this._iconBgs[d][p],g=n&&n.viewarray&&n.viewarray.nHandCards?n.viewarray.nHandCards[h]:a.default.randomNum(1,6);v.node.setPosition(f.x,f.y),v.node.runAction(cc.sequence(cc.moveBy(.065,cc.v2(0,-100)),cc.moveBy(.11,cc.v2(0,100)))),(T=this._iconSps[d][p]).spriteFrame=this.ICON.getSpriteFrame("icon_"+g);var m=this.convertToPosition(g);if(T.node.setPosition(m.x,m.y),y){if(1==d&&l.length>0&&T.scheduleOnce(function(){t.playSFX("icon120")},.15),2==d&&l.length+s.length>=2){this.EffectLayer.showLine3(),this.addIcon12Ani(s.concat(l)),this.playSFX("runLine3");for(var S=3;S<5;S++){var _=3==S?2:2.3;r.default.once.CurSpeedTime[S]+=_,r.default.once.RunIndex[S]=r.default.once.Speeds.length-2}}3==d&&l.length+s.length>=2&&(this.LoadLayer.stopEffect("runLine3"),l.length+s.length+u.length>=3&&(this.addIcon12Ani(u),this.playSFX("icon120")))}}}if(4==c){var F=.2;l.length+s.length+u.length>=3&&(F+=3.5),this.isEnd(F)}this.playSFX("runDown");break}b+=(r.default.once.Speeds[r.default.once.RunIndex[c]]||r.default.once.Speeds[r.default.once.Speeds.length-1]).time}if(r.default.once.RunIndex[c]==r.default.once.MaxIndex)continue;r.default.once.CurSpeedTime[c]=b;var L=i/(r.default.once.Speeds[r.default.once.RunIndex[c]]||r.default.once.Speeds[r.default.once.Speeds.length-1]).time*e%i;for(d=0;d<5;d++)if(d==c)for(p=0;p<5;p++){(v=this._iconBgs[d][p]).node.stopAllActions(),(T=this._iconSps[d][p]).node.stopAllActions(),h=5*(p-1)+d,T.node.getComponent(cc.Animation).stop(),T.node.opacity=255,T.node.active=!0;var A=0==p,C=4==p;v.node.y-=L,v.node.y<o&&(g=a.default.randomNum(0,12),v.node.y+=i,v.spriteFrame=null,(R=r.default.once.RunIndex[c]>=r.default.once.Speeds.length-1)&&(g=!A&&!C&&n&&n.viewarray&&n.viewarray.nHandCards?n.viewarray.nHandCards[h]:a.default.randomNum(1,6)),T.spriteFrame=this.ICON.getSpriteFrame("icon_"+g),f=this.convertToPosition(g),T.node.setPosition(f.x,f.y))}}if(r.default.once.FevenRes)for(o=this._fevenPositions[0][0].y-100,i=this._fevenPositions[0][7].y-o,c=0;c<r.default.once.FevenIndex.length;c++)if(r.default.once.FevenIndex[c]<r.default.once.MaxIndex){var b;if((b=r.default.once.FevenSpeedTime[c]-e)<=0)for(;b<=0;){if(++r.default.once.FevenIndex[c]>=r.default.once.Speeds.length){for(r.default.once.FevenIndex[c]=r.default.once.MaxIndex,d=0;d<3;d++)if(c==d){var B;for((B=this._fevenBgs[d][0].node.parent).stopAllActions(),B.setPosition(B.x,393),p=0;p<8;p++)f=this._fevenPositions[d][p],h=3*(p-1)+d,v=this._fevenBgs[d][p],g=r.default.once.FevenTurn.icons[h]?r.default.once.FevenTurn.icons[h].icon:a.default.randomNum(0,11),v.node.setPosition(f.x,f.y),v.node.runAction(cc.sequence(cc.moveBy(.05,cc.v2(0,-100)),cc.moveBy(.1,cc.v2(0,100)))),(T=this._fevenSps[d][p]).spriteFrame=this.ICON.getSpriteFrame("icon_"+g),T.node.color=12==g?cc.Color.WHITE:cc.Color.GRAY,T.node.children[0].active=12==g,12==g&&(T.node.children[0].children[0].getComponent("S146Label").string=this.changeGold(r.default.once.FevenTurn.icons[h].gold)),m=this.convertToPosition(g),T.node.setPosition(m.x,m.y)}2==c&&this.isEndFeven(),this.playSFX("runDown");break}b+=(r.default.once.Speeds[r.default.once.FevenIndex[c]]||r.default.once.Speeds[r.default.once.Speeds.length-1]).time}if(r.default.once.FevenIndex[c]==r.default.once.MaxIndex)continue;for(r.default.once.FevenSpeedTime[c]=b,L=i/(r.default.once.Speeds[r.default.once.FevenIndex[c]]||r.default.once.Speeds[r.default.once.Speeds.length-1]).time*e%i,d=0;d<3;d++)if(d==c)for(p=0;p<8;p++){var T;if((v=this._fevenBgs[d][p]).node.stopAllActions(),(T=this._fevenSps[d][p]).node.stopAllActions(),h=3*(p-1)+d,T.node.getComponent(cc.Animation).stop(),T.node.opacity=255,T.node.active=!0,A=0==p,C=7==p,v.node.y-=L,v.node.y<o){var R;if(g=a.default.randomNum(0,100)>80?12:a.default.randomNum(0,12),v.node.y+=i,v.spriteFrame=null,(R=r.default.once.FevenIndex[c]>=r.default.once.Speeds.length-1)&&(g=A||C?a.default.randomNum(1,6):r.default.once.FevenTurn.icons[h].icon),T.spriteFrame=this.ICON.getSpriteFrame("icon_"+g),12==g){var w=this.changeGold(r.default.once.FevenRes.viewarray.nBet*a.default.randomNum(1,5));T.node.children[0].children[0].getComponent("S146Label").string=R?this.changeGold(r.default.once.FevenTurn.icons[h].gold):w}T.node.color=12==g?cc.Color.WHITE:cc.Color.GRAY,T.node.children[0].active=12==g,f=this.convertToPosition(g),T.node.setPosition(f.x,f.y)}}}if(null!=r.default.once.AniLimit&&n&&n.viewarray&&n.viewarray.nWinLinesDetail.length>0&&(r.default.once.AniLimit-=e)<0&&(r.default.once.AniLimit=1.5,++r.default.once.AniIndex>=n.viewarray.nWinLinesDetail.length&&(r.default.once.AniIndex=0),this.refreshLightAni()),(r.default.once.SwingCD-=e)<0){r.default.once.SwingCD=300;var I=Math.floor(a.default.randomNum(0,1e3)%3);this.playSFX("swiningAll"),this.EffectLayer.showBullSwing([I])}},t.prototype.isEndFeven=function(){for(var e=this,t=1,n=0;n<r.default.once.FevenTurn.icons.length;n++)if(12==r.default.once.FevenTurn.icons[n].icon){t=2;var o=this.FevenAni.children[n];o.active=!0;var i=Math.floor(n/3)+1,c=Math.floor(n%3),a=this._fevenSps[c][i];a.node.opacity=0,this.playSFX("icon120"),this.showFevenGold(o,a,n,12)}r.default.once.FevenTurn.double?(this.EffectLayer.shakeRunLayer(t+.5,function(){for(var t=0;t<e.FevenAni.children.length;t++){var n=e.FevenAni.children[t];if(n.active){var o=Math.floor(t/3)+1,i=Math.floor(t%3),c=e._fevenSps[i][o];e.showFevenGold(n,c,t,12,2.5,"coin_2_")}}for(var a in r.default.once.FevenRes.feverResult.startIdx)r.default.once.FevenRes.feverResult.startIdx[a]*=2}),this.EffectLayer.scheduleOnce(function(){e.playSFX("anDouble")},t+6.3),this.EffectLayer.showRunBull(t+.5,-500),this.EffectLayer.runAllWin(5.5),t+=9):this.EffectLayer.refreshFevenBonus(),this.MenuLayer.scheduleOnce(function(){e.EffectLayer.refreshFevenBonus(),e.refreshFeven()},t)},t.prototype.isEnd=function(e){var t=this,n=e>1.7,o=[];o.push(cc.delayTime(.2)),o.push(cc.callFunc(function(){t.EffectLayer.hideLine3()})),n&&(e+=.5,o.push(cc.delayTime(.2)),o.push(cc.callFunc(function(){t.playSFX("swiningAll"),t.EffectLayer.showBullSwing()})),o.push(cc.delayTime(2.5)),o.push(cc.callFunc(function(){t.playSFX("dingding")})),o.push(cc.delayTime(.1))),o.push(cc.callFunc(function(){t.showOpenAni(e)}));var i=cc.sequence(o);i.setTag(404),this.runMask.stopActionByTag(404),this.runMask.runAction(i)},t.prototype.onDestroy=function(){cc.sys.isNative&&cc.sys.os===cc.sys.OS_ANDROID?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","cocosChangeOrientation","(I)V",1):cc.sys.isNative&&cc.sys.os===cc.sys.OS_IOS&&jsb.reflection.callStaticMethod("AppController","cocosChangeOrientation:",1),cc.view.setOrientation(cc.macro.ORIENTATION_LANDSCAPE),cc.audioEngine.stopAll(),r.default.destroyInstance()},c([f(u.default)],t.prototype,"MenuLayer",void 0),c([f(s.default)],t.prototype,"LoadLayer",void 0),c([f(l.default)],t.prototype,"EffectLayer",void 0),c([f(cc.Node)],t.prototype,"layer_an",void 0),c([f(cc.Node)],t.prototype,"runMask",void 0),c([f(cc.Node)],t.prototype,"FevenAni",void 0),c([p],t)}(cc.Component);n.default=y,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./S146Const":"S146Const","./S146Effect":"S146Effect","./S146Loading":"S146Loading","./S146Menu":"S146Menu"}]},{},["S146Const","S146Effect","S146Label","S146Loading","S146Menu","S146Network","S146Secen"]);