window.__require=function e(t,o,n){function i(a,c){if(!o[a]){if(!t[a]){var r=a.split("/");if(r=r[r.length-1],!t[r]){var l="function"==typeof __require&&__require;if(!c&&l)return l(r,!0);if(s)return s(r,!0);throw new Error("Cannot find module '"+a+"'")}a=r}var h=o[a]={exports:{}};t[a][0].call(h.exports,function(e){return i(t[a][1][e]||e)},h,h.exports,e,t,o,n)}return o[a].exports}for(var s="function"==typeof __require&&__require,a=0;a<n.length;a++)i(n[a]);return i}({JCBill:[function(e,t,o){"use strict";cc._RF.push(t,"e5824Hz9kVJMaoIaYaelf22","JCBill");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./JCManager"),c=cc._decorator,r=c.ccclass,l=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onLoad=function(){this.layer_min=this.node.getChildByName("layer_min"),this.sp_fish0=this.layer_min.getChildByName("sp_fish").getComponent(cc.Sprite),this.lb_gold0=this.layer_min.getChildByName("lb_gold").getComponent("JCLabel"),this.an_fish=this.layer_min.getChildByName("an_fish").getComponent(cc.Animation),this.an_fish.on("finished",this.onFinishAnimate,this)},t.prototype.show=function(e){var t=this;this.param=e,this.node.active=!0,this.seatId=e.seatId,this.layer_min.active=!0,this.layer_min.scale=.8,a.default.once.playSFX("bill_min"),this.lb_gold0.string=e.award?a.default.once.GameLayer.changeGold(e.award):"";var o=a.default.once.getEffectByType("coloursEffect_");o.wrapMode=cc.WrapMode.Loop,this.an_fish.addClip(o),this.an_fish.play(o.name),this.scheduleOnce(function(){t.clean(),a.default.once.GameLayer.EffectLayer.onFinishEffect(t.param),a.default.once.GameLayer.despawnBill(t)},2)},t.prototype.onFinishAnimate=function(){},t.prototype.clean=function(){this.node.stopAllActions(),this.unscheduleAllCallbacks()},s([r],t)}(cc.Component));o.default=l,cc._RF.pop()},{"./JCManager":"JCManager"}],JCBullet:[function(e,t,o){"use strict";cc._RF.push(t,"028a3d8FKFIuZkT5/iSfWE1","JCBullet");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./JCConst"),c=e("./JCFish"),r=e("./JCManager"),l=cc._decorator,h=l.ccclass,p=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.seatId=0,t.bulletId=0,t.angle=0,t.level=0,t.collisionCount=0,t.initTime=0,t._lastUpdateTime=0,t.lockFishId=a.JCConst.once.NotFound,t.radius=0,t}return i(t,e),t.prototype.onLoad=function(){this.node.zIndex=-1,this.sp=this.node.getComponent(cc.Sprite),this.node.setAnchorPoint(cc.v2(.5,1)),this.radius=a.JCConst.once.BulletRadius,this.an_bullet=this.node.getComponent(cc.Animation)},t.prototype.init=function(e){var t=Date.now();this.initTime=t,this.seatId=e.seatId,this.bulletId=e.bulletId,this.bxy=null,this.isDrill=e.isDrill,this.boomWay=e.boomWay,this.boomPercent=e.boomPercent,this.angle=-e.angle,this.node.angle=e.angle,this.node.position=e.point,e.level<2&&(e.level=2),e.level>4&&(e.level=4),this.level=e.level,this.collisionCount=0,this._enableUpdate=!0,this.node.scale=1.46,this.node.active=!0,this.setLockFishID(e.lock),this.initInfo(),this._lastUpdateTime=this.initTime},t.prototype.initInfo=function(){var e=a.JCConst.once.UIAtals.getSpriteFrame("bullet"+this.level+"_"+this.seatId+"_0");e&&(this.sp.spriteFrame=e,this.node.setScale(1))},t.prototype.setLockFishID=function(e){this.lockFish=r.default.once.GameLayer.getLockFishByFishId(e),this.lockFish instanceof c.default?this.lockFishId=e:this.lockFishId=a.JCConst.once.NotFound},t.prototype.setOutPosition=function(e){this.angle=e.angle,this.node.x+=e.x,this.node.y+=e.y},t.prototype.calculateDrillBoomPoint=function(){if(++this.collisionCount==this.boomWay&&this.isDrill){var e=cc.v2(this.node.x,this.node.y),t=cc.view.getVisibleSize(),o=Math.sin(this.angle/180*Math.PI),n=Math.cos(this.angle/180*Math.PI),i=o>0?t.width/2-e.x:-t.width/2-e.x,s=n>0?t.height/2-e.y:-t.height/2-e.y,c=a.JCConst.once.BulletSpeed.x*o,r=a.JCConst.once.BulletSpeed.y*n,l=Math.abs(i/c*this.boomPercent/100),h=Math.abs(s/r*this.boomPercent/100);e.x+=c*Math.min(l,h),e.y+=r*Math.min(l,h),this.bxy=e}},t.prototype.updatexxx=function(){if(this._enableUpdate){if(this.lockFish instanceof c.default){var e=this.lockFish.getWorldPoint(),t=this.node.convertToWorldSpaceAR(cc.v2(0,0));this.angle=r.default.once.convertPointToAngle(t,e)-90}var o=Date.now(),n=(o-this._lastUpdateTime)/1e3;this._lastUpdateTime=o;var i=r.default.once.calculateSpacePoint({angle:this.angle,space:n,speed:a.JCConst.once.BulletSpeed});this.node.x+=i.x,this.node.y+=i.y;var s=r.default.once.convertPositionAngle({x:this.node.x,y:this.node.y,angle:this.angle});s.out?(this.clearLockID(),this.setOutPosition(s),this.calculateDrillBoomPoint()):this.checkDrillBoom(i.x,i.y),this.node.angle=-this.angle}},t.prototype.checkDrillBoom=function(e,t){if(this.bxy&&this.isDrill){var o=this.node.x>this.bxy.x&&e>0||this.node.x<this.bxy.x&&e<0,n=this.node.y>this.bxy.y&&t>0||this.node.y<this.bxy.y&&t<0;if(o||n){this.node.position=this.bxy;var i=this.node.convertToWorldSpaceAR(cc.v2(0,0)),s=a.JCConst.once.IsDrillR*a.JCConst.once.winScale.x,c=r.default.once.inCircleFishs(i,s);r.default.once.requestShotTarget(c.fishId,this.bulletId,3),this.lowerNet(!1)}}},t.prototype.beAttackFish=function(e){e&&e.alive&&e.beAttack()},t.prototype.clearLockID=function(){this.setLockFishID(-1)},t.prototype.lowerNet=function(e,t){void 0===e&&(e=!0),this._enableUpdate=!1,e&&(t=t||this.node.convertToWorldSpaceAR(cc.v2(0,0)),r.default.once.GameLayer.addNet(t,this.level,this.node.angle,this.seatId)),this.an_bullet.currentClip&&this.an_bullet.removeClip(this.an_bullet.currentClip,!0),r.default.once.GameLayer.despawnBullet(this)},t.prototype.sendHitFishReqType=function(e){if(e instanceof c.default&&this.seatId===a.JCConst.once.seatId){var t=this.isDrill?3:1;if(2==e.config.propFish&&(t=7,this.isDrill))return;var o=this.lockFish instanceof c.default?this.lockFish.fishId:null;r.default.once.requestShotTarget(e.fishId,this.bulletId,t,o)}},t.prototype.onCollision=function(e){var t=this.lockFishId===e.fishId;if((this._enableUpdate||t)&&(this.lockFishId===a.JCConst.once.NotFound||t)){if(!this.isDrill){var o=t?e.getWorldPoint():null;this.lowerNet(!0,o)}this.sendHitFishReqType(e),this.beAttackFish(e)}},s([h],t)}(cc.Component));o.default=p,cc._RF.pop()},{"./JCConst":"JCConst","./JCFish":"JCFish","./JCManager":"JCManager"}],JCCoin:[function(e,t,o){"use strict";cc._RF.push(t,"bee5flTaOZDVri2t6vgNR1o","JCCoin");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./JCConst"),c=e("./JCManager"),r=cc._decorator,l=r.ccclass,h=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onLoad=function(){this.sb_bg=this.node.getComponent(cc.Sprite),this.width=this.node.width},t.prototype.clean=function(){this.node.stopAllActions(),this.spIndex=0,this.time=-1,this.node.active=!1},t.prototype.init=function(e){var t=this;this.clean(),this.coinAtlas||(this.coinAtlas=c.default.once.getAtlasByType("coin")),this.node.active=!0,this.param=e;var o=e.position.x+50*e.i,n=e.position.y,i=cc.v2(o,n);this.node.setPosition(i);var s=e.i;this.node.setScale(1),this.node.opacity=0;var r=cc.sequence(cc.fadeIn(.03),cc.moveBy(.12,cc.v2(0,110)).easing(cc.easeOut(3)),cc.moveBy(.1,cc.v2(0,-110)).easing(cc.easeIn(3))),l=cc.spawn(r,cc.scaleTo(.3,1)),h=this.node.parent.convertToNodeSpaceAR(e.to),p=cc.v2((i.x+h.x)/2,i.y+50),d=cc.bezierTo(2,[i,p,h]),f=cc.spawn(d.easing(cc.easeOut(2)),cc.scaleTo(2,.7)),u=cc.callFunc(function(){var t="gold_small";e.fid>9&&(t="gold"),e.fid>19&&(t="gold_big"),e.skillId>100&&(t="gold_effect"),c.default.once.playSFX(t)}),y=cc.callFunc(function(){c.default.once.playSFX("back")}),C=cc.callFunc(function(){0===s&&c.default.once.showCoinLbAction({position:h,award:e.award,self:e.self}),c.default.once.GameLayer.despawnCoin(t)}),g=[];s*=.07,g.push(cc.delayTime(s));var v=!e.skillId,m=e.self&&0===e.i;v&&m&&g.push(u),g.push(l),g.push(cc.delayTime(.7)),v&&m&&g.push(y),g.push(f),g.push(C),this.node.runAction(cc.sequence(g)),this.spIndex=e.i%2?-1:7,this.time=a.JCConst.once.CoinRotationTime},t.prototype.update=function(e){-1!==this.time&&(this.time+=e,this.time>=a.JCConst.once.CoinRotationTime)&&(this.time=0,++this.spIndex>=12&&(this.spIndex=1),this.param&&this.param.self,this.sb_bg.spriteFrame=this.coinAtlas.getSpriteFrame("goldCoin_"+this.spIndex))},s([l],t)}(cc.Component));o.default=h,cc._RF.pop()},{"./JCConst":"JCConst","./JCManager":"JCManager"}],JCConst:[function(e,t,o){"use strict";var n;cc._RF.push(t,"1978c6C4K1K0K/kfPAIUV2k","JCConst"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameLoadType=o.JCConst=o.JCEffectType=o.JCFireSpeed=o.JCFishStatus=void 0,function(e){e[e.Die=0]="Die",e[e.Live=1]="Live"}(o.JCFishStatus||(o.JCFishStatus={})),function(e){e[e.Speed0=.2]="Speed0",e[e.Speed1=.1]="Speed1"}(n=o.JCFireSpeed||(o.JCFireSpeed={})),function(e){e[e.None=0]="None",e[e.Same=101]="Same",e[e.SmallBoom=103]="SmallBoom",e[e.CoinBoom=106]="CoinBoom",e[e.BigBoom=104]="BigBoom",e[e.Double=105]="Double",e[e.Fast=100]="Fast",e[e.Bill=120]="Bill"}(o.JCEffectType||(o.JCEffectType={}));var i=function(){function e(){this.NotFound=999999999,this.CoinRotationTime=.04,this.FishRedDuring=.15,this.NetMaxTime=.2,this.BulletSpeed={x:.6,y:.6},this.BoomR=200,this.IsDrillR=200,this.AutoLimit=n.Speed0,this.FightLimit=n.Speed0,this.WeaponHight=150,this.BorderCount=4,this.BulletRadius=25,this.FireCD=180,this.compensate=0,this.MapCompensate=new Map,this.IsDrill=!1,this.BombId="",this.Round=101,this.BulletCount=0,this.NetUp=0,this.NetDown=0,this.winScale=cc.v2(1,1),this.IsAuto=!1,this.IsLock=!1,this.HeartBeatCD=0,this.MapAtlas=new Map,this.MapSwims=new Map,this.MapDieanis=new Map,this.MapEffects=new Map,this.diamond=0,this.RoomBet=1,this.BLevel=0,this.BLevels=[1,2,3,4,5],this.CannonBets=[],this.seatId=-1,this.userId=-1,this.TableId=-1,this.Entries=0,this.Winning=0,this.users={},this.UIAtals=null}return Object.defineProperty(e,"once",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.destroyInstance=function(){e._instance&&(e._instance=null,delete e._instance)},e}();o.JCConst=i,function(e){e[e.Sprite=0]="Sprite",e[e.Atlas=1]="Atlas",e[e.Skeleton=2]="Skeleton",e[e.ParticleAsset=3]="ParticleAsset",e[e.Prefab=4]="Prefab",e[e.Json=5]="Json"}(o.GameLoadType||(o.GameLoadType={})),cc._RF.pop()},{}],JCEffectLayer:[function(e,t,o){"use strict";cc._RF.push(t,"5a096OrRqtIdrmNckiBSZ4z","JCEffectLayer");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./JCConst"),c=e("./JCManager"),r=e("../../../Script/utils/Utils"),l=cc._decorator,h=l.ccclass,p=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.an_waves=null,t.lb_fire=null,t.layer_recharge=null,t.sk_haicao=null,t}return i(t,e),Object.defineProperty(t.prototype,"map_info",{get:function(){if(!this._map_info){this._map_info=new Map;for(var e=0;e<4;e++)this._map_info.set(e,[])}return this._map_info},set:function(e){this._map_info=e},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){this.initEvents()},t.prototype.initEvents=function(){this.lb_max=this.node.getChildByName("lb_max"),this.lb_ms=this.node.getChildByName("lb_ms").getComponent(cc.Label),this.an_waves.node.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(5,1.8,1.2),cc.delayTime(1),cc.scaleTo(5,1.5,1))));for(var e=this.node.parent.getChildByName("layer_qp"),t=cc.view.getVisibleSize(),o=function(o){var n=e.children[o].getComponent(sp.Skeleton);n.loop=!1,n.premultipliedAlpha=!0,n.enableBatch=!0,n.setAnimationCacheMode(dragonBones.ArmatureDisplay.AnimationCacheMode.SHARED_CACHE),n.setCompleteListener(function(){var e=r.default.randomNum(0,100,2)/100*t.width-t.width/2,o=r.default.randomNum(0,100,2)/100*t.height-t.height/2;n.timeScale=r.default.randomNum(.3,1.8,2);var i=r.default.randomNum(.2,1.2);n.node.setScale(i),n.node.setPosition(e,o),n.setAnimation(0,"animation",!1)}),n.setAnimation(0,"animation",!1)},n=0;n<e.children.length;n++)o(n)},t.prototype.showNetMs=function(){this.lb_ms.string="\u5ef6\u8fdf\uff1a"+(a.JCConst.once.NetUp+a.JCConst.once.NetDown)},t.prototype.prefixInteger=function(e,t){return(e/Math.pow(10,t)).toFixed(t).substr(2)},t.prototype.showLable=function(e){this.lb_fire.node.parent.active=e<-60;var t=Math.ceil(90+e)<0?0:Math.ceil(90+e);this.lb_fire.string="Since you have'nt fired in a minute, you will leave the game in "+t+" s"},t.prototype.showRecharge=function(){Common.showMessage("not enough balance")},t.prototype.onClickedCloseRechargeTip=function(){this.layer_recharge.active=!1,this.layer_recharge.opacity=255,this.layer_recharge.stopAllActions()},t.prototype.defaultLight=function(e){var t="0;0;1000".split(";"),o=t[0]||0,n=t[1]||0,i=e.convertToWorldSpaceAR(cc.v2(parseFloat(o+""),parseFloat(n+""))),s=t[2]||1500;this.initLight(i,s)},t.prototype.initLight=function(e,t){this.v2Light=e,this.lightHeight=parseFloat(t)},t.prototype.pushFishEffect=function(e,t,o,n){for(var i=0;i<e.length;i++){var s=r.default.deepCopy(o),a=e[i];a.alive&&(a.pushEffect(t,s),n&&s.fishId!==a.fishId&&(s.target=a.node.position,s.playSFX=0===i,s.end=i===e.length-1,c.default.once.GameLayer.addEffect(s)))}},t.prototype.addEffect=function(e){var t=this;if(cc.isValid(this.node)){var o=r.default.deepCopy(e);if(o.skillId!==a.JCEffectType.SmallBoom&&o.skillId!==a.JCEffectType.BigBoom&&o.skillId!==a.JCEffectType.CoinBoom||c.default.once.GameLayer.addEffect(o),o.skillId===a.JCEffectType.Fast){o.duringTime=o.time||2,this.pushFishEffect(c.default.once.GameLayer.getFishs(),a.JCEffectType.Fast,o);var n=cc.view.getVisibleSize().width/2-20;this.sk_haicao.node.stopAllActions(),this.sk_haicao.node.active=!0,this.sk_haicao.paused=!1,this.sk_haicao.node.opacity=0;var i=-n-70,s=500/-i/2+2;i-=500;var l=cc.callFunc(function(){t.sk_haicao.node.setPosition(n,0),t.sk_haicao.node.opacity=255,c.default.once.GameLayer.changeSceneBg(o.now,o.anim,o.later)}),h=cc.callFunc(function(){t.sk_haicao.paused=!0,t.sk_haicao.node.active=!1,c.default.once.sendChangeScene()}),p=[cc.delayTime(o.duringTime),l,cc.moveTo(s,cc.v2(i,0)),h];this.sk_haicao.node.runAction(cc.sequence(p))}if(o.skillId===a.JCEffectType.Double&&(c.default.once.playSFX("double"),c.default.once.GameLayer.WeaponLayer.showDoubleByIndex(o.index,o.left)),o.skillId===a.JCEffectType.Bill){o.index=c.default.once.tableConvertIndex(o.seatId),o.nid=r.default.generateMixed(20);var d=this.map_info.get(o.seatId)||[];o.position=c.default.once.GameLayer.WeaponLayer.getWeaponOutPositionByTid(o.seatId,0),o.position.y=o.index>1?o.position.y-138:o.position.y+138,o.limit=o.limit||o.type,d.push(o),this.map_info.set(o.seatId,d),this.checkPlayBill(o)}}},t.prototype.checkPlayBill=function(e){var t=this.map_info.get(e.seatId),o=function(e,t,o,n){for(var i=!0,s=0,a=0,c=0;c<e.length;c++)e[c].limit===t&&o!==e[c].nid&&(i=!1),e[c].limit===t&&s++,e[c].limit!==t||e[c].playing||a++;return i&&n||a===s&&0!==a};if(t)for(var n=0;n<t.length;n++){var i=t[n];o(t,i.limit,i.nid,!i.playing)&&(t[n].playing=!0,this.map_info.set(e.seatId,t),c.default.once.GameLayer.addBill(t[n]))}},t.prototype.onFinishEffect=function(e){if(-1!==[a.JCEffectType.Bill].indexOf(e.skillId)){for(var t=this.map_info.get(e.seatId),o=0;o<t.length;o++)if(t[o].nid===e.nid){t.splice(o,1);break}this.map_info.set(e.seatId,t),this.checkPlayBill(e)}},t.prototype.updateShadowEffect=function(e,t){var o=e.x-this.v2Light.x,n=e.y-this.v2Light.y,i=cc.v2(0,0),s=e.sub(this.v2Light).mag(),a=(t+this.lightHeight)*s/this.lightHeight;return i.x=e.x+o*(a/s-1),i.y=e.y+n*(a/s-1),i},t.prototype.onDestroy=function(){},s([p(cc.Animation)],t.prototype,"an_waves",void 0),s([p(cc.Label)],t.prototype,"lb_fire",void 0),s([p(cc.Node)],t.prototype,"layer_recharge",void 0),s([p(sp.Skeleton)],t.prototype,"sk_haicao",void 0),s([h],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./JCConst":"JCConst","./JCManager":"JCManager"}],JCEffect:[function(e,t,o){"use strict";cc._RF.push(t,"d60f3b6s1hLiKurMDfhb1FE","JCEffect");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./JCConst"),c=e("./JCManager"),r=cc._decorator,l=r.ccclass,h=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.registerMsg=function(){},t.prototype.unregisterMsg=function(){},Object.defineProperty(t.prototype,"sk_effect",{get:function(){return this._sk_effect||this.initSkeleton(),this._sk_effect},set:function(e){this._sk_effect=e},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){this.an_effect=this.node.getChildByName("sp_effect").addComponent(cc.Animation),this.an_effect.on("finished",this.onFinishAnimate,this),this.node_effect=this.node.getChildByName("sk_effect"),this.sp_effect=this.node.getChildByName("sp_effect").getComponent(cc.Sprite),this.sp_bg=this.node.getChildByName("sp_bg").getComponent(cc.Sprite),this.sp_bg.node.on("click",this.onClickedEffect,this)},t.prototype.initSkeleton=function(){this.node_effect.parent=this.node,this.node_effect.scale=1,this._sk_effect=this.node_effect.addComponent(sp.Skeleton),this._sk_effect.premultipliedAlpha=!1,this._sk_effect.enableBatch=!0,this._sk_effect.setAnimationCacheMode(dragonBones.ArmatureDisplay.AnimationCacheMode.SHARED_CACHE),this._sk_effect.setCompleteListener(this.onFinishAnimate.bind(this)),this.node_effect.color=cc.Color.WHITE,this.node_effect.setPosition(0,0)},t.prototype.init=function(e){var t;return this.node.position=e.position||cc.v2(0,0),this.node.angle=0,this.node.active=!0,this.node.zIndex=0,this.param=e,this.node.scale=1,this.node.opacity=255,this.sp_effect.spriteFrame=null,this.sp_bg.spriteFrame=null,this.sp_bg.node.setPosition(0,0),e.skillId,a.JCEffectType.BigBoom,e.skillId==a.JCEffectType.SmallBoom||e.skillId==a.JCEffectType.BigBoom?(this.node.scale=1.6,(t=c.default.once.getEffectByType("bombEffect_")).wrapMode=cc.WrapMode.Normal,this.an_effect.addClip(t),void this.an_effect.play(t.name)):e.skillId==a.JCEffectType.CoinBoom?(this.node.scale=2.5,(t=c.default.once.getEffectByType("coinEffect_")).wrapMode=cc.WrapMode.Normal,this.an_effect.addClip(t),void this.an_effect.play(t.name)):void 0},t.prototype.onFinishAnimate=function(){this.onFinishEffect()},t.prototype.onFinishEffect=function(){c.default.once.GameLayer.EffectLayer.onFinishEffect(this.param),c.default.once.GameLayer.despawnEffect(this)},t.prototype.onClickedEffect=function(){this.param&&this.param.clicked},t.prototype.update=function(){this._sk_effect&&this._sk_effect.node&&(this._sk_effect.node.position=this.node.position)},t.prototype.clean=function(){this.unscheduleAllCallbacks(),this.node.stopAllActions(),this.an_effect.node.stopAllActions(),this.sp_bg.spriteFrame=null,this.param&&(this.param.clicked=!0);var e=this.an_effect.currentClip;e&&this.an_effect.removeClip(e,!0),this.sk_effect&&(this.sk_effect.paused=!0,this.sk_effect.destroy(),this.sk_effect=null),this.node_effect.removeComponent(sp.Skeleton),this.node_effect.parent=this.node,this.node_effect.setPosition(0,0)},s([l],t)}(cc.Component));o.default=h,cc._RF.pop()},{"./JCConst":"JCConst","./JCManager":"JCManager"}],JCFishNet:[function(e,t,o){"use strict";cc._RF.push(t,"22f811Srt5Bt6NOK+nyPN1v","JCFishNet");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./JCConst"),c=e("./JCManager"),r=cc._decorator,l=r.ccclass,h=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.netRedius=70,t}return i(t,e),t.prototype.onLoad=function(){var e=this;this.sp_net=this.node.getComponent(cc.Sprite),this.an_net=this.node.getComponent(cc.Animation);var t=c.default.once.getEffectByType("blast1_");t.wrapMode=cc.WrapMode.Normal,this.an_net.addClip(t),this.an_net.on("finished",function(){e.onFinishNet()})},t.prototype.onFinishNet=function(){c.default.once.GameLayer?c.default.once.GameLayer.despawnNet(this):this.node.destroy()},t.prototype.init=function(e,t,o,n){this.node.position=this.node.parent.convertToNodeSpaceAR(e),this.node.active=!0,this.node.angle=o,this.node.opacity=255,this.sp_net.spriteFrame=null;var i=[];2==t&&(i=[0,1]),3==t&&(i=[0,1,2]),4==t&&(i=[0,1,2,3]);var s=c.default.once.tableConvertIndex(n),r=c.default.once.GameLayer.WeaponLayer.DoubleBg[s].active;r&&(i=[],this.an_net.play("blast1_"));for(var l=0;l<this.node.children.length;l++)this.node.children[l].active=-1!=i.indexOf(l);if(!r){2==t&&(this.node.children[0].setPosition(30,0),this.node.children[1].setPosition(-30,0)),3==t&&(this.node.children[0].setPosition(40,0),this.node.children[1].setPosition(-40,0),this.node.children[2].setPosition(0,0)),4==t&&(this.node.children[0].setPosition(30,-30),this.node.children[1].setPosition(-30,30),this.node.children[2].setPosition(30,30),this.node.children[3].setPosition(-30,-30));var h=2*this.netRedius;this.node.width=h,this.node.height=h,this.node.scale=2;var p=[],d=cc.scaleTo(a.JCConst.once.NetMaxTime,1.2);p.push(d);var f=cc.scaleTo(2*a.JCConst.once.NetMaxTime/3,1);p.push(f),p.push(cc.fadeOut(.1));var u=cc.callFunc(this.onFinishNet.bind(this));p.push(u),this.node.runAction(cc.sequence(p))}},s([l],t)}(cc.Component));o.default=h,cc._RF.pop()},{"./JCConst":"JCConst","./JCManager":"JCManager"}],JCFish:[function(e,t,o){"use strict";cc._RF.push(t,"c2dcf2P+9FNJY61y3AeshnT","JCFish");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./JCConst"),c=e("./JCManager"),r=cc._decorator,l=r.ccclass,h=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fid=-1,t.fishId=-1,t.index=-1,t._state=a.JCFishStatus.Die,t._outBorder=!1,t.skillId=-1,t.enbaleMove=!0,t.lastPosition=null,t.initTime=0,t._lastUpdateTime=0,t.swimTime=10,t.leaveTime=0,t.mapEffects=new Map,t.radius=0,t}return i(t,e),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){this._state=e,this.checkLock()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outBorder",{get:function(){return this._outBorder},set:function(e){this._outBorder=e,this.checkLock()},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){this.initView()},t.prototype.initView=function(){this.sp_fish=this.node.getChildByName("sp_fish").getComponent(cc.Sprite),this.sp_effect=this.node.getChildByName("sp_effect").getComponent(cc.Sprite),this.sp_shadow=this.node.getChildByName("sp_shadow").getComponent(cc.Sprite),this.an_fish=this.sp_fish.node.getComponent(cc.Animation),this.an_fish.on("finished",this.onFinishAnimate,this),this.sp_fish.node.on(cc.Node.EventType.TOUCH_START,this.onClickFish,this),this.sp_effect.node.on(cc.Node.EventType.TOUCH_START,this.onClickFish,this)},t.prototype.onClickFish=function(e){c.default.once.GameLayer.WeaponLayer.onTouchStart(e,this)},t.prototype.init=function(e){this.node.active=!0,this.flipY=a.JCConst.once.seatId>1,this.fid=e.fid,this.fishId=e.fishId,this.index=e.index,this.skillId=e.skillId,this.swimTime=e.pathInterval,this.initTime=Date.now()-e.compensate-1e3*e.swimmingInterval,this.config=e.config,this.FishPath=e.FishPath;var t=e.groups.points[this.index];this.gpoint=cc.v2(e.groups.origin.x+t.x,e.groups.origin.y+t.y),this.colliders=e.conlliderPoints,this.resetInfo();var o=e.swimAni;if(o.wrapMode=cc.WrapMode.Loop,this.an_fish.addClip(o),this.an_fish.play(o.name),this.sp_effect.node.active=28==e.config.fishType||27==e.config.fishType||2==e.config.propFish,this.sp_effect.node.active){var n=c.default.once.getFishLayerIndex(e.fid),i=2==e.config.propFish?"bg_1":"bg_0",s=2==e.config.propFish?1:.5;this.sp_effect.node.setScale(s),this.sp_effect.spriteFrame=a.JCConst.once.MapAtlas.get("fish"+n).getSpriteFrame(i),this.sp_effect.node.runAction(cc.repeatForever(cc.rotateBy(2,360)))}this.node.runAction(cc.fadeIn(.1))},t.prototype.getColliderPoints=function(){for(var e=this.node.convertToWorldSpaceAR(cc.v2(0,0)),t=[],o=0;o<this.colliders.length;o++)t.push(cc.v2(e.x+this.colliders[o].x,e.y+this.colliders[o].y));return{ws:t,zIndex:this.node.zIndex}},t.prototype.resetInfo=function(){this.sp_fish.spriteFrame=null,this.sp_shadow.spriteFrame=null,this.node.opacity=0,this.sp_fish.node.color=cc.Color.WHITE,this._lastUpdateTime=Date.now(),this.setState(a.JCFishStatus.Live),this.outBorder=c.default.once.checkLimitBorder(this.node),this.cleanLockWeapons(),this.enbaleMove=!0,this.mapEffects=null,this.mapEffects=new Map,this.node.zIndex=parseFloat(this.config.Layer||0),this.leaveTime=this.swimTime,this.node.angle=this.FishPath.scale<0?180:0;var e=parseFloat(this.config.Scale),t=this.FishPath.scale*parseFloat(this.config.Scale);this.sp_fish.node.setScale(e,t),this.sp_shadow.node.setScale(e,t);for(var o=c.default.once.convertWindowScale(),n=0;n<this.colliders.length;n++){var i=this.colliders[n],s=i.x*e*o.x,r=i.y*t*o.y;this.radius=Math.max(this.radius,cc.v2(s,r).mag())}this.lastPosition=cc.v2(this.FishPath.points[0].x,this.FishPath.points[0].y),this.node.setPosition(this.lastPosition.x,this.lastPosition.y)},t.prototype.animateFrameChange=function(){this.setShadowSpriteFrame()},t.prototype.getShadowWorldPoint=function(){return this.sp_shadow.node.convertToWorldSpaceAR(cc.v2(0,0))},t.prototype.getWorldPoint=function(){var e={1053:cc.v2(130,0),1036:cc.v2(200,0),1038:cc.v2(50,0),1047:cc.v2(70,0),1019:cc.v2(70,0),1039:cc.v2(100,0)}[this.fid]||cc.v2(0,0);return this.node.convertToWorldSpaceAR(e)},t.prototype.setShadowSpriteFrame=function(){if(this.sp_shadow.spriteFrame!=this.sp_fish.spriteFrame){var e=2!=this.config.propFish&&this.sp_effect.node.active?.5:1;this.sp_shadow.node.scaleX=e*this.sp_shadow.node.scaleX,this.sp_shadow.node.scaleY=e*this.sp_shadow.node.scaleY,this.sp_shadow.spriteFrame=this.sp_effect.node.active?this.sp_effect.spriteFrame:this.sp_fish.spriteFrame}},t.prototype.updateShadowEffect=function(){var e=this.node.convertToWorldSpaceAR(cc.v2(0,0)),t=c.default.once.GameLayer.EffectLayer.updateShadowEffect(e,parseFloat(this.config.Layer)),o=this.sp_shadow.node.parent.convertToNodeSpaceAR(t);this.sp_shadow.node.setPosition(o.x,o.y),this.setShadowSpriteFrame()},t.prototype.getSwimF=function(e){return e-this.initTime},t.prototype.pushEffect=function(e,t){if(e===a.JCEffectType.Fast){var o=this.leaveTime/t.duringTime;this.mapEffects.set(e,o)}},t.prototype.runCurrent=function(e,t){e.currentClip&&e[t](e.currentClip.name)},t.prototype.popEffect=function(e){this.mapEffects.get(e)&&this.mapEffects.delete(e)},t.prototype.setState=function(e){this.state=e},t.prototype.onFinishAnimate=function(){var e=this.an_fish.currentClip;e&&-1!==e.name.indexOf("die")&&this.despawnFish()},t.prototype.pushLockSeat=function(e){return-1===this.lockWeapons.indexOf(e)&&(this.lockWeapons.push(e),!0)},t.prototype.popLockTid=function(e){var t=this.lockWeapons.indexOf(e);-1!==t&&this.lockWeapons.splice(t,1)},t.prototype.cleanLockWeapons=function(){this.lockWeapons=[]},t.prototype.calculateFPoint=function(e){if(e<=1){var t=Math.ceil(this.FishPath.points.length*e);t>this.FishPath.points.length-1&&(t=this.FishPath.points.length-1);var o=this.FishPath.points[t],n=o.y+this.gpoint.y;this.flipY&&(n=-n);var i=this.gpoint.x+o.x;return cc.v2(i*a.JCConst.once.winScale.x,n*a.JCConst.once.winScale.y)}return cc.v2(1e5,1e5)},t.prototype.updateDegree=function(){var e=cc.v2(this.node.x,this.node.y),t=c.default.once.convertPointToAngle(e,this.lastPosition);this.node.angle=-t,this.lastPosition=e},t.prototype.beAttack=function(){var e=this;this.sp_fish.node.color=cc.Color.BLACK.fromHEX("#FD8484"),this.node.stopActionByTag(a.JCConst.once.FishAttackAniTag);var t=cc.sequence([cc.delayTime(a.JCConst.once.FishRedDuring),cc.callFunc(function(){e.sp_fish.node.color=cc.Color.WHITE})]);t.setTag(a.JCConst.once.FishAttackAniTag),this.node.runAction(t)},t.prototype.playDieAni=function(){var e=c.default.once.getDeathAnimateByID(this.fid);e.wrapMode=cc.WrapMode.Normal,this.an_fish.stop(),this.an_fish.removeClip(this.an_fish.currentClip),this.an_fish.addClip(e),this.an_fish.play(e.name)},t.prototype.goDie=function(){this.enbaleMove=!1,this.setState(a.JCFishStatus.Die)},Object.defineProperty(t.prototype,"alive",{get:function(){return this.state===a.JCFishStatus.Live},enumerable:!1,configurable:!0}),t.prototype.checkDespawn=function(){this.leaveTime<0&&this.despawnFish()},t.prototype.clearLock=function(){c.default.once.GameLayer.clearLockFishAllBullet(this.fishId),c.default.once.GameLayer.WeaponLayer.cleanFishAllWeaponLock(this),this.cleanLockWeapons()},t.prototype.despawnFish=function(){this.sp_effect.node.stopAllActions(),this.clearLock(),this.unscheduleAllCallbacks(),this.mapEffects=new Map;var e=this.an_fish.getClips();if(e)for(var t=0;t<e.length;t++)this.an_fish.removeClip(e[t],!0);this.node.active=!1,c.default.once.GameLayer?c.default.once.GameLayer.despawnFish(this):this.node.destroy()},t.prototype.checkLock=function(){this.outBorder&&this.alive||this.clearLock()},t.prototype.updateEffect=function(e){var t=this,o=e;return this.mapEffects.size<=0?o:(this.mapEffects.forEach(function(e,n){var i=t.mapEffects.get(n);n===a.JCEffectType.Fast&&(o*=i)}),o)},t.prototype.updatexxx=function(e){if(-1!==this.fid){var t=this.updateEffect(e);if(this.enbaleMove){var o=this.updateTime(t);this.updatePonint(o)}this.lastPosition.sub(cc.v2(this.node.x,this.node.y)).mag()>2&&("1"===this.config.Rotation&&this.updateDegree(),this.updateShadowEffect()),this.outBorder=c.default.once.checkLimitBorder(this.node),this.updateLockWeapon()}},t.prototype.updateTime=function(e,t){void 0===t&&(t=!0);var o=this._lastUpdateTime+1e3*e;t&&(this._lastUpdateTime=o);var n=this.getSwimF(o)/1e3;return this.leaveTime=this.swimTime-n,n/this.swimTime},t.prototype.updatePonint=function(e){if(e<=1){var t=this.calculateFPoint(e);this.node.x=t.x,this.node.y=t.y}else this.checkDespawn()},t.prototype.updateLockWeapon=function(){this.lockWeapons.length>0&&c.default.once.showLockLineByTid(this,this.lockWeapons)},t.prototype.onDestroy=function(){},s([l],t)}(cc.Component));o.default=h,cc._RF.pop()},{"./JCConst":"JCConst","./JCManager":"JCManager"}],JCLabel:[function(e,t){"use strict";cc._RF.push(t,"f41e4CtNe9DpacoH8TRNhRz","JCLabel");var o=cc.Enum({LEFT:0,CENTER:1,RIGHT:2});cc.Class({editor:!1,extends:cc.Component,properties:{_layout:{get:function(){var e=this.node.getComponent(cc.Layout);return e||((e=this.node.addComponent(cc.Layout)).type=1),e}},string:{default:"",notify:function(){this._updateWordArt()}},alignType:{type:o,default:o.CENTER,notify:function(){this._checkAnchorX()}},defaultNames:{default:"2"},convert:{default:!1},spriteAtlas:{type:cc.SpriteAtlas,default:null}},onLoad:function(){this._checkAnchorX()},_checkAnchorX:function(){this.alignType===o.CENTER?this.node.anchorX=.5:this.node.anchorX=this.alignType===o.RIGHT?1:0},_updateWordArt:function(){if(!this.spriteAtlas)return cc.log("\u65e0\u6548\u7684 spriteAtlas \u56fe\u96c6\u8d44\u6e90\uff01");this._names=this.defaultNames.split(","),this.setWordArt()},setWordArt:function(){try{for(var e=(""+this.string).split(""),t=this.node.children,n=0,i=0;i<e.length||i<t.length;i++){var s=t[i];if(s||((a=(s=new cc.Node).addComponent(cc.Sprite)).trim=!1,a.sizeMode=cc.Sprite.SizeMode.RAW,a.type=cc.Sprite.Type.SIMPLE),s.parent||(s.parent=this.node),s.active=i<e.length,s.active){var a=s.getComponent(cc.Sprite),c=e[this.alignType!==o.CENTER?e.length-1-i:i];if("."!==c||this.convert||(c="_"),c=this._names[0]+c,this._names[1]&&(c+=this._names[1]),void 0===c)return void cc.log("\u56fe\u96c6\u8d44\u6e90spriteAtlas \u627e\u4e0d\u5230\u56fe\u7247\u540d\u79f0\uff1a"+c+"\uff01");a.spriteFrame=this.spriteAtlas.getSpriteFrame(""+c),n+=s.width}}n+=(e.length+1)*this._layout.spacingX,this._layout.paddingLeft=this._layout.spacingX,this._layout.paddingRight=this._layout.spacingX,this.node.width=n,this.alignType===o.RIGHT&&(this._layout.horizontalDirection=1),this.alignType===o.LEFT&&(this._layout.horizontalDirection=1),this.alignType===o.CENTER&&(this._layout.horizontalDirection=0)}catch(r){console.log(r)}}}),cc._RF.pop()},{}],JCLoading:[function(e,t,o){"use strict";cc._RF.push(t,"3b4f6eTw6ZKQZ0dM7ElAvgW","JCLoading");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../../Script/utils/Utils"),c=e("./JCConst"),r=cc._decorator,l=r.ccclass,h=r.property,p=function(t){function o(){var e=null!==t&&t.apply(this,arguments)||this;return e.click=null,e.back=null,e.bill_min=null,e.die=null,e.die_big=null,e.die_small=null,e.effect_108=null,e.gold=null,e.gold_effect=null,e.gold_small=null,e.lock=null,e.weapon_change=null,e.v1=null,e.v2=null,e.v3=null,e.v4=null,e.v5=null,e.v6=null,e.v7=null,e.v8=null,e.v9=null,e.bg0=null,e.bg1=null,e.bg2=null,e.configs=[],e.fishs=[],e.effectArr=[],e.fish0=null,e.fish1=null,e.fish2=null,e.ui=null,e.coin=null,e.font=null,e}return i(o,t),o.prototype.onLoad=function(){c.JCConst.once.PlayerInfo=e("PlayerInfo").getInstant,c.JCConst.once.PlayerInfo.fishBetList&&(c.JCConst.once.BLevels=c.JCConst.once.PlayerInfo.fishBetList),this.loadFinish()},o.prototype.loadFinish=function(){c.JCConst.once.FishConfigs=this.configs[1].json;var e=this.configs[2].json.data,t=this.configs[0].json;c.JCConst.once.FishGroups=t.data,c.JCConst.once.FishPoints=this.configs[3].json;var o=[],n=[];c.JCConst.once.FishPath=[];for(var i=0;i<300&&!(e.length<=i);i++){for(var s=e[i],a=[],r=0;r<=1500;r++){var l=r/1500,h=this.makeBreakBezier2(l,s.points,s.controls);a.push(h)}s.time=s.time>30?30:s.time,c.JCConst.once.FishPath.push({id:s.id,points:a,time:s.time,scale:1})}var p=[{key:"blast1_",space:20},"effect0_","effect1_","effect2_","effect3_",{key:"coinEffect_",space:20},{key:"bombEffect_",space:20},"iceEffect_",{key:"coloursEffect_",space:10}],d=[],f=["ui","coin","font","fish0","fish1","fish2"];for(c.JCConst.once.UIAtals=this.ui,i=0;i<this.fishs.length;i++)this.fishs[i]instanceof cc.SpriteAtlas&&o.push(this.fishs[i].getSpriteFrames());for(i=0;i<this.effectArr.length;i++)this.effectArr[i]instanceof cc.SpriteAtlas&&n.push(this.effectArr[i].getSpriteFrames());for(i=0;i<d.length;i++){var u=d[i];c.JCConst.once.MapEffects.set(u,this[u])}for(i=0;i<f.length;i++)u=f[i],c.JCConst.once.MapAtlas.set(u,this[u]);var y=c.JCConst.once.FishConfigs;for(i=0;i<y.length;i++){var C=y[i],g=(u=C.FishID,"1"===C.AnimType?c.GameLoadType.Skeleton:c.GameLoadType.Atlas);if(g===c.GameLoadType.Atlas){C.SwimActFPS=parseInt(C.SwimActFPS);var v=this.getAni(o,u+"_",g,cc.WrapMode.Loop,C.SwimActFPS);c.JCConst.once.MapSwims.set(u,v);var m="1"===C.DeadAct?"die"+u+"_":u+"_",_=this.getAni(o,m,g,cc.WrapMode.Loop,2*C.SwimActFPS,null,2);_.name="die"+u+"_",c.JCConst.once.MapDieanis.set(u,_)}else v="sk_"+u,c.JCConst.once.MapSwims.set(u,this[v])}for(i=0;i<p.length;i++){var J=p[i],b=(u="string"==typeof J?J:J.key,J.space||10),I=this.getAni(n,u,c.GameLoadType.Atlas,cc.WrapMode.Default,b);c.JCConst.once.MapEffects.set(u,I)}},o.prototype.convertVectorToPoint=function(e,t,o){return cc.v2(e.x+-(e.x-t.x)*o,e.y+-(e.y-t.y)*o)},o.prototype.makeBreakBezier2=function(e,t,o){if(t&&t.length){if(e<=0)return t[0];if(e>=1)return t[t.length-1];for(var n=0,i=this.cheekVectorOrTimeIndex(t,e,!0),s=[t[i.index-1],o[i.index-1],t[i.index]];n<1e3;){n++;for(var a=s.length-1,c=0;c<a;c++)if(s[c]=this.convertVectorToPoint(s[c],s[c+1],i.f),c===a-1&&(s.splice(a,s.length),1===s.length))return s[0]}}},o.prototype.cheekVectorOrTimeIndex=function(e,t,o){for(var n=0,i=[],s=1;s<e.length;s++){var a=100;if(!o){var c=e[s-1],r=e[s];a=Math.pow(r.x-c.x,2)+Math.pow(r.y-c.y,2),a=Math.sqrt(a)}i.push(a),n+=a}var l=0,h=0;for(s=0;s<i.length;s++){h=s+1;var p=n*t,d=l+(a=i[s]);if(l<p&&p<=d)return{index:h,f:1-(d-p)/a};l=d}return null},o.prototype.desArray=function(e,t){void 0===t&&(t=[]);var o=t.concat(["die"]);return e.sort(function(e,t){for(var n=e.name,i="",s=0;s<o.length;s++)if(-1!==n.indexOf(o[s])){i=o[s];break}var a=n.split(i);n=a[a.length-1];var c=t.name,r=c.split(i);c=r[r.length-1];var l=Math.ceil(n),h=Math.ceil(c);return l>h?1:l<h?-1:0}),e},o.prototype.findArrayFile=function(e,t,o){for(var n=[],i=null,s=0;s<e.length;s++){var r=e[s];if(o===c.GameLoadType.Atlas)if(r instanceof Array)for(var l=0;l<r.length;l++){var h=r[l],p=h.name.split(t);this.same(t,h.name)&&""==p[0]&&a.default.isNumber(p[1])&&n.push(h)}else this.same(t,r.name)&&(p=r.name.split(t),a.default.isNumber(p[1])&&""==p[0]&&n.push(r));else r.name&&-1!==r.name.indexOf(t)&&(i=r)}return o===c.GameLoadType.Atlas?n:i},o.prototype.same=function(e,t){e=e.split(""),t=t.split("");for(var o=0;o<e.length;o++)if(e[o]!=t[o])return!1;return!0},o.prototype.getAni=function(e,t,o,n,i,s,c){void 0===n&&(n=cc.WrapMode.Loop),void 0===s&&(s=null),void 0===c&&(c=1),i=i||10;var r=this.findArrayFile(e,t,o);if(r=this.desArray(r,[t]),1!==c){for(var l=[],h=0;h<c;h++)for(var p=0;p<r.length;p++)l.push(r[p]);r=l}var d=a.default.createWithSpriteFrames(r,i,"animateFrameChange",s);return d.name=t,d.wrapMode=n,d},s([h(cc.AudioClip)],o.prototype,"click",void 0),s([h(cc.AudioClip)],o.prototype,"back",void 0),s([h(cc.AudioClip)],o.prototype,"bill_min",void 0),s([h(cc.AudioClip)],o.prototype,"die",void 0),s([h(cc.AudioClip)],o.prototype,"die_big",void 0),s([h(cc.AudioClip)],o.prototype,"die_small",void 0),s([h(cc.AudioClip)],o.prototype,"effect_108",void 0),s([h(cc.AudioClip)],o.prototype,"gold",void 0),s([h(cc.AudioClip)],o.prototype,"gold_effect",void 0),s([h(cc.AudioClip)],o.prototype,"gold_small",void 0),s([h(cc.AudioClip)],o.prototype,"lock",void 0),s([h(cc.AudioClip)],o.prototype,"weapon_change",void 0),s([h(cc.AudioClip)],o.prototype,"v1",void 0),s([h(cc.AudioClip)],o.prototype,"v2",void 0),s([h(cc.AudioClip)],o.prototype,"v3",void 0),s([h(cc.AudioClip)],o.prototype,"v4",void 0),s([h(cc.AudioClip)],o.prototype,"v5",void 0),s([h(cc.AudioClip)],o.prototype,"v6",void 0),s([h(cc.AudioClip)],o.prototype,"v7",void 0),s([h(cc.AudioClip)],o.prototype,"v8",void 0),s([h(cc.AudioClip)],o.prototype,"v9",void 0),s([h(cc.AudioClip)],o.prototype,"bg0",void 0),s([h(cc.AudioClip)],o.prototype,"bg1",void 0),s([h(cc.AudioClip)],o.prototype,"bg2",void 0),s([h([cc.JsonAsset])],o.prototype,"configs",void 0),s([h([cc.SpriteAtlas])],o.prototype,"fishs",void 0),s([h([cc.SpriteAtlas])],o.prototype,"effectArr",void 0),s([h(cc.SpriteAtlas)],o.prototype,"fish0",void 0),s([h(cc.SpriteAtlas)],o.prototype,"fish1",void 0),s([h(cc.SpriteAtlas)],o.prototype,"fish2",void 0),s([h(cc.SpriteAtlas)],o.prototype,"ui",void 0),s([h(cc.SpriteAtlas)],o.prototype,"coin",void 0),s([h(cc.SpriteAtlas)],o.prototype,"font",void 0),s([l],o)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./JCConst":"JCConst",PlayerInfo:void 0}],JCManager:[function(e,t,o){"use strict";cc._RF.push(t,"d184eOVa2xJ94/9q3lNOkgZ","JCManager");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./JCConst"),c=e("./JCScene"),r=e("./JCFish"),l=e("./JCBullet"),h=e("../../../Script/utils/Utils"),p=e("./JCNetWork"),d=cc._decorator,f=d.ccclass,u=d.property,y=function(t){function o(){var e=null!==t&&t.apply(this,arguments)||this;return e.GameLayer=null,e.MusicDic={},e}var n;return i(o,t),n=o,Object.defineProperty(o,"once",{get:function(){return n.instance||(n.instance=new n),n.instance},enumerable:!1,configurable:!0}),o.destroyInstance=function(){n.instance&&(n.instance=null)},o.prototype.showNetError=function(e){cc.isValid(n.once.GameLayer.node)&&(n.once.GameLayer.MenuLayer.LayerNetError.active=e,a.JCConst.once.IsAuto&&this.GameLayer.MenuLayer.onClickedAuto(!1))},o.prototype.requestFishFire=function(e,t){var o=a.JCConst.once.BLevels[a.JCConst.once.BLevel],n=o*a.JCConst.once.RoomBet,i=this.codePoint(e),s={userid:a.JCConst.once.userId,bet:o,position:i,bulletId:h.default.generateMixed(20),isDrill:a.JCConst.once.IsDrill};a.JCConst.once.IsDrill?(s.bulletId=a.JCConst.once.BombId,s.boomWay=10,s.boomPercent=50):t&&(s.fishId=t),n<=a.JCConst.once.Entries?(this.ShotSelfBullet(s),p.default.once.send("fishShoot",s),a.JCConst.once.IsDrill=!1):(a.JCConst.once.IsLock&&this.GameLayer.MenuLayer.onClickedLock(),a.JCConst.once.IsAuto&&this.GameLayer.MenuLayer.onClickedAuto(),this.GameLayer.EffectLayer.showRecharge(!0))},o.prototype.requestLeaveRoom=function(){p.default.once.requestLeaveRoom()},o.prototype.requestRechargeAll=function(){var e=this.getUser();e&&e.wins&&e.wins>10&&p.default.once.send("chargeAll",{})},o.prototype.requestRechargeSum=function(){},o.prototype.heartBeat=function(){},o.prototype.requestShotTarget=function(e,t,o,n,i){void 0===o&&(o=1),void 0===i&&(i=!1);var s={uid:a.JCConst.once.userId,fishId:e,bulletId:t,bulletType:o};n&&(s.lockFishId=n),i&&(cc.log("fishHit----3---\x3e"+JSON.stringify(s)),s.format=1),p.default.once.send("fishHit",s)},o.prototype.requestChangeCannonBet=function(e){p.default.once.send("changePower",e)},o.prototype.CmdJCLordSettle=function(e){if(cc.log("CmdJCLordSettle: "+JSON.stringify(e)),e.bonus){e.bonus*=a.JCConst.once.RoomBet;var t=this.userConvertSeatId(e.userId);n.once.GameLayer.EffectLayer.addEffect({seatId:t,award:e.bonus,skillId:a.JCEffectType.Bill})}},o.prototype.rechargeAllResult=function(e){var t=this.userConvertSeatId(e.userId);a.JCConst.once.users[t].score=e.score,a.JCConst.once.users[t].wins=e.wins,e.userId==a.JCConst.once.userId&&(this.GameLayer.showRecharge(!0),a.JCConst.once.Entries=e.score,a.JCConst.once.Winning=e.wins),this.GameLayer.updateBalance(e.userId,e.score),this.GameLayer.updateDiamond(e.userId,e.wins)},o.prototype.CmdJCLord=function(e){cc.log("CmdJCLord: "+JSON.stringify(e));var t=this.userConvertIndex(e.userId);this.GameLayer.EffectLayer.addEffect({skillId:a.JCEffectType.Double,index:t,left:30})},o.prototype.CmdJCSmallBomb=function(e){cc.log("CmdJCSmallBomb: "+JSON.stringify(e));var t=e.position;this.GameLayer.EffectLayer.addEffect({skillId:a.JCEffectType.SmallBoom,position:t});var o=a.JCConst.once.BoomR*a.JCConst.once.winScale.x,n=this.inCircleFishs(e.wsp,o);e.seatId===a.JCConst.once.seatId&&n.fishId.length>0&&(cc.log("inCircleFishs:"+JSON.stringify(n.fishId)),this.requestShotTarget(n.fishId,e.bombId,3))},o.prototype.CmdJCBigBomb=function(e){cc.log("CmdJCBigBomb: "+JSON.stringify(e));var t=e.position;if(this.GameLayer.EffectLayer.addEffect({skillId:a.JCEffectType.BigBoom,position:t}),e.seatId===a.JCConst.once.seatId){for(var o=this.GameLayer.getFishs(),n=[],i=0;i<o.length;i++){var s=o[i];s.alive&&n.push(s.fishId)}cc.log("inCircleFishs:"+JSON.stringify(n)),this.requestShotTarget(n,e.bombId,3)}},o.prototype.CmdJCSameBomb=function(e){if(cc.log("CmdJCSameBomb: "+JSON.stringify(e)),e.seatId===a.JCConst.once.seatId){for(var t=this.GameLayer.getFishs(),o=0;o<t.length;o++){var n=t[o];n.alive&&n.config.fishType==e.fishType&&this.requestShotTarget(n.fishId,e.bombId,7,!1,!0)}cc.log("inCircleFishs:"+JSON.stringify([]))}},o.prototype.CmdBYFishSeatChange=function(e,t){t&&(t.userId=t.UserId),a.JCConst.once.users[e]=t,this.GameLayer.refreshTable(t)},o.prototype.CmdBYCannonChange=function(e){if(cc.log("CmdBYCannonChange: "+JSON.stringify(e)+",cg:"+typeof e),"string"==typeof e&&(e=JSON.parse(e)),e.userid==a.JCConst.once.userId)for(var t=0;t<a.JCConst.once.BLevels.length;t++)if(e.bet==a.JCConst.once.BLevels[t]){a.JCConst.once.BLevel=t;break}this.GameLayer.WeaponLayer.setWeaponGold(e.userid,e.bet),this.GameLayer.WeaponLayer.setLevelByUID(e.userid,e.bet)},o.prototype.CmdBYTable=function(e){var t=e.ResultData;a.JCConst.once.seatId=t.seatId,a.JCConst.once.userId=a.JCConst.once.PlayerInfo.playerId,a.JCConst.once.users={};for(var o=0;o<t.userList.length;o++){var i=t.userList[o];a.JCConst.once.users[i.seatId]=i,i.userId==a.JCConst.once.userId&&(a.JCConst.once.Entries=i.score,a.JCConst.once.diamond=i.wins)}a.JCConst.once.PlayerInfo.gameDisconnect=!1,a.JCConst.once.PlayerInfo.gameName="JCFish",a.JCConst.once.TableId=e.change_scene_type%3||0,n.once.checkSelfTableIndex(),this.GameLayer.changeSceneBg(a.JCConst.once.TableId,!1,a.JCConst.once.TableId),this.GameLayer.clearTableFishs(),this.GameLayer.refreshTable(!1),this.GameLayer&&this.GameLayer.EffectLayer&&this.GameLayer.WeaponLayer.LastFireTime<-999998&&(this.GameLayer.WeaponLayer.LastFireTime=-91),this.sendChangeScene()},o.prototype.sendChangeScene=function(){p.default.once.send("changeScene",{})},o.prototype.CmdByStageChange=function(e){var t={now:a.JCConst.once.TableId,anim:!0,later:e.change_scene_type,skillId:a.JCEffectType.Fast};this.GameLayer.EffectLayer.addEffect(t),a.JCConst.once.TableId=e.change_scene_type,cc.log("CmdByStageChange:"+JSON.stringify(e))},o.prototype.ShotSelfBullet=function(e){this.GameLayer&&this.GameLayer.WeaponLayer&&(e.balance=parseInt(e.bet)*a.JCConst.once.RoomBet,e.uid=e.userid=a.JCConst.once.userId,a.JCConst.once.BulletCount++,this.GameLayer.WeaponLayer.LastFireTime=0,e.seatId=this.userConvertSeatId(e.userid),e.touch=this.decodePoint(e.position),this.GameLayer.WeaponLayer.showWeapon(e))},o.prototype.CmdBYShot=function(e){if(this.GameLayer&&this.GameLayer.WeaponLayer){if(e.balance=parseInt(e.bet)*a.JCConst.once.RoomBet,e.uid=e.userid,e.seatId=this.userConvertSeatId(e.userid),cc.log("CmdBYShot:"+e.seatId),e.userid==a.JCConst.once.userId)a.JCConst.once.Entries-=e.balance;else{if(e.fishId){var t=this.getFishByFishId(e.fishId);t instanceof r.default&&this.CmdBYLockFish(t,e.seatId)}else this.CmdBYUnlockFish(e.seatId);e.touch=this.decodePoint(e.position),this.GameLayer.WeaponLayer.showWeapon(e)}a.JCConst.once.users[e.seatId]&&(a.JCConst.once.users[e.seatId].score-=e.balance,this.GameLayer.updateBalance(e.userid,a.JCConst.once.users[e.seatId].score))}},o.prototype.CmdBYShotFish=function(e){var t=this.getAllFishByFishId(e.fishId),o=t[0],i=this.getTableByUID(e.userId);if(e.hitSocre*=a.JCConst.once.RoomBet,i&&o instanceof r.default){var s={fishId:e.fishId,userId:e.userId,seatId:i.seatId,award:e.hitSocre,bomb:e.bomb,fid:o.fid,ScoreEffect:o.config.ScoreEffect,position:o.node.position,wsp:o.node.convertToWorldSpaceAR(cc.v2(0,0)),SettleType:o.config.SettleType,point:o.node.convertToWorldSpaceAR(cc.v2(0,0)),bombId:e.bombId,fishType:o.config.fishType};27!=o.config.fishType&&28!=o.config.fishType||(s.ScoreEffect=15);for(var c=0;c<t.length;c++)t[c].goDie(),t[c].playDieAni();var h=parseInt(o.config.Skill);h==a.JCEffectType.BigBoom&&this.CmdJCBigBomb(s),h==a.JCEffectType.SmallBoom&&this.CmdJCSmallBomb(s),2==o.config.propFish&&this.CmdJCSameBomb(s),h==a.JCEffectType.Double&&this.CmdJCLord(s),-1!=[27,28,18,19,16,17,26,25].indexOf(o.config.fishType)&&-1!=[0,1,2,6,7].indexOf(e.butype)&&(-1==[26,25].indexOf(o.config.fishType)&&n.once.GameLayer.EffectLayer.addEffect({skillId:a.JCEffectType.CoinBoom,position:s.position}),n.once.GameLayer.EffectLayer.addEffect({seatId:s.seatId,award:s.award,skillId:a.JCEffectType.Bill})),this.addSFX(s),this.showCoin(s)}i&&a.JCConst.once.users[i.seatId]&&-1!=[0,1,2,6,7].indexOf(e.butype)&&(a.JCConst.once.users[i.seatId].score+=e.hitSocre,a.JCConst.once.Entries=a.JCConst.once.users[i.seatId].score,this.GameLayer.updateDiamond(i.userId,a.JCConst.once.users[i.seatId].score),this.GameLayer.updateBalance(i.userId,a.JCConst.once.users[i.seatId].score));var p=this.getBulletByBulletId(e.bombId);p instanceof l.default&&!p.isDrill&&this.GameLayer.despawnBullet(p)},o.prototype.createFish=function(e){var t=this.getFishConfig(e.fishType);if(e.fishes=e.fishes||[e.fishType],t){var o=h.default.generateMixed(20),i=e.fishPath%a.JCConst.once.FishPath.length,s=this.getFishPathByID(a.JCConst.once.FishPath[i].id),c=this.convertToGid(e.fishes.length),r=n.once.getFishPoints(t.FishID);t.fishType=e.fishType,t.propFish=e.propFish;for(var l=0;l<e.fishes.length;l++){var p={groupUuid:o,groupId:c,fid:e.fishes[l],fishId:e.fishId[0],config:t,index:l,skillId:"",FishPath:s,pathInterval:s.time,swimmingInterval:0,compensate:0,conlliderPoints:r};this.GameLayer.refreshFish(p)}}else cc.log("\u627e\u4e0d\u5230\u9c7c\u8be6\u60c5group.fishType---\x3e"+e.fishType)},o.prototype.convertToGid=function(e){for(var t=0;t<a.JCConst.once.FishGroups.length;t++){var o=a.JCConst.once.FishGroups[t];if(o.num==e)return o.id}return null},o.prototype.CmdBYLockFish=function(e,t){void 0===t&&(t=a.JCConst.once.seatId),e instanceof r.default&&e.pushLockSeat(t)&&(this.GameLayer.WeaponLayer.setLockFishByTid(t,e),t==a.JCConst.once.seatId&&this.playSFX("lock")),e instanceof r.default&&this.GameLayer.showUserLock(t,e.fid)},o.prototype.CmdBYUnlockFish=function(e){void 0===e&&(e=a.JCConst.once.seatId),this.GameLayer.WeaponLayer.setLockFishByTid(e),this.GameLayer.UnLockFishNtfType(e)},o.prototype.addSFX=function(e){if(e&&e.seatId===a.JCConst.once.seatId){var t="die_small";Math.floor(e.fid)>9&&(t="die"),Math.floor(e.fid)>19&&(t="die_big"),this.playSFX(t)}},o.prototype.getFishPathByID=function(e){for(var t=a.JCConst.once.FishPath,o=""+e||"1001",n=0;n<t.length;n++){var i=t[n];if(i.id===o){var s=i;return s.scale=1,s.points[0].x-s.points[s.points.length-1].x>0&&(s.scale=-1),s}}return null},o.prototype.getFishLayerIndex=function(e){var t=parseInt(e);return-1!=[0,1,2,3,4,5,6,7,10,11,12,13,14].indexOf(t)?0:-1!=[15,16,17,30].indexOf(t)?1:-1!=[8,9,18,19,25,30].indexOf(t)?2:0},o.prototype.getFishConfig=function(e){for(var t=0;t<a.JCConst.once.FishConfigs.length;t++)if(""+a.JCConst.once.FishConfigs[t].FishID==""+e)return h.default.deepCopy(a.JCConst.once.FishConfigs[t]);return null},o.prototype.getFishPoints=function(e){return a.JCConst.once.FishPoints[e]},o.prototype.getFishGroups=function(e){for(var t=0;t<a.JCConst.once.FishGroups.length;t++)if(""+a.JCConst.once.FishGroups[t].id==""+e)return a.JCConst.once.FishGroups[t];return null},o.prototype.getEffectByType=function(e){return a.JCConst.once.MapEffects.get(""+e)},o.prototype.getAtlasByType=function(e){return a.JCConst.once.MapAtlas.get(""+e)},o.prototype.getDeathAnimateByID=function(e){var t=a.JCConst.once.MapDieanis.get(""+e);if(!t)throw new Error("\u627e\u4e0d\u5230\u8be5\u9c7cID\u7684\u6b7b\u4ea1\u52a8\u753b");return t},o.prototype.getSwimAnimateByID=function(e){return a.JCConst.once.MapSwims.get(""+e)},o.prototype.initData=function(){cc.sys.isMobile?window.addEventListener("resize",this.onResized.bind(this)):cc.view.on("canvas-resize",this.onResized,this),this.onResized()},o.prototype.checkCompensate=function(e){var t=e.clientTime||Date.now(),o=void 0===e.seatId?a.JCConst.once.seatId:e.seatId,n=e.cToS?e.serverTime-t:t-e.serverTime,i=a.JCConst.once.MapCompensate.get(o);i||(i=e.cToS?n:-n,a.JCConst.once.MapCompensate.set(o,i));var s=e.cToS?n-i:n+i;return s<=0&&(i=e.cToS?i+s:i-s,a.JCConst.once.MapCompensate.set(o,i),s=0),s},o.prototype.convertPositionAngle=function(e){var t=cc.view.getVisibleSize(),o=t.width/2,n=t.height/2,i=e.x>o||e.x<-o,s=i?Math.abs(e.x)-o:0,a=e.y>n||e.y<-n?Math.abs(e.y)-n:0,c=i?360:180;return e.y>n&&(a=-a),e.x>o&&(s=-s),{out:s||a,x:s,y:a,jd:c,angle:c-e.angle}},o.prototype.calculateSpacePoint=function(e){var t=e.xySpeed,o=cc.view.getVisibleSize();if(void 0===e.xySpeed){var n=o.width*e.speed.x*e.space,i=o.height*e.speed.y*e.space;t=Math.sqrt(n*n+i*i)}var s=t*Math.sin(e.angle/180*Math.PI),a=t*Math.cos(e.angle/180*Math.PI);return cc.v2(s,a)},o.prototype.calculateNextBorderPoint=function(e){var t=cc.v2(e.point.x,e.point.y),o=cc.view.getVisibleSize(),n=Math.sin(e.angle/180*Math.PI),i=Math.cos(e.angle/180*Math.PI),s=n>0?o.width/2-t.x:-o.width/2-t.x,a=i>0?o.height/2-t.y:-o.height/2-t.y,c=e.speed.x*n,r=e.speed.y*i,l=Math.abs(s/c),h=Math.abs(a/r),p=Math.min(l,h);return t.x+=c*p,t.y+=r*p,{point:t,time:p}},o.prototype.inCircle=function(e,t,o){return cc.v2(e.x,e.y).sub(cc.v2(t.x,t.y)).mag()<=o},o.prototype.onResized=function(){a.JCConst.once.winScale=this.convertWindowScale()},o.prototype.checkSelfTableIndex=function(){for(var e in a.JCConst.once.users){var t=a.JCConst.once.users[e];t&&t.userId===a.JCConst.once.userId&&(a.JCConst.once.seatId=parseInt(t.seatId))}},o.prototype.getUser=function(e){void 0===e&&(e=404);var t=null;for(var o in 404==e&&(e=a.JCConst.once.seatId),a.JCConst.once.users){var n=a.JCConst.once.users[o];n&&n.seatId===e&&(t=n)}return t},o.prototype.flipWeaponY=function(e){return Math.max(a.JCConst.once.seatId,e)>1&&Math.min(a.JCConst.once.seatId,e)<=1},o.prototype.userConvertIndex=function(e){return this.tableConvertIndex(this.userConvertSeatId(e))},o.prototype.userConvertSeatId=function(e){var t=this.getTableByUID(e);return t?t.seatId:-1},o.prototype.tableConvertIndex=function(e){void 0===e&&(e=-1);var t=e>-1?e:a.JCConst.once.seatId;return a.JCConst.once.seatId>1&&(t=t>1?t-2:t+2),t},o.prototype.getTableByUID=function(e,t){var o=e||a.JCConst.once.userId;for(var n in a.JCConst.once.users){var i=a.JCConst.once.users[n];if(i&&""+i.userId==""+o)return t instanceof Function&&t(i),i}},o.prototype.showCoin=function(e){var t=h.default.deepCopy(e);t.self=e.seatId===a.JCConst.once.seatId,t.index=this.tableConvertIndex(e.seatId);var o=Math.floor(e.ScoreEffect);if(parseFloat(e.award)>0&&o>0){for(var n=0;n<o;n++){var i=h.default.deepCopy(t);i.i=n,this.GameLayer.addCoin(i)}this.showCoinLbAction(t)}},o.prototype.showCoinLbAction=function(e){var t=this;if(e.award&&parseFloat(e.award)>0){var o=this.GameLayer.addCoinLb(e);if(o instanceof cc.Node){o.opacity=0;var n=cc.spawn(cc.moveTo(.5,cc.v2(o.x,o.y+50)),cc.fadeIn(.3)),i=cc.spawn(cc.moveTo(1,cc.v2(o.x,o.y+100)).easing(cc.easeIn(3)),cc.fadeOut(1));o.runAction(cc.sequence(n,i,cc.callFunc(function(){t.GameLayer.despawnCoinLb(o)})))}}},o.prototype.checkLimitBorder=function(e){var t=cc.view.getVisibleSize(),o=e.x>=-t.width/2&&e.x<=t.width/2,n=e.y>=-t.height/2&&e.y<=t.height/2;return o&&n},o.prototype.inCircleFishs=function(e,t){void 0===t&&(t=100);for(var o=[],n=this.GameLayer.getFishs(),i=[],s=0;s<n.length;s++){var a=n[s],c=a.node.convertToNodeSpaceAR(cc.v2(e.x,e.y));if(a.alive)for(var r=0;r<a.colliders.length;r++){var l=a.colliders[r];if(this.inCircle(l,c,t)){if(a.beAttack(),!a.fishId){cc.log("f.fishId;;;;;");break}i.push(a),o.push(a.fishId);break}}}return{fishId:o,fish:i}},o.prototype.getMaxFish=function(){for(var e=this.GameLayer.getFishs(),t=null,o=e.length-1;o>=0;o--){var n=e[o],i=this.checkLimitBorder(n.node);if(n.alive&&i)if(t instanceof r.default){var s=parseFloat(n.config.Type),a=parseFloat(t.config.Type);4===s&&(s=6),4===a&&(a=6),s>a&&(t=n)}else t=n}return t},o.prototype.setLimitFire=function(e,t){void 0===e&&(e=0),void 0===t&&(t=!1),this.GameLayer.WeaponLayer.setTimelimit(e),t&&a.JCConst.once.IsAuto&&this.GameLayer.MenuLayer.onClickedAuto(!1)},o.prototype.onTouchWindow=function(e,t){if(this.GameLayer.WeaponLayer.timeLimit){this.GameLayer.WeaponLayer.setClickLimit(!1);var o=this.GameLayer.WeaponLayer.balanceLimit;this.setLimitFire(a.JCConst.once.FightLimit,!o),this.requestFishFire(e,t)}},o.prototype.showLockLineByTid=function(e,t){for(var o=0;o<t.length;o++){var n=t[o];this.GameLayer.WeaponLayer.showLockLineByTid(n,e)}},o.prototype.getFishByFishId=function(e){for(var t=this.GameLayer.getFishs(),o=0;o<t.length;o++){var n=t[o];if(e===n.fishId)return n}return null},o.prototype.getAllFishByFishId=function(e){for(var t=[],o=this.GameLayer.getFishs(),n=0;n<o.length;n++){var i=o[n];e===i.fishId&&t.push(i)}return t},o.prototype.getBulletByBulletId=function(e){for(var t=this.GameLayer.getBullets(),o=0;o<t.length;o++){var n=t[o];if(e===n.bulletId)return n}return null},o.prototype.removeEvents=function(){cc.sys.isMobile?window.removeEventListener("resize",this.onResized.bind(this)):cc.view.off("canvas-resize",this.onResized,this),this.unscheduleAllCallbacks()},o.prototype.getFrameByName=function(e){var t=null;return a.JCConst.once.MapAtlas.forEach(function(o){var n=o.getSpriteFrame(e);n&&(t=n)}),t},o.prototype.cheekVectorOrTimeIndex=function(e,t,o){for(var n=0,i=[],s=1;s<e.length;s++){var a=100;if(!o){var c=e[s-1],r=e[s];a=Math.pow(r.x-c.x,2)+Math.pow(r.y-c.y,2),a=Math.sqrt(a)}i.push(a),n+=a}var l=0,h=0;for(s=0;s<i.length;s++){h=s+1;var p=n*t,d=l+(a=i[s]);if(l<p&&p<=d)return{index:h,f:1-(d-p)/a};l=d}return null},o.prototype.makeBreakBezier2=function(e,t,o){if(t&&t.length){if(e<=0)return t[0];if(e>=1)return t[t.length-1];for(var n=0,i=this.cheekVectorOrTimeIndex(t,e,!0),s=[t[i.index-1],o[i.index-1],t[i.index]];n<1e3;){n++;for(var a=s.length-1,c=0;c<a;c++)if(s[c]=this.convertVectorToPoint(s[c],s[c+1],i.f),c===a-1&&(s.splice(a,s.length),1===s.length))return s[0]}}},o.prototype.convertVectorToPoint=function(e,t,o){return cc.v2(e.x+-(e.x-t.x)*o,e.y+-(e.y-t.y)*o)},o.prototype.convertPointToAngle=function(e,t){var o=0,n=e.y-t.y,i=e.x-t.x;return 0===i?o=n>0?-90:90:(i<0&&n>0&&(o=180-180*Math.atan(n/i)/Math.PI),i<0&&n<0&&(o=180-180*Math.atan(n/i)/Math.PI),i>0&&n>0&&(o=270+180*Math.atan(i/n)/Math.PI),i>0&&n<0&&(o=90+180*Math.atan(i/n)/Math.PI)),o},o.prototype.convertWindowsizePath=function(e){for(var t=e,o=this.convertWindowScale(),n=0;n<t.length;n++){for(var i=0;i<t[n].points.length;i++)t[n].points[i].x*=o.x,t[n].points[i].y*=o.y;for(i=0;i<t[n].controls.length;i++)t[n].controls[i].x*=o.x,t[n].controls[i].y*=o.y}return t},o.prototype.convertWindowScale=function(){var e=cc.view.getVisibleSize(),t=e.width/1334,o=e.height/750;return cc.v2(t,o)},o.prototype.addBill=function(e){if(e&&this.GameLayer&&this.GameLayer.EffectLayer&&cc.isValid(this.GameLayer.node)&&Math.floor(e.SettleType)>=0){var t=(""+e.SettleType).split(""),o=e.seatId===a.JCConst.once.seatId,n=e.award;-1!==["1","0"].indexOf(t[0])&&-1!==["1","0"].indexOf(t[1])&&(t=o?[1]:[0]);for(var i=Math.floor(e.fid),s=0;s<t.length;s++){var c=Math.floor(t[s]),r=c;this.GameLayer.EffectLayer.addEffect({seatId:e.seatId,skillId:a.JCEffectType.Bill,type:c,fid:i,award:n,limit:r,number:e.number})}}},o.prototype.codePoint=function(e){return e||(e=cc.v2(0,0)),{x:1*e.x/a.JCConst.once.winScale.x,y:1*e.y/a.JCConst.once.winScale.y}},o.prototype.decodePoint=function(e){return e||(e=cc.v2(0,0)),{x:1*e.x*a.JCConst.once.winScale.x,y:1*e.y*a.JCConst.once.winScale.y}},o.prototype.playBGM=function(t,o){void 0===o&&(o=!0),0!=e("PlayerInfo").getInstant.musicControl&&(t=t||this.MusicDic[404],o&&(this.MusicDic[404]=t),this.play(t,!0,!0))},o.prototype.stopBGM=function(){cc.audioEngine.stopAll()},o.prototype.playSFX=function(t){0!=e("PlayerInfo").getInstant.soundEffectControl&&this.play(t,!1,!1)},o.prototype.stopSFX=function(e){this.MusicDic[e]&&cc.audioEngine.stop(this.MusicDic[e])},o.prototype.play=function(e,t,o){void 0===o&&(o=!1);var n=this.GameLayer.LoadingLayer[e];n&&(this.MusicDic[e]=o?cc.audioEngine.playMusic(n,t):cc.audioEngine.playEffect(n,t))},s([u(c.default)],o.prototype,"GameLayer",void 0),n=s([f],o)}(cc.Component);o.default=y,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./JCBullet":"JCBullet","./JCConst":"JCConst","./JCFish":"JCFish","./JCNetWork":"JCNetWork","./JCScene":"JCScene",PlayerInfo:void 0}],JCMenu:[function(e,t,o){"use strict";cc._RF.push(t,"54974Mgb01MYYT4MgD8nDMz","JCMenu");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./JCConst"),c=e("./JCManager"),r=e("./JCNetWork"),l=cc._decorator,h=l.ccclass,p=l.property,d=function(t){function o(){var e=null!==t&&t.apply(this,arguments)||this;return e.LayerNetError=null,e.LayerRule=null,e.sp_setup=null,e._mune=!1,e}return i(o,t),o.prototype.onLoad=function(){this._index=0,this.node.width=cc.winSize.width>1334?1334:cc.winSize.width,this.btn_auto=this.node.getChildByName("btn_auto"),this.btn_lock=this.node.getChildByName("btn_lock"),this.btn_jiasu=this.node.getChildByName("btn_jiasu"),this.btn_auto.on("click",this.onClickedAuto,this),this.btn_lock.on("click",this.onClickedLock,this),this.btn_jiasu.on("click",this.onClickedJiasu,this),this.node.getChildByName("btn_bill").on("click",this.onClickedBill,this),this.layer_mune=this.node.getChildByName("layer_mune"),cc.find("layer_mune/btn_back",this.node).on("click",this.onClickedBack,this),cc.find("layer_mune/btn_setup",this.node).on("click",this.onClickedSetup,this),cc.find("layer_mune/btn_rule",this.node).on("click",this.onClickedRule,this),this.btn_show=cc.find("layer_mune/btn_show/sp",this.node).getComponent(cc.Sprite),this.btn_show.node.parent.on("click",this.onClickedShow,this),cc.game.on(cc.game.EVENT_HIDE,this.onHide,this)},o.prototype.onHide=function(){console.log("\u6e38\u620f\u8fdb\u5165\u540e\u53f0"),a.JCConst.once.IsAuto&&this.onClickedAuto()},o.prototype.onResized=function(){},o.prototype.onclickedLeave=function(){r.default.once.levea()},o.prototype.onClickedSetup=function(){c.default.once.playSFX("click");var t="volume"==this.sp_setup.spriteFrame.name,o=t?"mute":"volume",n=t?0:1;n?cc.audioEngine.resumeAll():cc.audioEngine.pauseAll(),this.sp_setup.spriteFrame=a.JCConst.once.UIAtals.getSpriteFrame(o),e("PlayerInfo").getInstant.soundEffectControl=n},o.prototype.onClickedRule=function(){this.LayerRule.active=!this.LayerRule.active},o.prototype.onClickedShow=function(){c.default.once.playSFX("click"),this._mune=!this._mune,this.btn_show.spriteFrame=c.default.once.getFrameByName(this._mune?"spread":"fold");for(var e=[],t=0;t<3;t++)e[t]=cc.find("layer_mune/"+["btn_back","btn_setup","btn_rule"][t],this.node),e[t].stopAllActions(),e[t].active=this._mune,e[t].opacity=0,e[t].scale=1;if(this._mune)for(t=0;t<e.length;t++)e[t].runAction(cc.sequence(cc.delayTime(.1*t),cc.spawn(cc.sequence(cc.scaleTo(.05,1.2),cc.scaleTo(.05,1)),cc.fadeIn(.1))))},o.prototype.onClickedBack=function(){c.default.once.playSFX("click"),c.default.once.requestLeaveRoom()},o.prototype.onClickedBill=function(){c.default.once.GameLayer.EffectLayer.addEffect({seatId:a.JCConst.once.seatId,award:100,skillId:a.JCEffectType.Bill})},o.prototype.onClickCloseRule=function(){c.default.once.playSFX("click"),this.LayerRule.active=!1},o.prototype.onClickedAuto=function(e){void 0===e&&(e=!0),e&&c.default.once.playSFX("click"),a.JCConst.once.IsAuto=!a.JCConst.once.IsAuto,this.btn_auto.children[1].active=a.JCConst.once.IsAuto},o.prototype.onClickedJiasu=function(e){void 0===e&&(e=!0),e&&c.default.once.playSFX("click"),a.JCConst.once.AutoLimit==a.JCFireSpeed.Speed0?(a.JCConst.once.AutoLimit=a.JCFireSpeed.Speed1,a.JCConst.once.FightLimit=a.JCFireSpeed.Speed1):(a.JCConst.once.AutoLimit=a.JCFireSpeed.Speed0,a.JCConst.once.FightLimit=a.JCFireSpeed.Speed0),this.btn_jiasu.children[1].active=a.JCConst.once.AutoLimit==a.JCFireSpeed.Speed1},o.prototype.onClickedLock=function(){c.default.once.playSFX("click"),a.JCConst.once.IsLock=!a.JCConst.once.IsLock,this.btn_lock.children[1].active=a.JCConst.once.IsLock,a.JCConst.once.IsLock||c.default.once.CmdBYUnlockFish()},o.prototype.onDestroy=function(){cc.game.off(cc.game.EVENT_HIDE,this.onHide,this)},s([p(cc.Node)],o.prototype,"LayerNetError",void 0),s([p(cc.Node)],o.prototype,"LayerRule",void 0),s([p(cc.Sprite)],o.prototype,"sp_setup",void 0),s([h],o)}(cc.Component);o.default=d,cc._RF.pop()},{"./JCConst":"JCConst","./JCManager":"JCManager","./JCNetWork":"JCNetWork",PlayerInfo:void 0}],JCNetWork:[function(e,t,o){"use strict";cc._RF.push(t,"b1f0fkQy/xO9rv++2CZUqGY","JCNetWork");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./JCConst"),c=e("./JCManager"),r=cc._decorator,l=r.ccclass,h=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return i(t,e),o=t,t.prototype.onLoad=function(){o.once=this,a.JCConst.once.RoomBet=a.JCConst.once.PlayerInfo.RoomBet,console.log("Game2222Config.SubGameMgr",GameConfig.SubGameMgr),GameConfig.SubGameMgr.subGameNet=this,this.send("loginGame",{})},t.prototype.addNetEvent=function(e,t){var o=null;if("loginGameResult"==e){var n=window.changeResultJSON_Function(t);console.log("\u6e38\u620f\u767b\u9646\u6210\u529f======================="+JSON.stringify(n)),n.resultid?(a.JCConst.once.RoomBet=n.Obj.bet,a.JCConst.once.PlayerInfo.win_pool=n.Obj.winPool,a.JCConst.once.PlayerInfo.playerDiamond=n.Obj.wins,a.JCConst.once.PlayerInfo.playerId=n.Obj.id,a.JCConst.once.Entries=n.Obj.score,this.send("LoginRoom",{roomid:1})):this.requestLeaveRoom()}if("LoginRoomResult"==e&&(o=window.changeResultJSON_Function(t),cc.log("LoginRoomResult",o),o.ResultCode)){cc.log("LoginRoomResult------------------\x3e"+JSON.stringify(o)),a.JCConst.once.BLevels=o.ResultData.betList,c.default.once.CmdBYTable(o);for(var i=o.ResultData.userList,s=0;s<i.length;s++)c.default.once.CmdBYCannonChange(i[s])}"HitResult"==e&&(o=window.changeResultJSON_Function(t),cc.log("LoginRoomResult",o),1==o.ResultCode&&c.default.once.CmdBYShotFish(o.ResultData)),"FishOut"==e&&(o=window.changeResultJSON_Function(t),c.default.once.createFish(o)),"fishShoot"==e&&(o=window.changeResultJSON_Function(t),cc.log("fishShoot",o),c.default.once.CmdBYShot(o)),"doubleEnd"==e&&(o=window.changeResultJSON_Function(t),c.default.once.CmdJCLordSettle(o)),"playEnter"==e&&(o=window.changeResultJSON_Function(t)).ResultCode&&(cc.log("playEnter:"+JSON.stringify(o)),c.default.once.CmdBYFishSeatChange(o.ResultData.seatId,o.ResultData)),"PlayerOut"==e&&(o=window.changeResultJSON_Function(t)).ResultCode&&(cc.log("PlayerOut:"+JSON.stringify(o)),c.default.once.CmdBYFishSeatChange(o.PlayerSeatId,null)),"changePowerResult"==e&&(o=window.changeResultJSON_Function(t),cc.log("changePowerResult:"+JSON.stringify(o)),c.default.once.CmdBYCannonChange(o)),"fishHit_boardResult"==e&&(o=window.changeResultJSON_Function(t),cc.log("fishHit_boardResult:"+JSON.stringify(o)),o.uid==a.JCConst.once.PlayerInfo.playerId&&this.send("fishHit",o)),"fishSceneChange"==e&&(o=window.changeResultJSON_Function(t),cc.log("fishSceneChange:"+JSON.stringify(o)),o&&(o.change_scene_type%=3,c.default.once.CmdByStageChange(o))),"disconnect"==e&&this.requestLeaveRoom()},t.prototype.start=function(){},t.prototype.send=function(e,t){void 0===t&&(t={}),window.sendNetWorkData&&("heart_beat"!=e&&console.log("send cmd:"+e+",data:",t),window.sendNetWorkData(e,JSON.stringify(t)))},t.prototype.requestLeaveRoom=function(){Common.backHall("Are you sure you want to leave the game?",function(){})},t.prototype.levea=function(){Common.backHall("Are you sure you want to leave the game?",function(){})},t.prototype.closeSocket=function(){},t.prototype.changeResultJSON_Function=function(e){return cc.sys.isNative?JSON.parse(e):e},t.prototype.onDestroy=function(){o.once=null},o=s([l],t)}(cc.Component));o.default=h,cc._RF.pop()},{"./JCConst":"JCConst","./JCManager":"JCManager"}],JCScene:[function(e,t,o){"use strict";cc._RF.push(t,"a548aH8pn9MXYnh+GXS2pqf","JCScene");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./JCConst"),c=e("./JCManager"),r=e("./JCEffect"),l=e("./JCMenu"),h=e("./JCCoin"),p=e("./JCBullet"),d=e("./JCFish"),f=e("./JCFishNet"),u=e("./JCWeapon"),y=e("./JCEffectLayer"),C=e("./JCBill"),g=e("./JCUser"),v=e("./JCLoading"),m=e("../../../Script/utils/Utils"),_=e("./JCNetWork"),J=cc._decorator,b=J.ccclass,I=J.property,F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LoadingLayer=null,t.MenuLayer=null,t.WeaponLayer=null,t.EffectLayer=null,t.RechargeLayer=null,t.Fonts=[],t.FishParent=null,t.BulletParent=null,t.GoldParent=null,t.GoldLabelParent=null,t.NetParent=null,t.EffectSKParent=null,t.EffectParent=null,t.arr_fishs=[],t.arr_bullets=[],t.arr_effect=[],t.arr_coin=[],t.arr_seats=[],t}return i(t,e),t.prototype.changeGold=function(e){return(parseFloat(e)/a.JCConst.once.PlayerInfo.exchangeRate).toFixed(2)},t.prototype.onLoad=function(){this.LoadingLayer.loadFinish(),c.default.once.GameLayer=this,this.initView(),this.EffectLayer.defaultLight(this.node),c.default.once.initData(),this.loadFinish()},t.prototype.loadFinish=function(){this.initData();for(var e=0;e<this.arr_seats.length;e++)this.arr_seats[e].initUI(),this.arr_seats[e].cleanInfo();this.WeaponLayer.init()},t.prototype.initData=function(){this.arr_fishs=[],this.arr_bullets=[],this.arr_effect=[],this.arr_coin=[];var e=cc.find("layer_load/pr_net",this.node);e.addComponent(f.default);var t=cc.find("layer_load/pr_fish",this.node);t.addComponent(d.default);var o=cc.find("layer_load/pr_bullet",this.node);o.addComponent(p.default);var n=cc.find("layer_load/pr_effect",this.node);n.addComponent(r.default);var i=cc.find("layer_load/pr_coin",this.node);i.addComponent(h.default);var s=cc.find("layer_load/lb_coin",this.node),a=cc.find("layer_load/pr_bill",this.node);a.addComponent(C.default),this.pool_fish=this.createPool(400,t),this.pool_bullet=this.createPool(300,o),this.pool_net=this.createPool(130,e),this.pool_coin=this.createPool(400,i),this.pool_effect=this.createPool(50,n),this.pool_bill=this.createPool(20,a),this.pool_coinlb=this.createPool(200,s)},t.prototype.createPool=function(e,t){var o=new cc.NodePool;o.prefab=t;for(var n=0;n<e;n++)o.put(cc.instantiate(t));return o},t.prototype.getNodeByPool=function(e){var t=e.get();return t||(t=cc.instantiate(e.prefab)),t},t.prototype.clearLockFishAllBullet=function(e){for(var t=this.getBullets(),o=0;o<t.length;o++){var n=t[o];n.lockFishId===e&&n.clearLockID()}},t.prototype.initView=function(){var e=this.node.getChildByName("layer_users2").children;this.arr_seats=[];for(var t=0;t<4;t++){var o=e[t].getComponent(g.default);this.arr_seats.push(o)}for(this.layer_bgs=this.node.getChildByName("layer_bgs"),t=0;t<5;t++){var n=this.RechargeLayer.getChildByName("btn_"+t);m.default.addClickEvent(n,this,m.default.getComponentName(this),"onClickedRecharge",t)}},t.prototype.getFishs=function(){return this.arr_fishs||[]},t.prototype.getBullets=function(){return this.arr_bullets||[]},t.prototype.changeSceneBg=function(e,t,o){void 0===e&&(e=0);var n="bg"+o%3;if(c.default.once.playBGM(n),e!=o){for(var i=this.layer_bgs.children,s=0;s<i.length;s++){var a=i[s],r=a.name==="layer_"+e&&t,l=a.name==="layer_"+o;a.active=r||l,a.active&&(a.setPosition(0,0),a.opacity=255,a.zIndex=l?0:1)}if(t){c.default.once.playSFX("effect_108");var h=this.layer_bgs.getChildByName("layer_"+e);h.stopAllActions();var p=h.getChildByName("bg");p.stopAllActions(),h.runAction(cc.moveTo(2,cc.v2(-1630,0))),p.runAction(cc.sequence(cc.moveTo(2,cc.v2(1630,0)),cc.callFunc(function(){p.setPosition(0,0),h.active=""+e==""+o})))}}},t.prototype.updateBalance=function(e,t){var o=c.default.once.getTableByUID(e);if(o){var n=this.getUserByTable(o.seatId);n&&n.updateBalance(t)}},t.prototype.updateDiamond=function(e,t){var o=c.default.once.getTableByUID(e);if(o){var n=this.getUserByTable(o.seatId);n&&n.updateDiamond(t)}},t.prototype.getUserByTable=function(e){for(var t=null,o=0;o<this.arr_seats.length;o++)this.arr_seats[o]._seatId===e&&(t=this.arr_seats[o]);return t},t.prototype.refreshTable=function(e){void 0===e&&(e=null);var t=[0,1,2,3];for(var o in a.JCConst.once.users){var n=a.JCConst.once.users[o];if(n){var i=parseInt(n.seatId);if(t.splice(t.indexOf(i),1),e&&n.userId!==e.userId)continue;var s=c.default.once.tableConvertIndex(i),r=c.default.once.userConvertIndex(a.JCConst.once.userId);cc.log("index======>"+s+"---selfIndex--\x3e"+r+"--u------\x3e"+JSON.stringify(n)),this.WeaponLayer.setConvertWeaponActive(n.userId,!0,null!=e),null!=e&&this.WeaponLayer.setLevelByUID(n.userId,0),this.arr_seats[s].refreshUserInfo(n),this.arr_seats[s].node.active=!0,n.userId==a.JCConst.once.userId?this.WeaponLayer.setWeaponGold(n.userId,a.JCConst.once.BLevels[a.JCConst.once.BLevel]):this.WeaponLayer.setWeaponGold(n.userId,n.bet)}}for(var l=0;l<t.length;l++)s=c.default.once.tableConvertIndex(t[l]),cc.log("cleanInfoByTid------\x3e"+s),this.arr_seats[s].cleanInfo(),this.WeaponLayer.cleanInfoByTid(t[l])},t.prototype.showUserLock=function(e,t){var o=c.default.once.tableConvertIndex(e),n=this.arr_seats[o];n&&n.showLockFish(t)},t.prototype.UnLockFishNtfType=function(e){var t=c.default.once.tableConvertIndex(e),o=this.arr_seats[t];o&&o.unLock()},t.prototype.updateFish=function(){var e=a.JCConst.once.FishConfigs[m.default.randomNum(0,a.JCConst.once.FishConfigs.length)].FishID,t=a.JCConst.once.FishGroups[7],o=t.id,n=a.JCConst.once.FishPath[0],i=c.default.once.getFishConfig(e),s=c.default.once.getFishPathByID(n.id),r=c.default.once.getFishPoints(e);r=m.default.deepCopy(r);for(var l=0;l<t.num;l++)this.refreshFish({config:i,FishPath:s,fid:e,groupId:o,index:l,compensate:0,swimmingInterval:0,pathInterval:n.time,conlliderPoints:r})},t.prototype.refreshFish=function(e){var t=e,o="layer_"+c.default.once.getFishLayerIndex(t.fid);if(this.pool_fish.size()<5&&cc.log("\u9c7c\u82d7\u62a5\u8b66"),t.config&&o)if(t.groups=c.default.once.getFishGroups(t.groupId),t.groups){if(!(t.groups&&t.groups.origin&&t.groups.points&&t.groups.points[t.index])){var n="!groups";return t.groups.origin||(n="!groups.origin"),t.groups.points||(n="!groups.points"),t.groups.points[t.index]||(n="!groups.points[param.index]"),void cc.log("\u627e\u4e0d\u5230\u9c7c\u7ec4\u914d\u7f6e\u4fe1\u606f ID\uff1a"+t.groupId+"  \u7f3a\u5931\u4fe1\u606f\uff1a"+n+"  param.index:"+t.index)}if(t.FishPath)if(t.swimAni=c.default.once.getSwimAnimateByID(t.fid),t.swimAni){var i=this.getNodeByPool(this.pool_fish),s=i.getComponent(d.default);this.arr_fishs.push(s),i.parent=this.FishParent.getChildByName(o),s.init(t)}else cc.log("\u627e\u4e0d\u5230\u9c7c\u7684\u52a8\u753bID\uff1a"+t.fid);else cc.log("\u627e\u4e0d\u5230\u9c7c\u7684\u8def\u5f84ID\uff1a"+t.pid)}else cc.log("\u627e\u4e0d\u5230\u9c7c\u7ec4\u914d\u7f6e\u4fe1\u606f ID\uff1a"+t.groupId);else cc.log("fishError\u627e\u4e0d\u5230\u9c7c\u7684\u4fe1\u606f ID\uff1a"+t.fid+"  "+!o)},t.prototype.getLockFishByFishId=function(e){for(var t=0;t<this.WeaponLayer.arr_locks.length;t++){var o=this.WeaponLayer.arr_locks[t];if(e===o.fishId)return o}return null},t.prototype.addNet=function(e,t,o,n){var i=this.getNodeByPool(this.pool_net),s=i.getComponent(f.default);i.zIndex=5e3,this.NetParent.addChild(i),s.init(e,t,o,n)},t.prototype.addEffect=function(e){if(cc.isValid(this.node)){var t=this.getNodeByPool(this.pool_effect),o=t.getComponent(r.default);this.EffectParent.addChild(t),e.parent=this.EffectSKParent,o.init(e),this.arr_effect.push(o)}},t.prototype.getEffectBySkillId=function(e,t){void 0===t&&(t=!0);for(var o=[],n=0;n<this.arr_effect.length;n++){var i=this.arr_effect[n];if(i.param&&i.param.skillId===e){if(!t)return i;o.push(i)}}return t?o:null},t.prototype.addBullet=function(e){var t=e;t.angle=t.angle||this.WeaponLayer.getWeaponRotationByTid(t.seatId);var o=this.WeaponLayer.getWeaponOutPositionByTid(t.seatId),n=this.getNodeByPool(this.pool_bullet),i=n.getComponent(p.default);n.zIndex=2e3,this.arr_bullets.push(i),t.point=t.point||this.BulletParent.convertToNodeSpaceAR(o),this.BulletParent.addChild(n),t.isDrill&&(t.lock=null),i.init(t)},t.prototype.showRecharge=function(){Common.showMessage("not enough balance")},t.prototype.onClickedRecharge=function(e,t){cc.log("onClickedRecharge----\x3e"+t),4==parseInt(t)?c.default.once.requestRechargeAll():c.default.once.requestRechargeSum([1,10,50,100][parseInt(t)])},t.prototype.addBill=function(e){var t=this.getNodeByPool(this.pool_bill);t.parent=this.EffectParent,t.position=e.position?this.EffectParent.convertToNodeSpaceAR(e.position):cc.v2(0,0),t.getComponent(C.default).show(e)},t.prototype.addCoin=function(e){var t=this.getNodeByPool(this.pool_coin);t.parent=e.parent||this.GoldParent,t.zIndex=1e4;var o=e,n=this.arr_seats[o.index];if(n){var i=n.getUserWorldPoint(),s=t.getComponent(h.default);o.to=i,s.init(o),this.arr_coin.push(s)}},t.prototype.addCoinLb=function(e){e||(e={});var t=this.getNodeByPool(this.pool_coinlb);if(t.parent=this.GoldLabelParent,e.position)t.position=e.position;else{var o=c.default.once.tableConvertIndex(e.seatId),n=this.arr_seats[o].getUserWorldPoint();t.position=t.parent.convertToNodeSpaceAR(n)}t.active=!0,t.zIndex=10001;var i=t.getComponent("JCLabel");return i.defaultNames="score_",i.spriteAtlas=a.JCConst.once.UIAtals,i.string=""+c.default.once.GameLayer.changeGold(e.award),t},t.prototype.despawnBill=function(e){e.node&&this.pool_bill.put(e.node)},t.prototype.despawnBullet=function(e){e.seatId===a.JCConst.once.seatId&&a.JCConst.once.BulletCount--,e.setLockFishID(-1),e.node&&this.pool_bullet.put(e.node);var t=this.arr_bullets.indexOf(e);this.arr_bullets.splice(t,1)},t.prototype.despawnEffect=function(e){e.clean();var t=this.arr_effect.indexOf(e);this.arr_effect.splice(t,1),this.pool_effect.put(e.node)},t.prototype.despawnCoin=function(e){e.node instanceof cc.Node&&(this.pool_coin.put(e.node),e.clean()),e instanceof cc.Node&&this.pool_coin.put(e);var t=this.arr_coin.indexOf(e);this.arr_coin.splice(t,1)},t.prototype.despawnCoinLb=function(e){e.node instanceof cc.Node&&(this.pool_coinlb.put(e.node),e.clean()),e instanceof cc.Node&&this.pool_coinlb.put(e)},t.prototype.clearTableFishs=function(){for(var e=this.FishParent.childrenCount-1;e>=0;e--){var t=this.FishParent.children[e].getComponent(d.default);t&&this.despawnFish(t)}},t.prototype.despawnFish=function(e){e.node&&e instanceof d.default&&(e.node.active=!1,this.pool_fish.put(e.node));var t=this.arr_fishs.indexOf(e);-1!==t&&this.arr_fishs.splice(t,1)},t.prototype.despawnNet=function(e){e.node&&this.pool_net.put(e.node)},t.prototype.update=function(e){if(cc.isValid(this.node)){(a.JCConst.once.HeartBeatCD-=e)<0&&(a.JCConst.once.HeartBeatCD=5,c.default.once.heartBeat());for(var t=[],o=0;o<this.arr_fishs.length;o++){var n=this.arr_fishs[o];if(n.updatexxx(e),n&&n.alive){var i=n.node.convertToWorldSpaceAR(cc.v2(0,0));t.push({fish:n,fwsp:i})}}for(var s=[],r=0;r<this.arr_bullets.length;r++){var l=this.arr_bullets[r];l.updatexxx(e);var h=l.node.convertToWorldSpaceAR(cc.v2(0,0)),p=cc.v2(h.x,h.y-50),d=cc.v2(h.x-20,h.y),f=cc.v2(h.x+20,h.y);s.push({bullet:l,bwsp:h,bwspDown:p,bwspLeft:d,bwspRight:f})}for(r=0;r<s.length;r++){var u=s[r];for(o=0;o<t.length;o++){var y=t[o],C=u.bwsp.sub(y.fwsp).mag();if(y.fish.radius>C){var g=y.fish.getColliderPoints().ws;(C<50||y.fish==u.bullet.lockFish||m.default.rayCasting(u.bwsp,g)||m.default.rayCasting(u.bwspDown,g)||m.default.rayCasting(u.bwspLeft,g)||m.default.rayCasting(u.bwspRight,g))&&u.bullet.onCollision(y.fish)}}}s=null,t=null}},t.prototype.onDestroy=function(){a.JCConst.destroyInstance(),c.default.destroyInstance(),_.default.once=null,GameConfig.SubGameMgr.subGameNet=null},s([I(v.default)],t.prototype,"LoadingLayer",void 0),s([I(l.default)],t.prototype,"MenuLayer",void 0),s([I(u.default)],t.prototype,"WeaponLayer",void 0),s([I(y.default)],t.prototype,"EffectLayer",void 0),s([I(cc.Node)],t.prototype,"RechargeLayer",void 0),s([I([cc.Font])],t.prototype,"Fonts",void 0),s([I(cc.Node)],t.prototype,"FishParent",void 0),s([I(cc.Node)],t.prototype,"BulletParent",void 0),s([I(cc.Node)],t.prototype,"GoldParent",void 0),s([I(cc.Node)],t.prototype,"GoldLabelParent",void 0),s([I(cc.Node)],t.prototype,"NetParent",void 0),s([I(cc.Node)],t.prototype,"EffectSKParent",void 0),s([I(cc.Node)],t.prototype,"EffectParent",void 0),s([b],t)}(cc.Component);o.default=F,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./JCBill":"JCBill","./JCBullet":"JCBullet","./JCCoin":"JCCoin","./JCConst":"JCConst","./JCEffect":"JCEffect","./JCEffectLayer":"JCEffectLayer","./JCFish":"JCFish","./JCFishNet":"JCFishNet","./JCLoading":"JCLoading","./JCManager":"JCManager","./JCMenu":"JCMenu","./JCNetWork":"JCNetWork","./JCUser":"JCUser","./JCWeapon":"JCWeapon"}],JCUser:[function(e,t,o){"use strict";cc._RF.push(t,"a5c2ayU/QJLvpFcBTMJhS9J","JCUser");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./JCConst"),c=e("./JCManager"),r=cc._decorator,l=r.ccclass,h=r.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._seatId=-1,t.lb_total=null,t.lb_gold=null,t}return i(t,e),t.prototype.initUI=function(){this.unLock(),this.node.getChildByName("btn_add").on("click",this.onClickedAdd,this)},t.prototype.onClickedAdd=function(){this._seatId==a.JCConst.once.seatId&&(c.default.once.GameLayer.showRecharge(!1),c.default.once.playSFX("click"))},t.prototype.refreshUserInfo=function(e){if(cc.log("uinfo----\x3e"+JSON.stringify(e)),e){this._seatId=e.seatId,this.updateBalance(e.score),this.updateDiamond(e.wins),this.node.active=!0,this.lb_gold.node.parent.active=!0;var t=c.default.once.tableConvertIndex(this._seatId);this.node.x=.19*cc.view.getVisibleSize().width,this.node.x=t%2?this.node.x+297:-this.node.x-297}},t.prototype.updateBalance=function(e){e=e||0,this.lb_gold.string=c.default.once.GameLayer.changeGold(e)},t.prototype.updateDiamond=function(e){e=e||0,this.lb_total.string=c.default.once.GameLayer.changeGold(e)},t.prototype.showLockFish=function(){},t.prototype.unLock=function(){},t.prototype.cleanInfo=function(){this.node.active=!1,this._seatId=-1,this.lb_total.string="",this.lb_gold.string="0",this.lb_gold.node.parent.active=!1,this.unLock()},t.prototype.getUserWorldPoint=function(){return this.node.convertToWorldSpaceAR(cc.v2(0,-30))},s([h(cc.Label)],t.prototype,"lb_total",void 0),s([h(cc.Label)],t.prototype,"lb_gold",void 0),s([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{"./JCConst":"JCConst","./JCManager":"JCManager"}],JCWeapon:[function(e,t,o){"use strict";cc._RF.push(t,"2179fJFMgJKsKltoyXf5kik","JCWeapon");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(s<3?i(a):s>3?i(t,o,a):i(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../../Script/utils/Utils"),c=e("./JCConst"),r=e("./JCFish"),l=e("./JCManager"),h=cc._decorator,p=h.ccclass,d=h.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.SeatWaits=[],t.FishParent=null,t.arr_weaponSp=[],t.WeaponUI=[],t.DoubleBg=[],t.arr_golds=[],t.spacingY=-7,t.firstFire={set:function(e){e!==this._firstFire&&(this._firstFire=e,!this._firstFire&&this.GameLayer.MenuLayer._mune&&this.GameLayer.MenuLayer.onClickedShow())},get:function(){return this._firstFire}},t.arr_weapons=[],t.arr_lines=[],t.arr_circle=[],t.arrLevels=[],t.arr_locks=[c.JCConst.once.NotFound,c.JCConst.once.NotFound,c.JCConst.once.NotFound,c.JCConst.once.NotFound],t.arr_changes=[],t._limitTime=0,t.LastFireTime=0,t.AutoFire=!1,t}return i(t,e),t.prototype.onLoad=function(){},t.prototype.init=function(){this.initViewData(),this.FishParent.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.FishParent.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.FishParent.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.FishParent.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.FishParent._touchListener.setSwallowTouches(!1),this.schedule(this.speed0,c.JCFireSpeed.Speed0),this.schedule(this.speed1,c.JCFireSpeed.Speed1),this.firstFire=!0},t.prototype.speed1=function(){c.JCConst.once.FightLimit==c.JCFireSpeed.Speed1&&(this.limitFireCd(),this.checkAutoFire())},t.prototype.speed0=function(){c.JCConst.once.FightLimit==c.JCFireSpeed.Speed0&&(this.limitFireCd(),this.checkAutoFire())},t.prototype.limitFireCd=function(){this.checkAutoLock(),this._canFire=!0},t.prototype.checkAutoFire=function(){if(-1!=c.JCConst.once.seatId&&(c.JCConst.once.IsAuto||this.AutoFire)){var e=this.getWeaponOutPositionByTid(c.JCConst.once.seatId),t=l.default.once.tableConvertIndex(),o=this.arr_locks[t];o instanceof r.default&&(e=o.getWorldPoint()),this._touchPoint&&(e=this._touchPoint,this._touchPoint=null),l.default.once.onTouchWindow(e,o.fishId),this.firstFire=!1}},t.prototype.setWeaponGold=function(e,t){var o=l.default.once.userConvertIndex(e),n=this.arr_golds[o];if(n){var i=t*c.JCConst.once.RoomBet;n.string=l.default.once.GameLayer.changeGold(i),n.node.active=!0}},t.prototype.setConvertWeaponActive=function(e,t,o){void 0===o&&(o=!0);var n=l.default.once.userConvertIndex(e);try{var i=this.WeaponUI[n];if(i.active=this.arr_weaponSp[n].node.active=t,this.SeatWaits[n].active=!t,this.WeaponUI[n].getChildByName("btn_add").active=t&&c.JCConst.once.userId===e,this.WeaponUI[n].getChildByName("btn_minus").active=t&&c.JCConst.once.userId===e,c.JCConst.once.userId===e&&o){for(var s=[cc.fadeIn(.1)],a=0;a<8;a++)s.push(cc.moveTo(.5,cc.v2(0,a%2==0?160:190)));s.push(cc.fadeOut(.1));var r=i.getChildByName("sp_there");r.active=!0,r.stopAllActions(),r.runAction(cc.sequence(s))}}catch(h){cc.log("setConvertWeaponActive---\x3e"+JSON.stringify(h))}},t.prototype.initViewData=function(){for(var e=this.WeaponUI,t=0;t<4;t++){var o=e[t];o.getChildByName("sp_lock").getComponent(cc.Sprite).spriteFrame=l.default.once.getFrameByName("icon_locking");var n=cc.find("an_pao/an_pao",o).getComponent(cc.Sprite);this.arr_weaponSp[t]=n,n.node.children[0].active=!1,this.DoubleBg.push(o.getChildByName("an_cannon")),cc.find("btn_add",o).on("click",this.onClickedAdd,this),cc.find("btn_minus",o).on("click",this.onClicked__,this),cc.find("btn_add",o).active=!1,cc.find("btn_minus",o).active=!1,this.arr_golds.push(o.getChildByName("lb_level").getComponent(cc.Label)),this.arr_weapons.push(o.getChildByName("tip"));var i=o.getChildByName("layer_line").getComponent(cc.Layout);i.spacingY=this.spacingY,this.arr_lines.push(i);var s=o.getChildByName("sp_lock");this.arr_circle.push(s),this.arrLevels.push(0)}},t.prototype.setTimelimit=function(e){this._limitTime=e},Object.defineProperty(t.prototype,"timeLimit",{get:function(){return this._limitTime<=0&&this._canFire},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"balanceLimit",{get:function(){var e=this.getLevelCoinByUID();return c.JCConst.once.Entries>=e},enumerable:!1,configurable:!0}),t.prototype.setClickLimit=function(e){this._canFire=e},t.prototype.paramAniName=function(e){return e<2&&(e=2),e>4&&(e=4),"paotong"+e+"_0"},t.prototype.getLevelCoinByUID=function(e){void 0===e&&(e=404);var t=404===e?c.JCConst.once.userId:e,o=l.default.once.userConvertIndex(t);return parseFloat(this.arr_golds[o].string)},t.prototype.refreshWeaponByIndex=function(e,t){var o=this.arrLevels[e];if(void 0!==o){var n=this.paramAniName(o,t),i=this.arr_weaponSp[e];i.spriteFrame=c.JCConst.once.UIAtals.getSpriteFrame(n),o<2&&(o=2),o>4&&(o=4),i.node.children[0].getComponent(cc.Sprite).spriteFrame=c.JCConst.once.UIAtals.getSpriteFrame("fire"+o)}},t.prototype.showChangeWeaponByIndex=function(e){var t=this.arrLevels[e],o=this.paramAniName(t,1);t<2&&(t=2),t>4&&(t=4),this.arr_weaponSp[e].spriteFrame=c.JCConst.once.UIAtals.getSpriteFrame(o),this.arr_weaponSp[e].node.children[0].getComponent(cc.Sprite).spriteFrame=c.JCConst.once.UIAtals.getSpriteFrame("fire"+t)},t.prototype.setLevelByUID=function(e,t){var o=l.default.once.userConvertIndex(e);l.default.once.playSFX("weapon_change"),this.arrLevels[o]=t,this.showChangeWeaponByIndex(o)},t.prototype.cleanInfoByTid=function(e){var t=l.default.once.tableConvertIndex(e);this.arrLevels[t]=0,this.showDoubleByIndex(t,0),this.arr_weaponSp[t].node.active=!1,this.arr_golds[t].node.active=!1,this.DoubleBg[t].active=!1,this.WeaponUI[t].active=!1,this.SeatWaits[t].active=!0,this.setLockFishByTid(e)},t.prototype.hideLockLineByIndex=function(e){var t=this.arr_lines[e];t&&(t.node.active=!1,this.arr_circle[e].active=!1)},t.prototype.showLockLineByTid=function(e,t){if(t instanceof r.default){var o=t.getWorldPoint(),n=l.default.once.tableConvertIndex(e);this.changeWeaponRotationByTid(o,e,!1);var i=this.arr_weapons[n],s=this.arr_circle[n];s.position=i.parent.convertToNodeSpaceAR(o),s.active=!0;var a=this.arr_lines[n];a.node.angle=i.angle;var h=this.getWeaponOutPositionByTid(e,100);a.node.position=a.node.parent.convertToNodeSpaceAR(h),a.node.scale=1;var p=o.sub(h).mag()-10;a.height=p;var d=p/(54+this.spacingY);d=Math.ceil(d)-1;for(var f=a.node.children.length,u=0;u<d||u<f;u++){var y=a.node.children[u];y||((y=cc.instantiate(a.node.children[0])).active=!1),y.getComponent(cc.Sprite).spriteFrame=c.JCConst.once.UIAtals.getSpriteFrame("anchoro"+e),y.scale=1,a.node!==y.parent&&(y.parent=a.node),y.active!==u<d&&(y.active=u<d)}a.node.active=!0}},t.prototype.getConvertWeaponRotationByTid=function(e,t,o){void 0===o&&(o=0);var n=l.default.once.tableConvertIndex(t),i=this.arr_weapons[n];if(cc.isValid(i)){var s=o,a=i.convertToWorldSpaceAR(cc.v2(0,s));return l.default.once.convertPointToAngle(a,e)-90}},t.prototype.getWeaponRotationByTid=function(e){var t=l.default.once.tableConvertIndex(e);return this.arr_weapons[t].angle},t.prototype.getWeaponLowerPositionByTid=function(e){var t=l.default.once.tableConvertIndex(e);return this.arr_weapons[t].convertToWorldSpaceAR(cc.v2(0,0))},t.prototype.onTouchStart=function(e,t){void 0===t&&(t=null),l.default.once.playSFX("click");var o=e.getLocation(),n=l.default.once.tableConvertIndex();cc.log(n),n<0&&(n=0);var i=this.WeaponUI[n],s=i.getChildByName("btn_add").convertToWorldSpaceAR(cc.v2(0,0)),a=i.getChildByName("btn_minus").convertToWorldSpaceAR(cc.v2(0,0));s.sub(o).mag()<50||a.sub(o).mag()<50||-1!=c.JCConst.once.seatId&&(c.JCConst.once.IsAuto&&this.onTouchMove(e),this.getLockFishByTid(c.JCConst.once.seatId)instanceof r.default||this.changeWeaponRotationByTid(e.getLocation(),c.JCConst.once.seatId),t instanceof r.default&&c.JCConst.once.IsLock&&(cc.log("\u70b9\u51fb\uff1a"+t.config.Name),l.default.once.CmdBYLockFish(t)),this.clickFire(o),this.AutoFire=!0)},t.prototype.onTouchMove=function(e){-1!=c.JCConst.once.seatId&&(this._touchPoint=e.getLocation(),this.getLockFishByTid(c.JCConst.once.seatId)instanceof r.default||this.changeWeaponRotationByTid(e.getLocation(),c.JCConst.once.seatId))},t.prototype.onTouchEnd=function(e){this.AutoFire=!1,-1!=c.JCConst.once.seatId&&(this.getLockFishByTid(c.JCConst.once.seatId)instanceof r.default||this.changeWeaponRotationByTid(e.getLocation(),c.JCConst.once.seatId))},t.prototype.clickFire=function(e){this._limitTime>0||-1===c.JCConst.once.seatId||(c.JCConst.once.IsAuto?this._touchPoint=e:l.default.once.onTouchWindow(e))},t.prototype.changeWeaponRotationByTid=function(e,t,o){void 0===o&&(o=!0);var n=l.default.once.tableConvertIndex(t);if(this.arr_weapons[n]&&this.arr_weaponSp[n]){n>1&&o&&(e.y=cc.view.getVisibleSize().height-e.y);var i=-this.getConvertWeaponRotationByTid(e,t);this.arr_weapons[n].angle=i,this.arr_weaponSp[n].node.parent.angle=i}},t.prototype.getWeaponOutPositionByTid=function(e,t){void 0===t&&(t=c.JCConst.once.WeaponHight);var o=l.default.once.tableConvertIndex(e);return this.arr_weapons[o].convertToWorldSpaceAR(cc.v2(0,t))},t.prototype.getLockFishByTid=function(e){var t=l.default.once.tableConvertIndex(e);return this.arr_locks[t]},t.prototype.onClickedAdd=function(){l.default.once.playSFX("click"),this.changeWeaponBet(1)},t.prototype.onClicked__=function(){l.default.once.playSFX("click"),this.changeWeaponBet(-1)},t.prototype.changeWeaponBet=function(e){var t=c.JCConst.once.BLevel;(t+=e)>=c.JCConst.once.BLevels.length&&(t=0),t<0&&(t=c.JCConst.once.BLevels.length-1);var o=c.JCConst.once.BLevels[t];l.default.once.requestChangeCannonBet({userid:c.JCConst.once.userId,bet:o})},t.prototype.showWeapon=function(e){var t=a.default.deepCopy(e),o=l.default.once.userConvertIndex(t.userid),n=this.getLockFishByTid(t.seatId);if(t.userid!=c.JCConst.once.userId){var i=n instanceof r.default?n.getWorldPoint():cc.v2(t.touch.x,t.touch.y);this.changeWeaponRotationByTid(i,t.seatId)}var s=this.arrLevels[o],h=this.arr_weaponSp[o];if(h.node.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,-10)),cc.moveBy(.1,cc.v2(0,10)))),h.node.children[0].stopAllActions(),h.node.children[0].active=!0,h.node.children[0].opacity=0,h.node.children[0].runAction(cc.sequence(cc.fadeIn(.05),cc.delayTime(.1),cc.callFunc(function(){h.node.children[0].active=!1}))),t.lock=n.fishId,t.level=s,l.default.once.GameLayer.addBullet(t),t.seatId===c.JCConst.once.seatId){s<1&&(s=1);var p=t.isDrill?"s208":"v"+s;l.default.once.playSFX(p),this.firstFire=!1,l.default.once.GameLayer.EffectLayer.showLable(this._limitTime)}},t.prototype.setLockFishByTid=function(e,t){var o=l.default.once.tableConvertIndex(e),n=this.getLockFishByTid(e);n instanceof r.default&&n.popLockTid(e),this.hideLockLineByIndex(o),t instanceof r.default?this.arr_locks[o]=t:this.arr_locks[o]=c.JCConst.once.NotFound},t.prototype.cleanFishAllWeaponLock=function(e){for(var t=0;t<4;t++){var o=this.getLockFishByTid(t);e.fishId===o.fishId&&this.setLockFishByTid(t)}},t.prototype.touchFishIsLock=function(e){var t=this.getLockFishByTid(c.JCConst.once.seatId);return c.JCConst.once.IsLock&&(t instanceof r.default&&t.fishId!==e.fishId||!(t instanceof r.default))},t.prototype.showDoubleByIndex=function(e,t){void 0===t&&(t=30);var o=this.DoubleBg[e];o.active=!0,o.stopAllActions(),o.runAction(cc.sequence(cc.delayTime(t),cc.callFunc(function(){o.active=!1})))},t.prototype.checkAutoLock=function(){if(-1!=c.JCConst.once.seatId&&c.JCConst.once.IsLock&&!(this.getLockFishByTid(c.JCConst.once.seatId)instanceof r.default)){var e=l.default.once.getMaxFish();e instanceof r.default&&l.default.once.CmdBYLockFish(e)}},t.prototype.update=function(e){cc.isValid(this.node)&&(this.LastFireTime-=e,this._limitTime-=e,this.LastFireTime<-999998||(this.LastFireTime<-60&&l.default.once.GameLayer.EffectLayer.showLable(this.LastFireTime),this.LastFireTime<-91&&this.LastFireTime>-190&&(this.LastFireTime=-999999,l.default.once.GameLayer.MenuLayer.onClickedBack())))},t.prototype.onDestroy=function(){this.unschedule(this.speed0),this.unschedule(this.speed1)},s([d([cc.Node])],t.prototype,"SeatWaits",void 0),s([d(cc.Node)],t.prototype,"FishParent",void 0),s([d([cc.Node])],t.prototype,"WeaponUI",void 0),s([d([cc.Node])],t.prototype,"DoubleBg",void 0),s([p],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../Script/utils/Utils":void 0,"./JCConst":"JCConst","./JCFish":"JCFish","./JCManager":"JCManager"}]},{},["JCBill","JCBullet","JCCoin","JCConst","JCEffect","JCEffectLayer","JCFish","JCFishNet","JCLabel","JCLoading","JCManager","JCMenu","JCNetWork","JCScene","JCUser","JCWeapon"]);